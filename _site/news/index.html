<!DOCTYPE HTML>
<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <title>News</title>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="generator" content="Jekyll v3.7.4">
  <link rel="alternate" type="application/rss+xml" title="Ball Aerospace COSMOS News" href="/feed.xml">
  <link rel="alternate" type="application/atom+xml" title="Recent commits to COSMOS's master branch" href="https://github.com/BallAerospace/COSMOS/commits/master.atom">
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic,900">
  <link rel="stylesheet" href="/css/screen.css">
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <!--[if lt IE 9]>
  <script src="/js/html5shiv.min.js"></script>
  <script src="/js/respond.min.js"></script>
  <![endif]-->
</head>


<body class="wrap">
  <header role="banner">
  <nav class="mobile-nav show-on-mobiles">
    <ul>
  <li class="">
    <a href="/">Home</a>
  </li>
  <li class="">
    <span class="hide-on-mobiles"><a href="/docs/home/">Documentation</a></span>
    <span class="show-on-mobiles"><a href="/docs/home/">Docs</a></span>
  </li>
  <li class="current">
    <a href="/news/">News</a>
  </li>
  <li>
    <a href="/help/">Help</a>
  </li>
  <li>
    <a href="https://github.com/BallAerospace/COSMOS" target="_blank"><span class="hide-on-mobiles">View on </span>GitHub</a>
  </li>
</ul>

  </nav>
  <div class="grid wider">
    <div class="unit one-third center-on-mobiles" style="margin-top:27px;">
      <h1>
        <a href="/">
          <span class="sr-only">COSMOS</span>
          <img src="/img/COSMOS.png" width="312" height="70" alt="COSMOS Logo">
        </a>
      </h1>
    </div>
    <nav class="main-nav unit two-thirds hide-on-mobiles">
      <ul>
  <li class="">
    <a href="/">Home</a>
  </li>
  <li class="">
    <span class="hide-on-mobiles"><a href="/docs/home/">Documentation</a></span>
    <span class="show-on-mobiles"><a href="/docs/home/">Docs</a></span>
  </li>
  <li class="current">
    <a href="/news/">News</a>
  </li>
  <li>
    <a href="/help/">Help</a>
  </li>
  <li>
    <a href="https://github.com/BallAerospace/COSMOS" target="_blank"><span class="hide-on-mobiles">View on </span>GitHub</a>
  </li>
</ul>

    </nav>
  </div>
</header>


    <section class="news">
    <div class="grid wider">

      <div class="docs-nav-mobile unit whole show-on-mobiles">
  <select onchange="if (this.value) window.location.href=this.value">
    <option value="">Navigate the blog...</option>
    <option value="/news/">Home</option>
    <optgroup label="v1.x">
      
      <option value="/news/2019/06/28/cosmos-4-4-0-released/">Ball Aerospace COSMOS 4.4.0 Released</option>
      
      <option value="/news/2019/06/05/protocols/">Protocols</option>
      
      <option value="/news/2018/12/24/little-endian/">Little Endian Packet Data</option>
      
      <option value="/news/2018/10/05/system-target-txt/">Using system.txt and target.txt</option>
      
      <option value="/news/2018/09/14/cosmos-dockercon/">COSMOS at DockerCon 2018</option>
      
      <option value="/news/2018/08/30/cosmos-4-3-0-released/">Ball Aerospace COSMOS 4.3.0 Released</option>
      
      <option value="/news/2018/05/16/cosmos-4-2-4-released/">Ball Aerospace COSMOS 4.2.4 Released</option>
      
      <option value="/news/2018/04/17/cosmos-4-2-3-released/">Ball Aerospace COSMOS 4.2.3 Released</option>
      
      <option value="/news/2018/04/11/cosmos-4-2-2-released/">Ball Aerospace COSMOS 4.2.2 Released</option>
      
      <option value="/news/2018/03/14/derived-items/">Derived Items</option>
      
      <option value="/news/2018/02/12/limits/">Limits</option>
      
      <option value="/news/2018/01/18/metadata/">Metadata</option>
      
      <option value="/news/2017/12/07/cosmos-4-1-1-released/">Ball Aerospace COSMOS 4.1.1 Released</option>
      
      <option value="/news/2017/11/28/cosmos-4-1-0-release-notes/">COSMOS 4.1.0 Release Notes</option>
      
      <option value="/news/2017/11/17/cosmos-4-1-0-released/">Ball Aerospace COSMOS 4.1.0 Released</option>
      
      <option value="/news/2017/11/13/require_vs_load/">Require vs Load</option>
      
      <option value="/news/2017/10/30/config-editor/">Config Editor</option>
      
      <option value="/news/2017/10/24/cosmos-4-0-3-released/">Ball Aerospace COSMOS 4.0.3 Released</option>
      
      <option value="/news/2017/09/29/cosmos-4-0-2-released/">Ball Aerospace COSMOS 4.0.2 Released</option>
      
      <option value="/news/2017/08/23/cloud-deploy/">Deploying COSMOS to the Cloud</option>
      
      <option value="/news/2017/08/23/cosmos-4-0-1-released/">Ball Aerospace COSMOS 4.0.1 Released</option>
      
      <option value="/news/2017/08/04/cosmos-4-0-0-released/">Ball Aerospace COSMOS 4.0.0 Released</option>
      
      <option value="/news/2017/07/05/arduino-battle-bots/">Arduinos & Battle Bots</option>
      
      <option value="/news/2017/06/19/template_protocol/">Template Protocol</option>
      
      <option value="/news/2017/05/18/cosmos-3-9-2-released/">Ball Aerospace COSMOS 3.9.2 Released</option>
      
      <option value="/news/2017/05/08/packet_processors/">Packet Processors</option>
      
      <option value="/news/2017/04/24/wired/">WIRED Article</option>
      
      <option value="/news/2017/03/29/cosmos-3-9-1-released/">Ball Aerospace COSMOS 3.9.1 Released</option>
      
      <option value="/news/2017/02/22/routers/">Routers</option>
      
      <option value="/news/2016/12/06/cosmos-3-8-3-released/">Ball Aerospace COSMOS 3.8.3 Released</option>
      
      <option value="/news/2016/10/13/cosmos-cubesat-ops/">SmallSat Ops</option>
      
      <option value="/news/2016/09/12/erb-config/">ERB Config Files</option>
      
      <option value="/news/2016/08/22/custom-widgets/">Custom Widgets</option>
      
      <option value="/news/2016/08/04/custom-cosmos_interface/">Custom COSMOS Interface</option>
      
      <option value="/news/2016/07/06/cosmos-cmd-tlm-names/">COSMOS Cmd/Tlm Naming</option>
      
      <option value="/news/2016/07/05/cosmos-3-8-2-released/">Ball Aerospace COSMOS 3.8.2 Released</option>
      
      <option value="/news/2016/05/12/cosmos-3-8-1-released/">Ball Aerospace COSMOS 3.8.1 Released</option>
      
      <option value="/news/2016/03/03/sparkfun/">Sparkfun Blog Post</option>
      
      <option value="/news/2016/02/27/xtce-support/">XTCE Support</option>
      
      <option value="/news/2016/02/27/fukuoka-award/">Fukuoka Special Award Winner</option>
      
      <option value="/news/2016/02/26/cosmos-3-8-0-released/">Ball Aerospace COSMOS 3.8.0 Released</option>
      
      <option value="/news/2016/02/11/simulated-target/">COSMOS Simulated Target</option>
      
      <option value="/news/2015/12/29/cosmos-3-7-1-released/">Ball Aerospace COSMOS 3.7.1 Released</option>
      
      <option value="/news/2015/11/25/cosmos-3-7-0-released/">Ball Aerospace COSMOS 3.7.0 Released</option>
      
      <option value="/news/2015/10/30/cosmos-3-6-3-released/">Ball Aerospace COSMOS 3.6.3 Released</option>
      
      <option value="/news/2015/10/28/cosmos-at-ats-conference/">COSMOS at the ATS Conference</option>
      
      <option value="/news/2015/08/10/cosmos-3-6-2-released/">Ball Aerospace COSMOS 3.6.2 Released</option>
      
      <option value="/news/2015/08/10/cosmos-3-6-1-released/">Ball Aerospace COSMOS 3.6.1 Released</option>
      
      <option value="/news/2015/08/07/cosmos-3-6-0-released/">Ball Aerospace COSMOS 3.6.0 Released</option>
      
      <option value="/news/2015/07/14/cosmos-3-5-3-released/">Ball Aerospace COSMOS 3.5.3 Released</option>
      
      <option value="/news/2015/07/14/cosmos-3-5-2-released/">Ball Aerospace COSMOS 3.5.2 Released</option>
      
      <option value="/news/2015/07/08/cosmos-3-5-1-released/">Ball Aerospace COSMOS 3.5.1 Released</option>
      
      <option value="/news/2015/06/22/cosmos-3-5-0-released/">Ball Aerospace COSMOS 3.5.0 Released</option>
      
      <option value="/news/2015/05/08/cosmos-3-4-2-released/">Ball Aerospace COSMOS 3.4.2 Released</option>
      
      <option value="/news/2015/05/01/cosmos-3-4-1-released/">Ball Aerospace COSMOS 3.4.1 Released</option>
      
      <option value="/news/2015/04/27/cosmos-3-4-0-released/">Ball Aerospace COSMOS 3.4.0 Released</option>
      
      <option value="/news/2015/04/06/cosmos-c-extension/">COSMOS BinaryAccessor#write C Extension</option>
      
      <option value="/news/2015/03/23/cosmos-3-3-3-released/">Ball Aerospace COSMOS 3.3.3 Released</option>
      
      <option value="/news/2015/03/19/cosmos-3-3-1-released/">Ball Aerospace COSMOS 3.3.1 - Startup Cheetah</option>
      
      <option value="/news/2015/02/27/cosmos-at-gsaw-conference/">COSMOS at the GSAW Conference</option>
      
      <option value="/news/2015/02/23/cosmos-3-2-1-released/">Ball Aerospace COSMOS 3.2.1 Released</option>
      
      <option value="/news/2015/02/17/cosmos-3-2-0-released/">Ball Aerospace COSMOS 3.2.0 Released</option>
      
      <option value="/news/2015/02/03/cosmos-3-1-2-released/">Ball Aerospace COSMOS 3.1.2 Released</option>
      
      <option value="/news/2015/01/28/cosmos-3-1-1-released/">Ball Aerospace COSMOS 3.1.1 Released</option>
      
      <option value="/news/2015/01/06/ball-aerospace-cosmos-open-sourced/">Ball Aerospace COSMOS Open Sourced</option>
      
    </optgroup>
  </select>
</div>


      <div class="unit four-fifths">
        
  <article>
  <h2>
    <a href="/news/2019/06/28/cosmos-4-4-0-released/">
      Ball Aerospace COSMOS 4.4.0 Released
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      release
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      28 Jun 2019
    </span>
    <a href="https://github.com/ryanmelt" class="post-author">
      <img src="https://github.com/ryanmelt.png" class="avatar" alt="ryanmelt avatar" width="24" height="24">
      ryanmelt
    </a>
  </div>
  <div class="post-content">
    <p>Here’s COSMOS 4.4.0!   52 tickets have been incorporated including 18 new features, 19 bug fixes and 15 general maintenance changes.</p>

<p>Overall this is just a stability bug fix release, but there are a few interesting changes.   For one, max packet reception speed has been greatly increased due to ticket #911.  CmdExtractor can now output in a CSV format. ScriptRunner has a recently opened file menu section, and the show_backtrace feature is now a menu option as well.  There is much better support for giving absolute paths to config files on the command line.  There is also a new LED type widget to display boolean telemetry.</p>

<p>Enjoy and see below for the full list of changes.</p>

<h3 id="breaking-changes">Breaking Changes:</h3>

<p>The faster identification in ticket #911 does come with a potentially breaking change.  The improvement requires that all packets for a given target be identified using the same fields (bit offset, bit_size, and type).   This is the typical configuration, and breaking this pattern is typically a dangerous/bad choice for interfaces anyways, but previously COSMOS did default to handling packets being potentially identified using different fields in the same target.  If you have a target that still requires that functionality, you need to declare CMD_UNIQUE_ID_MODE, and/or TLM_UNIQUE_ID_MODE in the target’s target.txt file to indicate it should use the slower identification method.</p>

<h3 id="new-features">New Features:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/822">#822</a> CmdExtractor CSV Output Option</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/854">#854</a> ScriptRunner open multiple files from File-&gt;Open</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/877">#877</a> Graph in PktViewer during Replay should open TlmGrapher in Replay</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/878">#878</a> Debugger enhancements</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/886">#886</a> Add show_backtrace menu option to ScriptRunner/TestRunner</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/891">#891</a> Ability for protocol write methods to write send commands to the interface that owns it</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/893">#893</a> Canvas image ease of use</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/895">#895</a> prompt should take color and font options</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/911">#911</a> Fast Identification</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/918">#918</a> Limits bar widget display specified range</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/934">#934</a> Recent Files list in Script Runner File menu</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/938">#938</a> Test Runner disable start buttons</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/956">#956</a> Templated Protocol Limited to One Target per Interface</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/964">#964</a> Improve error message when accessing packets during initialization</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/986">#986</a> Script Runner should note Disconnect mode in log</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/987">#987</a> Tools should support absolute paths on the command line</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/990">#990</a> Add Boolean Telemetry Widget</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/1017">#1017</a> Data Viewer component for colored text items</li>
</ul>

<h3 id="maintenance">Maintenance:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/880">#880</a> tmp output not capitalizing targets</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/884">#884</a> Documentation updates</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/913">#913</a> Workaround Travis accept failures</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/914">#914</a> Increase json_drb start timeout</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/925">#925</a> Script syntax highlighting improvements</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/930">#930</a> Update COSMOS Travis builds</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/940">#940</a> Update keyword documentation</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/953">#953</a> Simplify Launcher.bat files</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/955">#955</a> Document tool command line options</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/995">#995</a> Test Runner should use LOAD_UTILITY to better match scripting</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/998">#998</a> Enable raw logging when LOG_RAW used</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/1000">#1000</a> Add IgnorePacketProtocol to defaults</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/1005">#1005</a> Celsius is misspelled</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/1008">#1008</a> Move handbook assets out of outputs</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/1010">#1010</a> Widget documentation and cleanup</li>
</ul>

<h3 id="bug-fixes">Bug Fixes:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/870">#870</a> TlmViewer Block Widget exhibits weird scrolling issue</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/874">#874</a> Demo commanding screen can’t run scripts</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/882">#882</a> Demo background task unable to be restarted</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/889">#889</a> FixedProtocol does not identify packets when leading bytes discarded</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/908">#908</a> Bad Hex String Conversion in Command Sender</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/909">#909</a> Replay doesn’t work with TlmGrapher when loading saved_config</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/916">#916</a> Allow FORMAT_STRING before STATES</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/919">#919</a> Limits Checking Enabled Status on Properties Dialog not accurate</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/920">#920</a> Gemfile may be too strict in ruby-termios version requirement</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/927">#927</a> Error if DECLARE_TARGET with no SYSTEM target folder</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/945">#945</a> Screenshotting on Macs may not work</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/948">#948</a> Unable to connect limits monitor to replay server</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/966">#966</a> OpenGL Builder is Expecting “EarthMap1024x512.gif”, but Packaged GIF is “Earthmap1024x512.gif”</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/975">#975</a> Multiple Errors in a chain of ScriptRunner Methods</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/978">#978</a> ScriptRunner breakpoints don’t get set on the correct line</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/980">#980</a> Include target REQUIRE files in marshal</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/983">#983</a> Line number discrepancy in TestRunner Report/ScriptRunner output</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/992">#992</a> missing method in xtce_converter; process_xtce</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/1022">#1022</a> Table Manager TABLEFILE doesn’t support subdirectories</li>
</ul>

<h3 id="migration-notes-from-cosmos-430">Migration Notes from COSMOS 4.3.0:</h3>

<p>To upgrade to the latest version of COSMOS, run “bundle update cosmos” in your COSMOS project folder.</p>

<p>See the COSMOS documentation for directions on setting up DART: http://cosmosrb.com/docs/home/</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2019/06/05/protocols/">
      Protocols
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      post
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      05 Jun 2019
    </span>
    <a href="https://github.com/jmthomas" class="post-author">
      <img src="https://github.com/jmthomas.png" class="avatar" alt="jmthomas avatar" width="24" height="24">
      jmthomas
    </a>
  </div>
  <div class="post-content">
    <h2 id="protocols">Protocols</h2>
<p>Protocols were introduced into COSMOS in version 4.0.0. Protocols consist of the code that make sense of the incoming byte stream before it is turned into packets. They work hand in hand with the COSMOS interface that connects to the target, whether it is TCP/IP, UDP, or serial. The new COSMOS protocol system makes it possible to add and layer protocols into a COSMOS interface.</p>

<h3 id="built-in-protocols">Built-in Protocols</h3>
<p>COSMOS comes with a number of built-in protocols that are used directly with the COSMOS provided interfaces. In fact, when you declare your interface you’re required to specify a protocol. For example, the following code declares a TCP/IP client with a LENGTH protocol.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>INTERFACE INTERFACE_NAME tcpip_client_interface.rb localhost 8080 8081 10.0 nil LENGTH 0 16 0 1 BIG_ENDIAN 4 0xBA5EBA11
</code></pre></div></div>

<p>The built-in protocols are fully described on the <a href="/docs/protocols">Protocols</a> page and also mentioned on the <a href="/docs/interfaces/#protocols">Interfaces</a> page.</p>

<h3 id="custom-protocols">Custom Protocols</h3>
<p>The built-in protocols are enough to support almost all of the data streams that you’ll encounter from a target. However, sometimes you need to massage the data a little by stripping off data or adding headers. This is when you should create a custom protocol. Custom protocols have 4 methods they can override to modify the incoming telemetry data or outgoing command data. They are read_data(data), write_data(data) and read_packet(packet) write_packet(packet). The ‘data’ methods operate on the raw binary data and are used when adding or removing raw bytes from the stream. The ‘packet’ methods operate on the data after it has been identified and converted to a COSMOS <a href="/docs/packet_class/">Packet</a>.</p>

<h4 id="removing-data">Removing Data</h4>
<p>A recent program was interfacing to a particular device that was sending the ASCII ETX character (0x03) at the end of the data. This character wasn’t needed and was confusing a legacy application that was parsing the raw data. A custom protocol was created to simply strip off this byte from the data stream.</p>

<p>In the target’s lib directory the strip_etx_protocol.rb file was created. Since the protocol had to simply strip off a single byte, it overrides the read_data(data) method.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>require 'cosmos/interfaces/protocols/protocol'
class StripEtxProtocol &lt; Protocol
  def read_data(data)
    if data[-1] == "\x03"
      return super(data[0..-2])
    else
      return super(data)
    end
  end
end
</code></pre></div></div>

<p>Ruby can index from the back of the array with -1, -2, etc. Thus if the last byte (-1) is a binary 0x03, the protocol returns the data from 0 up to and including the second to last byte (-2). This was added to the interface by declaring it as a READ protocol since it is only modifying the incoming telemetry data.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>INTERFACE DEV_INT &lt;interface params&gt;
  PROTOCOL READ StripEtxProtocol
</code></pre></div></div>

<h4 id="adding-data">Adding Data</h4>
<p>If you need to add framing data or other bits of protocol to your outgoing data you can create a custom protocol.</p>

<p>In the target’s lib directory create a file called framing_protocol.rb. Since the protocol is adding data to the outgoing stream, we override the write_data(data) method.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>require 'cosmos/interfaces/protocols/protocol'
class FramingProtocol &lt; Protocol
  HEADER = "\xDE\xAD\xBE\xEF" # Binary header data
  def write_data(data)
    super(HEADER + data)
  end
end
</code></pre></div></div>

<p>If you have a question, find a bug, or want a feature please use our <a href="https://github.com/BallAerospace/COSMOS/issues">Github Issues</a>. If you would like more information about a COSMOS training or support contract please contact us at <a href="mailto:cosmos@ball.com">cosmos@ball.com</a>.</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2018/12/24/little-endian/">
      Little Endian Packet Data
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      post
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      24 Dec 2018
    </span>
    <a href="https://github.com/ryanmelt" class="post-author">
      <img src="https://github.com/ryanmelt.png" class="avatar" alt="ryanmelt avatar" width="24" height="24">
      ryanmelt
    </a>
  </div>
  <div class="post-content">
    <p>APPEND does not work with little endian bitfields.</p>

<p>Defining little endian bitfields is a little weird but does work in COSMOS.</p>

<p>Rules on how COSMOS handles LITTLE_ENDIAN data:</p>

<ol>
  <li>
    <p>COSMOS bit offsets are always defined in BIG_ENDIAN terms. Bit 0 is always the most significant bit of the first byte in a packet, and increasing from there.</p>
  </li>
  <li>
    <p>All 8, 16, 32, and 64-bit byte-aligned LITTLE_ENDIAN data types define their bit_offset as the most significant bit of the first byte in the packet that contains part of the item. (This is exactly the same as BIG_ENDIAN). Note that for all except 8-bit LITTLE_ENDIAN items, this is the LEAST significant byte of the item.</p>
  </li>
  <li>
    <p>LITTLE_ENDIAN bit fields are defined as any LITTLE_ENDIAN INT or UINT item that is not 8, 16, 32, or 64-bit and byte aligned.</p>
  </li>
  <li>
    <p>LITTLE_ENDIAN bit fields must define their bit_offset as the location of the most significant bit of the bitfield in BIG_ENDIAN space as described in rule 1 above. So for example. The following C struct at the beginning of a packet would be defined like so:</p>
  </li>
</ol>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>struct {
  unsigned short a:4;
  unsigned short b:8;
  unsigned short c:4;
}

ITEM A 4 4 UINT "struct item a"
ITEM B 12 8 UINT "struct item b"
ITEM C 8 4 UINT "struct item c"
</code></pre></div></div>

<p>This is hard to visualize, but the structure above gets spread out in a byte array like the following after byte swapping: least significant 4 bits of b, 4-bits a, 4-bits c, most significant 4 bits of b</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2018/10/05/system-target-txt/">
      Using system.txt and target.txt
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      post
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      05 Oct 2018
    </span>
    <a href="https://github.com/jmthomas" class="post-author">
      <img src="https://github.com/jmthomas.png" class="avatar" alt="jmthomas avatar" width="24" height="24">
      jmthomas
    </a>
  </div>
  <div class="post-content">
    <h2 id="systemtxt">system.txt</h2>
<p>The COSMOS system configuration is performed by system.txt in the config/system directory. This file declares all the targets that will be used by COSMOS as well as top level configuration information which is primarily used by the Command and Telemetry Server.</p>

<p>By default, all COSMOS tools use the config/system/system.txt file. However, all tools can take a custom system configuration file by passing the “–system <filename>" option to the tool when it starts. This is typically done in the Launcher script as shown in the COSMOS demo. Here's an excerpt which shows how we're passing system2.txt using the --system option.</filename></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>TOOL "Command and Telemetry Server" "LAUNCH CmdTlmServer --system system2.txt" "cts.png" --config cmd_tlm_server2.txt
</code></pre></div></div>

<h3 id="using-multiple-systemtxt-files">Using Multiple system.txt Files</h3>
<p>So when would you want to create and use multiple system.txt files? Since system.txt defines the targets used by the system, you can use two different system.txt files to create two configurations which contain most but not all the same targets. For example, you have a test bench with 5 different test equipment targets but different test box targets: BOX1 and BOX2. You can create one COSMOS configuration for both test benches and create two different launcher files with different lists of targets.</p>

<h2 id="targettxt">target.txt</h2>
<p>The parsing of a COSMOS target is controlled by the target.txt file found at the root of the target directory. The COMMANDS and TELEMETRY keywords tell COSMOS which <a href="/docs/command">Command</a> and <a href="/docs/telemetry">Telemetry</a> files to parse. For example from the COSMOS demo INST <a href="https://github.com/BallAerospace/COSMOS/blob/master/demo/config/targets/INST/target.txt">target.txt</a></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>COMMANDS inst_cmds.txt
TELEMETRY inst_tlm.txt
</code></pre></div></div>

<p>Since we can tell COSMOS exactly which command and telemetry files to parse we can control how the target cmd/tlm definitions get built. This is useful if you have a target with slightly different command and telemetry definitions. This can happen for varous reasons like connecting to slightly different hardware revisions. The advantage of using a single target folder in this case (vs just copying and renaming the target folder) is that you can (potentially) reuse screens and target library code. Obviously this only works if the command and telemetry definitions are only slightly different between revisions.</p>

<h3 id="combining-systemtxt-and-targettxt">Combining system.txt and target.txt</h3>
<p>When we combine the ability in system.txt to specify a specific target.txt file and the ability in target.txt to specify the command and telemetry definitions, we can create specific configurations for different environments.</p>

<p>This example is losely based on the COSMOS demo. First create two separate system.txt files called system1.txt and system2.txt:</p>

<p>Partial system1.txt:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>DECLARE_TARGET INST nil target1.txt
</code></pre></div></div>

<p>Partial system2.txt</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>DECLARE_TARGET INST nil target2.txt
</code></pre></div></div>

<p>The target1.txt file in the INST target calls out one set of cmd/tlm files:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>COMMANDS inst1_cmds.txt
TELEMETRY inst1_tlm.txt
</code></pre></div></div>

<p>The target2.txt file in the INST target calls out another set:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>COMMANDS inst2_cmds.txt
TELEMETRY inst2_tlm.txt
</code></pre></div></div>

<p>You also have to ensure your Launcher scripts specify the correct system.txt file when launching the tools:</p>

<p>Partial launcher1.txt:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>TOOL "Command and Telemetry Server" "LAUNCH CmdTlmServer --system system1.txt" "cts.png" --config cmd_tlm_server.txt
</code></pre></div></div>

<p>Partial launcher2.txt:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>TOOL "Command and Telemetry Server" "LAUNCH CmdTlmServer --system system2.txt" "cts.png" --config cmd_tlm_server.txt
</code></pre></div></div>

<p>Once you have your launcher configurations in place you can create a simple Batch file or shell script to launch COSMOS.</p>

<p>Launcher1.bat:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>call tools\Launcher.bat --config launcher1.txt
</code></pre></div></div>

<p>Launcher2.bat:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>call tools\Launcher.bat --config launcher2.txt
</code></pre></div></div>

<p>With correct usage of system.txt and target.txt you can consolidate your COSMOS configurations and avoid copying and pasting. This makes your COSMOS configuration easier to test and maintain.</p>

<h3 id="overriding-cmdtlm-definitions">Overriding Cmd/Tlm Definitions</h3>

<p>Another way to modify a target is to override the target command and telemetry definitions. This is a useful practice if your target’s command and telemetry files are generated from a database or from some other system and you want to add COSMOS specific features. It is also handy to add custom conversions and formatting for displays.</p>

<p>Create a file in the target’s cmd_tlm folder named after the original file but with an extension like _override.txt. For example, you have the following telemetry definition file named inst_tlm.txt:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>TELEMETRY INST HEALTH_STATUS BIG_ENDIAN "Health and status from the target"
  APPEND_ITEM COLLECTS         16 UINT     "Number of collects"
  APPEND_ITEM TEMP1            16 UINT     "Temperature #1"
</code></pre></div></div>

<p>Create another file called inst_tlm_override.txt and start overriding telemetry using the <a href="/docs/telemetry/#select_telemetry">SELECT_TELEMETRY</a> and <a href="/docs/telemetry/#select_item">SELECT_ITEM</a> keywords. Note that the filename is important because by default COSMOS processes cmd/tlm definition files in alphabetical order. For example, if you have a telemetry file named “telemetry.txt” and created a file called “override.txt”, you would get an error because the telemetry file will not be processed before the override.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT_TELEMETRY INST HEALTH_STATUS
  SELECT_ITEM COLLECTS
    FORMAT_STRING "0x%0X"
</code></pre></div></div>

<p>Note that you can include these override files as needed based on the target.txt file as described above.</p>

<p>If you have a question, find a bug, or want a feature please use our <a href="https://github.com/BallAerospace/COSMOS/issues">Github Issues</a>. If you would like more information about a COSMOS training or support contract please contact us at <a href="mailto:cosmos@ball.com">cosmos@ball.com</a>.</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2018/09/14/cosmos-dockercon/">
      COSMOS at DockerCon 2018
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      post
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      14 Sep 2018
    </span>
    <a href="https://github.com/jmthomas" class="post-author">
      <img src="https://github.com/jmthomas.png" class="avatar" alt="jmthomas avatar" width="24" height="24">
      jmthomas
    </a>
  </div>
  <div class="post-content">
    <p>Ball Aerospace COSMOS has been featured in a <a href="https://www.youtube.com/watch?v=RnWXOAplvjY&amp;feature=youtu.be&amp;t=9m">presentation</a> by Chris Heistand from <a href="http://www.jhuapl.edu/">John Hopkins Applied Physics Laboratory</a>. He’s working on the <a href="http://dart.jhuapl.edu/">Double Asteroid Redirection Test (DART)</a> not to be confused with COSMOS <a href="/docs/dart_overview">DART</a>. They have setup COSMOS to run in a Docker container which X fowards to a X11Server VNC container which they then use a VNC Client to connect to. Pretty cool stuff which we we will hopefully have more out of the box support for in the future. Stay tuned!</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2018/08/30/cosmos-4-3-0-released/">
      Ball Aerospace COSMOS 4.3.0 Released
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      release
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      30 Aug 2018
    </span>
    <a href="https://github.com/ryanmelt" class="post-author">
      <img src="https://github.com/ryanmelt.png" class="avatar" alt="ryanmelt avatar" width="24" height="24">
      ryanmelt
    </a>
  </div>
  <div class="post-content">
    <p>Welcome to COSMOS 4.3.0!</p>

<p>The highlight of this release is built in support for differentiating between stored telemetry and realtime telemetry.  If your system downlinks stored telemetry that you don’t want to interfere with the COSMOS realtime current value table, your interface/protocol code can set the stored flag on a packet before returning it to COSMOS to have COSMOS log the packet, but not update the current telemetry values.</p>

<p>Lots of other new features as well, and a few bug fixes including fixing running on the latest version of Mac OSX.  See below for the full list.</p>

<p>Breaking Changes:
The COSMOS log file format and predentified protocol formats have changed to support stored telemetry.   COSMOS 4.3 is backwards compatible with earlier formats, but older versions of COSMOS won’t be able to read files from COSMOS 4.3+.</p>

<h3 id="new-features">New Features:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/780">#780</a> Search bar support for Command Sequence</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/785">#785</a> Adjust font size</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/804">#804</a> Add classification bar to all tools</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/808">#808</a> Add CANVASELLIPSE widget</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/814">#814</a> Changes to support stored telemetry</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/815">#815</a> Create a temporary screen from a script</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/818">#818</a> Catch all state for any undefined state values</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/819">#819</a> Ensure x values added in incrementing order in TlmGrapher</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/823">#823</a> Add protocol to ignore any packet</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/826">#826</a> Allow hash style access to Excel</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/829">#829</a> Add STAY_ON_TOP feature to telemetry screens</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/851">#851</a> Ensure step_mode displays Step button</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/859">#859</a> Change Script Runner highlight color when paused</li>
</ul>

<h3 id="maintenance">Maintenance:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/796">#796</a> Handle Command Sequence Export Issues</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/807">#807</a> Revert Items with STATE cannot define FORMAT_STRING</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/812">#812</a> Ruby 2.5 Instrumented Code outside of methods in a class</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/855">#855</a> Remove Qt warning message on Windows 10</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/858">#858</a> Fix JRuby build issues</li>
</ul>

<h3 id="bug-fixes">Bug Fixes:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/837">#837</a> Packet Viewer’s “Hide Ignored Items” Incorrectly Persists Across Change of Packet</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/840">#840</a> Latest version of COSMOS crashing</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/845">#845</a> Support get_tlm_details in disconnect mode</li>
</ul>

<h3 id="migration-notes-from-cosmos-42x">Migration Notes from COSMOS 4.2.x:</h3>
<p>To upgrade to the latest version of COSMOS, run “bundle update cosmos” in your COSMOS project folder.</p>

<p>See the COSMOS documentation for directions on setting up DART: http://cosmosrb.com/docs/home/</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2018/05/16/cosmos-4-2-4-released/">
      Ball Aerospace COSMOS 4.2.4 Released
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      release
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      16 May 2018
    </span>
    <a href="https://github.com/ryanmelt" class="post-author">
      <img src="https://github.com/ryanmelt.png" class="avatar" alt="ryanmelt avatar" width="24" height="24">
      ryanmelt
    </a>
  </div>
  <div class="post-content">
    <p>This is the second patch release for 4.2.  It greatly improves the ingest speed for DART (100x), improves decom speed, reduces database size, and fixes some bugs.  If you are using DART, please upgrade and follow the migration directions at the end of these release notes.</p>

<p>The highlight of COSMOS 4.2 is a new tool called the Data Archival and Retrieval Tool (DART).   DART is a long term trending database built on top of the PostgreSql database.  It integrates directly with TlmGrapher, TlmExtractor, CmdExtractor, DataViewer, and Replay, allowing you to do historical queries of logged telemetry (and commands) by specifying a time range.  Queries are super fast and it performs automatic data reduction at minute/hour/day granularity.  Consider setting it up for your project and start data mining today!</p>

<p>See the COSMOS documentation for directions on setting up DART: http://cosmosrb.com/docs/home/</p>

<h3 id="new-features">New Features:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/787">#787</a> No way to control data bits on serial interface</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/788">#788</a> ROUTERS should support PROTOCOL keyword</li>
</ul>

<h3 id="maintenance">Maintenance:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/784">#784</a> Comparable and spaceship operator behavior changing</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/791">#791</a> Table Manager doesn’t expose top level layout</li>
</ul>

<h3 id="bug-fixes">Bug Fixes:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/779">#779</a> Dart updates for ingest speed, correct time zone, TlmGrapher crash</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/786">#786</a> Status tab crash on Ruby 2.5</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/790">#790</a> Telemetry check doesn’t support strings with multiple spaces</li>
</ul>

<h3 id="migration-notes-from-cosmos-41x">Migration Notes from COSMOS 4.1.x:</h3>

<p>To upgrade to the latest version of COSMOS, run “bundle update cosmos” in your COSMOS project folder.</p>

<p>If you already setup DART for your program please follow the following additional steps:
In a terminal in your COSMOS project folder run:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rake db:migrate
rake db:seed
</code></pre></div></div>

<p>See the COSMOS documentation for directions on setting up DART: http://cosmosrb.com/docs/home/</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2018/04/17/cosmos-4-2-3-released/">
      Ball Aerospace COSMOS 4.2.3 Released
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      release
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      17 Apr 2018
    </span>
    <a href="https://github.com/ryanmelt" class="post-author">
      <img src="https://github.com/ryanmelt.png" class="avatar" alt="ryanmelt avatar" width="24" height="24">
      ryanmelt
    </a>
  </div>
  <div class="post-content">
    <p>COSMOS 4.2 is here!   This is the first true patch release for 4.2.  The highlight of COSMOS 4.2 is a new tool called the Data Archival and Retrieval Tool (DART).   DART is a long term trending database built on top of the PostgreSql database.  It integrates directly with TlmGrapher, TlmExtractor, CmdExtractor, DataViewer, and Replay, allowing you to do historical queries of logged telemetry (and commands) by specifying a time range.  Queries are super fast and it performs automatic data reduction at minute/hour/day granularity.  Consider setting it up for your project and start data mining today!</p>

<p>See the COSMOS documentation for directions on setting up DART: http://cosmosrb.com/docs/home/</p>

<h3 id="new-features">New Features:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/767">#767</a> Support Ruby 2.5</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/771">#771</a> Add CmdSender Search</li>
</ul>

<h3 id="maintenance">Maintenance:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/772">#772</a> OpenGL gem isn’t supported in Ruby 2.5</li>
</ul>

<h3 id="bug-fixes">Bug Fixes:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/769">#769</a> TIMEGRAPH widget non-functional</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/775">#775</a> Toggle disconnect broken in TestRunner</li>
</ul>

<h3 id="migration-notes-from-cosmos-41x">Migration Notes from COSMOS 4.1.x:</h3>

<p>To upgrade to the latest version of COSMOS, run “bundle update cosmos” in your COSMOS project folder.</p>

<p>See the COSMOS documentation for directions on setting up DART: http://cosmosrb.com/docs/home/</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2018/04/11/cosmos-4-2-2-released/">
      Ball Aerospace COSMOS 4.2.2 Released
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      release
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      11 Apr 2018
    </span>
    <a href="https://github.com/ryanmelt" class="post-author">
      <img src="https://github.com/ryanmelt.png" class="avatar" alt="ryanmelt avatar" width="24" height="24">
      ryanmelt
    </a>
  </div>
  <div class="post-content">
    <p>COSMOS 4.2 is here!   Thirty four tickets went into this release, but the highlight is a new tool called the Data Archival and Retrieval Tool (DART).   DART is a long term trending database built on top of the PostgreSql database.  It integrates directly with TlmGrapher, TlmExtractor, CmdExtractor, DataViewer, and Replay, allowing you to do historical queries of logged telemetry (and commands) by specifying a time range.  Queries are super fast and it performs automatic data reduction at minute/hour/day granularity.  Consider setting it up for your project and start data mining today!</p>

<p>See the COSMOS documentation for directions on setting up DART: http://cosmosrb.com/docs/home/</p>

<h3 id="new-features">New Features:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/698">#698</a> Initial DART Release</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/650">#650</a> Gracefully handle large array items</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/673">#673</a> Button widget should spawn thread to avoid blocking GUI</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/676">#676</a> Allow individual interfaces to be disconnect mode</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/699">#699</a> Test cases added to TestRunner should be ordered in drop down</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/705">#705</a> Cmd line arg for ScriptRunner to start in disconnect mode</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/706">#706</a> Warn if ITEMs or PARAMETERs are redefined</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/711">#711</a> Allow ERB to know the target name</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/715">#715</a> Allow individual Limits Monitor items to be removed (not ignored)</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/719">#719</a> Warn if limits_group doesn’t exist in limits_groups_background_task</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/729">#729</a> CmdSender production mode to disable MANUALLY ENTERED</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/734">#734</a> Support DERIVED with APPEND</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/737">#737</a> Implement single stepping with the F10 key</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/754">#754</a> Add Replay Mode to Include All Routers</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/765">#765</a> TlmGrapher sampled analysis</li>
</ul>

<h3 id="maintenance">Maintenance:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/682">#682</a> Fix Ruby interpreter warnings</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/687">#687</a> Add ConfigEditor AHK tests</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/688">#688</a> Windows 10 Installation Error - RDoc parsing failure in qtruby4.rb</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/692">#692</a> Fix METADATA usage in demo</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/738">#738</a> PacketViewer scroll to item on search</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/748">#748</a> Syntax highlighting prioritizes string over comment</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/750">#750</a> TestRunner hides syntax errors with broad rescue</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/752">#752</a> Demo INST commanding screen broken</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/757">#757</a> Increase TlmGrapher timeout to better support Replay</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/759">#759</a> Allow underscores and dashes in log filename labels</li>
</ul>

<h3 id="bug-fixes">Bug Fixes:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/690">#690</a> Automatic SYSTEM META definition doesn’t include RECEIVED_XX</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/691">#691</a> tools/mac apps won’t open</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/701">#701</a> XTCE String types should not have ByteOrderList</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/709">#709</a> Can’t set breakpoint in subscript</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/713">#713</a> Launcher crashes if newline in crc.txt</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/723">#723</a> crc_protocol needs better input validation</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/727">#727</a> Install issue on Windows 10</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/732">#732</a> losing/gaining data when routing at different incoming rates</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/735">#735</a> Statistics Processor doesn’t handle nil or infinite</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/740">#740</a> About dialog crashes if USER_VERSION not defined</li>
</ul>

<h3 id="migration-notes-from-cosmos-41x">Migration Notes from COSMOS 4.1.x:</h3>

<p>To upgrade to the latest version of COSMOS, run “bundle update cosmos” in your COSMOS project folder.</p>

<p>See the COSMOS documentation for directions on setting up DART: http://cosmosrb.com/docs/home/</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2018/03/14/derived-items/">
      Derived Items
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      post
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      14 Mar 2018
    </span>
    <a href="https://github.com/jmthomas" class="post-author">
      <img src="https://github.com/jmthomas.png" class="avatar" alt="jmthomas avatar" width="24" height="24">
      jmthomas
    </a>
  </div>
  <div class="post-content">
    <h2 id="cosmos-derived-items">COSMOS Derived Items</h2>
<p>COSMOS has a concept of a derived item which is a telemetry item that doesn’t actually exist in the binary data. Derived items are typically computed based on other telemetry items. COSMOS automatically defines three derived items on every packet: RECEIVED_TIMESECONDS, RECEIVED_TIMEFORMATTED, and RECEIVED_COUNT. The time items are set to the time that the COSMOS Command and Telemetry Server receives the packet. The count is a running count of the number of packets received since the Server started. Note that the count is always a relative count and should only be used accordingly.</p>

<p>COSMOS derived items are defined very similarly to real items except they use the special DERIVED telemetry type. Here is how the default COSMOS derived items might look in a telemetry definition.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ITEM PACKET_TIMESECONDS 0 0 DERIVED "COSMOS Received Time (UTC, Floating point, Unix epoch)"
  READ_CONVERSION packet_time_seconds_conversion.rb
  FORMAT_STRING '%0.6f'
ITEM PACKET_TIMEFORMATTED 0 0 DERIVED "COSMOS Received Time (Local time zone, Formatted string)"
  READ_CONVERSION packet_time_formatted_conversion.rb
ITEM RECEIVED_TIMESECONDS 0 0 DERIVED "COSMOS Received Time (UTC, Floating point, Unix epoch)"
  READ_CONVERSION received_time_seconds_conversion.rb
  FORMAT_STRING '%0.6f'
ITEM RECEIVED_TIMEFORMATTED 0 0 DERIVED "COSMOS Received Time (Local time zone, Formatted string)"
  READ_CONVERSION received_time_formatted_conversion.rb
ITEM RECEIVED_COUNT 0 0 DERIVED "COSMOS packet received count"
  READ_CONVERSION received_count_conversion.rb
</code></pre></div></div>

<p>Note the DERIVED type where real items are INT, UINT, FLOAT, STRING or BLOCK. Also note that the bit offset and bit size values are zero. This is due to the fact that these items don’t actually exist in the binary packet but are created on the fly when the packet is processed. This also has implications with playback of the data. Since these items don’t actually exist in the binary file, they are created on the fly even when doing playback through the Replay tool. Thus if your DERIVED item is aggregating multiple values such as a running average, it will take a few samples to generate a good value.</p>

<h3 id="creating-a-derived-average">Creating a Derived Average</h3>
<p>A common usecase is to create a derived item which averages other telemetry points. Let’s explore how to do this within the COSMOS Demo. The COSMOS Demo already declares 4 fake temperatures named TEMP1, TEMP2, TEMP3, and TEMP4. Let’s create a new derived item called TEMP_AVERAGE that averages them.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ITEM TEMP_AVERAGE 0 0 DERIVED "Average of TEMP1, TEMP2, TEMP3, TEMP4"
  GENERIC_READ_CONVERSION_START FLOAT 32
    (packet.read("TEMP1") + packet.read("TEMP2") + packet.read("TEMP3") + packet.read("TEMP4")) / 4.0
  GENERIC_READ_CONVERSION_END
</code></pre></div></div>

<p>The GENERIC_READ_CONVERSION_START keyword also takes two additional argument which describe the output of the conversion. Here we specify FLOAT 32 to indicate the conversion will return a 32 bit floating point value.</p>

<p>In the code section, note the use of the built in variable called ‘packet’. When you create a generic conversion you always have access to the ‘packet’ variable which references the packet the conversion is declared in. For more information about how to use ‘packet’ please see the <a href="/docs/packet_class/">Packet</a> documentation. You also have access to ‘value’ which is the raw value of the current item. In the case of a DERIVED item the value is nil. You can also access ‘buffer’ which is the raw buffer associated with the packet.</p>

<h3 id="using-a-conversion-class">Using a Conversion Class</h3>
<p>While it is easy to create a simple conversion using GENERIC_READ_CONVERSION there are multiple reasons to prefer a Conversion class. Creating a separate conversion class is easier to test, easier to reuse and has better performance. Let’s create a conversion which performs averging and rewrite the previous example. First the telemetry definition will now look like this.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ITEM TEMP_AVERAGE 0 0 DERIVED "Average of TEMP1, TEMP2, TEMP3, TEMP4"
  READ_CONVERSION average_conversion.rb TEMP1 TEMP2 TEMP3 TEMP4
</code></pre></div></div>

<p>We now need to implement average_conversion.rb to take our arguments and generate the average. Put this new file in the target’s lib folder (in the demo this is config/targets/INST/lib).</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="nb">require</span> <span class="s1">'cosmos/conversions/conversion'</span>
<span class="k">module</span> <span class="nn">Cosmos</span>
  <span class="k">class</span> <span class="nc">AverageConversion</span> <span class="o">&lt;</span> <span class="no">Conversion</span>
    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
      <span class="k">super</span><span class="p">()</span>
      <span class="vi">@items</span> <span class="o">=</span> <span class="n">args</span>
      <span class="vi">@converted_type</span> <span class="o">=</span> <span class="ss">:FLOAT</span>
      <span class="vi">@converted_bit_size</span> <span class="o">=</span> <span class="mi">32</span>
    <span class="k">end</span>

    <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">packet</span><span class="p">,</span> <span class="n">buffer</span><span class="p">)</span>
      <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="vi">@items</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">item</span><span class="o">|</span>
        <span class="n">total</span> <span class="o">+=</span> <span class="n">packet</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
      <span class="k">end</span>
      <span class="k">return</span> <span class="n">total</span> <span class="o">/</span> <span class="vi">@items</span><span class="p">.</span><span class="nf">length</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></figure>

<p>Here I’m using the Ruby splat operator to collect all the arguments passed into initialize and assign them to @items. I also explicitly set the @converted_type and @converted_bit_size variables (part of the Conversion base class) to :FLOAT and 32 to indicate our conversion will return a 32 bit floating point number. The call method is what actually performs the conversion. Note how it defines the same three variables I previously talked about: value, packet and buffer. I use the packet argument to read the items passed in and then divide by the total to average them.</p>

<p>We’re not yet done though as we need to edit the INST/target.txt file to require this new conversion.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>REQUIRE average_conversion.rb
</code></pre></div></div>

<p>Running this in the Demo with Telemetry Grapher shows our new average value pretty clearly.</p>

<p><img src="/img/2018_03_14_tlm_grapher_derived.png" alt="Tlm Grapher Derived" /></p>

<p>Conversions and DERIVED variables are powerful ways to add additional telemetry points based on existing data in your packet structure. Another way to add insight into your telemetry is to add <a href="/news/2017/05/08/packet_processors/">Packet Processors</a> which I’ve previously blogged about.</p>

<p>If you have a question which would benefit the community or find a possible bug please use our <a href="https://github.com/BallAerospace/COSMOS/issues">Github Issues</a>. If you would like more information about a COSMOS training or support contract please contact us at <a href="mailto:cosmos@ball.com">cosmos@ball.com</a>.</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2018/02/12/limits/">
      Limits
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      post
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      12 Feb 2018
    </span>
    <a href="https://github.com/jmthomas" class="post-author">
      <img src="https://github.com/jmthomas.png" class="avatar" alt="jmthomas avatar" width="24" height="24">
      jmthomas
    </a>
  </div>
  <div class="post-content">
    <h2 id="cosmos-limits">COSMOS Limits</h2>
<p>COSMOS allows you to <a href="/docs/telemetry/#limits">define limits</a> for your telemetry items to provide feedback to users about how your telemetry is performing. If you define limits, COSMOS requires you to specify both red and yellow limits. Red limits are traditionally where damage may occur while yellow limits are set a certain percentage away from red to give the operator a chance to respond before the red limits are hit. COSMOS also allows the user to set “Operational” limits (blue limits) which specify a desired operational range inside the green limits. This is best illustrated in the COSMOS demo. Here is a partial screenshot of the INST HS screen in Telemetry Viewer.</p>

<p><img src="/img/2018_02_12_temps.png" alt="Demo MetaData" /></p>

<p>The TEMP1 telemetry point is using the LABELTRENDLIMITSBAR widget in the INST HS screen definition to display both the value (the temperature), the trend (how the data has been moving over the past 60s), as well as the limits bar. The TEMP2 telemetry point is simply using the LABELVALUELIMITSBAR widget so it shows just the value and the limits bar. Notice how the scale of the yellow regions are different for TEMP1 and TEMP2. The regions are scaled according to their defined value ranges.</p>

<p>This type of limits bar is also used by the Limits Monitor tool to display out of limits items system wide.</p>

<p><img src="/img/2018_02_12_limits_monitor.png" alt="Demo MetaData" /></p>

<p>Here I’ve ignored various other items to focus on the INST HEALTH_STATUS packet containing TEMP1 and TEMP2. Notice that the overall limit is yellow since TEMP1 is yellow even though TEMP2 is green. The worst case limts item is reflected in the Monitored Limits State. Also note that TEMP2 appears above TEMP1 because it happened to go out of limits first while I was running the demo. Items appear in Limits Monitor as they go out of limits. Also note that even though TEMP2 is green it still shows up in Limits Monitor because it <em>previously</em> went out of limits. If you switch to the Log tab you can see exactly when an item went out of limits and when it went back to green.</p>

<h3 id="scripting-limits">Scripting Limits</h3>
<p>You can get this same information from a script by executing the following script in Script Runner.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="nb">puts</span> <span class="s2">"Overall limits state: </span><span class="si">#{</span><span class="n">get_overall_limits_state</span><span class="si">}</span><span class="s2">"</span>
<span class="n">get_out_of_limits</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">item</span><span class="o">|</span>
  <span class="n">tgt</span><span class="p">,</span> <span class="n">pkt</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">state</span> <span class="o">=</span> <span class="n">item</span>
  <span class="nb">puts</span> <span class="s2">"tgt:</span><span class="si">#{</span><span class="n">tgt</span><span class="si">}</span><span class="s2"> pkt:</span><span class="si">#{</span><span class="n">pkt</span><span class="si">}</span><span class="s2"> item:</span><span class="si">#{</span><span class="n">item</span><span class="si">}</span><span class="s2"> state:</span><span class="si">#{</span><span class="n">state</span><span class="si">}</span><span class="s2">"</span>
<span class="k">end</span></code></pre></figure>

<p>Note that the get_out_of_limits call returns the items which are out of limits at the exact instant of the API call. Thus it doesn’t provide history like the Limits Monitor tool.</p>

<p>You can also disable and enable limits on individual telemetry items using the API. The following script will disable limits on TEMP1 and then after 5 seconds it re-enables limits. Run this with the Limits Monitor open and you’ll notice the text for the INST HEALTH_STATUS TEMP1 telemetry point turns black when limits are disabled. Note that this disables limits events logging in the Command and Telemetry Server for this telemetry point.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="nb">puts</span> <span class="s2">"TEMP1 limits enable:</span><span class="si">#{</span><span class="n">limits_enabled?</span><span class="p">(</span><span class="s2">"INST"</span><span class="p">,</span> <span class="s2">"HEALTH_STATUS"</span><span class="p">,</span> <span class="s2">"TEMP1"</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span>
<span class="n">disable_limits</span><span class="p">(</span><span class="s2">"INST"</span><span class="p">,</span> <span class="s2">"HEALTH_STATUS"</span><span class="p">,</span> <span class="s2">"TEMP1"</span><span class="p">)</span>
<span class="nb">puts</span> <span class="s2">"TEMP1 limits enable:</span><span class="si">#{</span><span class="n">limits_enabled?</span><span class="p">(</span><span class="s2">"INST"</span><span class="p">,</span> <span class="s2">"HEALTH_STATUS"</span><span class="p">,</span> <span class="s2">"TEMP1"</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span>
<span class="n">wait</span> <span class="mi">5</span>
<span class="n">enable_limits</span><span class="p">(</span><span class="s2">"INST"</span><span class="p">,</span> <span class="s2">"HEALTH_STATUS"</span><span class="p">,</span> <span class="s2">"TEMP1"</span><span class="p">)</span>
<span class="nb">puts</span> <span class="s2">"TEMP1 limits enable:</span><span class="si">#{</span><span class="n">limits_enabled?</span><span class="p">(</span><span class="s2">"INST"</span><span class="p">,</span> <span class="s2">"HEALTH_STATUS"</span><span class="p">,</span> <span class="s2">"TEMP1"</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span></code></pre></figure>

<h2 id="limits-sets">Limits Sets</h2>
<p>COSMOS requires the first item after the <a href="/docs/telemetry/#limits">LIMITS</a> keyword to be the name of the limits set. Limits sets are system wide sets of limits which can be applied depending on the environment you’re testing in. Perhaps you have a “Test” set of limits which are different from your “Operational” limits. At Ball Aerospace, we frequently define cyrogentic limits when testing spacecraft in a vacuum chamber at cyrogenic temperatures. COSMOS requires at least one limits definition to belong to “DEFAULT” which is used when COSMOS starts. If you forget to define a DEFAULT limits set, you’ll get this error when you start the COSMOS Command and Telemetry Server.</p>

<p><img src="/img/2018_02_12_limits_error.png" alt="Demo MetaData" /></p>

<p>Once you’ve defined your limits sets how do you use them? The COSMOS Command and Telemetry Server has a Status tab which allows you to manually change the limits set using a drop down.</p>

<p><img src="/img/2018_02_12_server_limits_set.png" alt="Demo MetaData" /></p>

<p>Notice the log contains “INFO: Limits Set Changed to: TVAC”. This happened immediately after I manually changed the Limits Set drop down from DEFAULT to TVAC. This message is automatically generated whenever the limits set is changed either manually or from the API.</p>

<h3 id="scripting-limits-sets">Scripting Limits Sets</h3>
<p>You can also manipulate the limits sets programatically from a script.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">get_limits_sets</span><span class="p">.</span><span class="nf">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">set</span><span class="o">|</span> <span class="nb">puts</span> <span class="s2">"Limits Set:</span><span class="si">#{</span><span class="n">set</span><span class="si">}</span><span class="s2">"</span> <span class="p">}</span>
<span class="nb">puts</span> <span class="s2">"Current Set:</span><span class="si">#{</span><span class="n">get_limits_set</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span> <span class="c1"># Currently selected limits set</span>
<span class="n">set_limits_set</span><span class="p">(</span><span class="s2">"DEFAULT"</span><span class="p">)</span> <span class="c1"># Change to DEFAULT</span>
<span class="n">set_limits_set</span><span class="p">(</span><span class="s2">"TVAC"</span><span class="p">)</span> <span class="c1"># Change to TVAC</span></code></pre></figure>

<h2 id="limits-groups">Limits Groups</h2>
<p>COSMOS also has the concept of limits groups. Limits groups are used to group together telemetry items so they can be enabled and disabled together. For example, if you have several physical devices in your system, you can group together items from each device and enable their limits when they power on and disable them when they power off. This is useful to avoid limits violations on items which are currently off and returning zeros.</p>

<p>Limits groups are defined by the <a href="/docs/telemetry/#limits_group">LIMITS_GROUP</a> keyword. Typically this is a separate file in your target’s cmd_tlm folder. If you’re creating a group which combines items from multiple targets we recommend to define this in the SYSTEM target’s cmd_tlm folder. This is how the COSMOS demo is configured with a limits_groups.txt file in SYSTEM/cmd_tlm.</p>

<p>Items are assigned to a group using the <a href="/docs/telemetry/#limits_group_item">LIMITS_GROUP_ITEM</a> keyword. Here is the definition in the COSMOS demo.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>LIMITS_GROUP INST2_TEMP2
  LIMITS_GROUP_ITEM INST2 HEALTH_STATUS TEMP2

LIMITS_GROUP INST2_GROUND
  LIMITS_GROUP_ITEM INST2 HEALTH_STATUS GROUND1STATUS
  LIMITS_GROUP_ITEM INST2 HEALTH_STATUS GROUND2STATUS
</code></pre></div></div>

<h3 id="scripting-limits-groups">Scripting Limits Groups</h3>
<p>You can also manipulate the limits groups programatically from a script.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">get_limits_groups</span><span class="p">.</span><span class="nf">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">group</span><span class="o">|</span> <span class="nb">puts</span> <span class="s2">"Limits Group:</span><span class="si">#{</span><span class="n">group</span><span class="si">}</span><span class="s2">"</span> <span class="p">}</span>
<span class="n">enable_limits_group</span><span class="p">(</span><span class="s2">"INST2_TEMP2"</span><span class="p">)</span>
<span class="n">disable_limits_group</span><span class="p">(</span><span class="s2">"INST2_GROUND"</span><span class="p">)</span></code></pre></figure>

<h3 id="automating-limits-groups">Automating Limits Groups</h3>
<p>COSMOS also has the ability to automatically enable and disable limits groups based on user configurable conditions. For example, you can automatically enable the group for a particular device when the power supply voltage for that device goes high (the device is powered on). The COSMOS demo has an example of this in the SYSTEM/lib/limits_groups.rb file.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="nb">require</span> <span class="s1">'cosmos/tools/cmd_tlm_server/limits_groups_background_task'</span>

<span class="k">module</span> <span class="nn">Cosmos</span>
  <span class="c1"># Inheriting from the LimitsGroupsBackgroundTask provides a framework for</span>
  <span class="c1"># automatically enabling and disabling limits groups based on telemetry.</span>
  <span class="k">class</span> <span class="nc">LimitsGroups</span> <span class="o">&lt;</span> <span class="no">LimitsGroupsBackgroundTask</span>
    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">initial_delay</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">task_delay</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
      <span class="c1"># Initial delay upon starting the server before staring the group checks</span>
      <span class="c1"># followed by the background task delay between check iterations</span>
      <span class="k">super</span><span class="p">(</span><span class="n">initial_delay</span><span class="p">,</span> <span class="n">task_delay</span><span class="p">)</span>
      <span class="c1"># Creating a Proc allows for arbitrary code to be executed when a group</span>
      <span class="c1"># is enabled or disabled.</span>
      <span class="vi">@temp2_enable_code</span> <span class="o">=</span> <span class="no">Proc</span><span class="p">.</span><span class="nf">new</span> <span class="k">do</span>
        <span class="n">enable_limits_group</span><span class="p">(</span><span class="s1">'INST2_GROUND'</span><span class="p">)</span> <span class="c1"># Enable the INST2_GROUND group</span>
      <span class="k">end</span>
      <span class="vi">@temp2_disable_code</span> <span class="o">=</span> <span class="no">Proc</span><span class="p">.</span><span class="nf">new</span> <span class="k">do</span>
        <span class="n">disable_limits_group</span><span class="p">(</span><span class="s1">'INST2_GROUND'</span><span class="p">)</span> <span class="c1"># Disable the INST2_GROUND group</span>
      <span class="k">end</span>
    <span class="k">end</span></code></pre></figure>

<p>You first must require the COSMOS base class and inherit from LimitsGroupsBackgroundTask. The constructor (initialize) takes two delay parameters. The first is the initial delay after starting the Command and Telemetry Server before the task starts checking your logical conditions. The second is the delay between doing the checks (it controls the rate of the task). After calling super (important!) a Proc is created to run arbitrary code when a particular group is enabled or disabled. Note this is entirely optional but in this case we wanted to enable the INST2_GROUND group when the INST2_TEMP2 group got enabled. The @temp2_enable_code and @temp2_disable_code names don’t really matter but they must be unique and have the ‘@’ symbol to make them Ruby instance variables (rather than locals).</p>

<p>After the constructor is configured the method to perform the check is implemented.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">def</span> <span class="nf">check_inst2_temp2</span>
  <span class="n">process_group</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="vi">@temp2_enable_code</span><span class="p">,</span> <span class="vi">@temp2_disable_code</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">val</span> <span class="o">=</span> <span class="n">tlm</span><span class="p">(</span><span class="s2">"INST2 HEALTH_STATUS TEMP2"</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="o">!</span><span class="n">val</span><span class="p">.</span><span class="nf">nan?</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">val</span><span class="p">.</span><span class="nf">infinite?</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></figure>

<p>The method name is very important. It must begin with ‘check_’ and end with the name of a Limits Group defined by the LIMITS_GROUP keyword. In the demo, LIMITS_GROUP(s) are defined in config/targets/SYSTEM/cmd_tlm/limits_groups.txt. Since there is a LIMITS_GROUP INST2_TEMP2 we have a match (the method name should be lower case while the LIMITS_GROUP is typically defined to be uppercase).</p>

<p>Inside the method you must call process_group. The first parameter is the number of seconds to delay before enabling the group when the telemetry check is true. So in this example we are waiting zero seconds to enable the group. Note that when the telemetry check is false the group is instantly disabled. The next two parameters are Proc objects which are called when the group is enabled and disabled respectively. Remember that we defined our Proc objects in the constructor to enable and disable the INST2_GROUND group. These parameters are entirely optional so you can also simply call <code class="highlighter-rouge">process_group(0)</code> with just the delay.</p>

<p>The code inside the process_group block (the lines after ‘do’ and before ‘end’) must return a boolean. True will enable the group and false will disable the group. In this example, the group is enabled when the value is not NaN (Not a Number) and not Infinite. If the value is NaN or Infinite the group is disabled. You can watch this happening in the demo by watching the bottom log portion of the Command and Telemetry Server.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2018/02/12 09:12:58.118  ERROR: INST HEALTH_STATUS TEMP2 = NaN is RED_LOW
2018/02/12 09:12:58.121  ERROR: INST2 HEALTH_STATUS TEMP2 = NaN is RED_LOW
2018/02/12 09:12:58.220  INFO: Disabling Limits Group: INST2_TEMP2
2018/02/12 09:12:58.220  INFO: Disabling Limits Group: INST2_GROUND
</code></pre></div></div>

<p>First TEMP2 transitions to NaN (this is done on purpose for the demo) which is a RED_LOW limits violation. 100ms later (due to processing time) the INST2_TEMP2 group is disabled followed by the INST2_GROUND group due to the Proc code we created.</p>

<h2 id="other-limits-apis">Other Limits APIs</h2>
<p>There are a few other APIs which are provided to work with COSMOS limits.</p>

<p><code class="highlighter-rouge">get_stale</code> returns all the stale packets in the system. Stale packets are those which have not been received by the Command and Telemetry Server for the <a href="/docs/system/#staleness_seconds">STALENESS_SECONDS</a> setting (by default 30s).</p>

<p><code class="highlighter-rouge">get_limits(tgt, pkt, item)</code> returns the limits settings for a particular telemetry item. It returns an array of the group name, persistence setting, enable setting, red low, yellow low, yellow high, red high, blue low, and blue high limits values. If no blue operational limits were set those values are nil.</p>

<p><code class="highlighter-rouge">set_limits(tgt, pkt, item, red_low, yellow_low, yellow_high, red_high,</code>
<code class="highlighter-rouge">blue_low = nil, blue_high = nil, limits_set = :CUSTOM, persistence = nil, enabled = true)</code> allows the user to set new values for the limits settings. Some values have defaults and some do not. Thus you must provide at least the first 7 parameters for this call to be successful. Note the order of parameters: red low, yellow low, yellow high, red high, and then blue low, blue high. By default the limits_set is :CUSTOM which is probably not a limits set you already have defined. Thus is you don’t set the limits_set parameter it may appear as if nothing has happened. To enable the new limits you have to manually change to the CUSTOM limits set: <code class="highlighter-rouge">set_limits_set("CUSTOM")</code>. Alternatively, you can specify :DEFAULT for the limits_set parameter and you will typically immediately see the change (assuming DEFAULT is the active set). If you only want to change one particular value you can call <code class="highlighter-rouge">get_limits</code> first to get the current settings and only change the value you want.</p>

<p>You can also use API methods to subscribe to limits events. This allows you to process all limits events in the same way the Limits Monitor application does. To start you must subscribe to limits events using <code class="highlighter-rouge">subscribe_limits_events(queue_size = 1000)</code> which returns an ID. You can then call <code class="highlighter-rouge">get_limits_event(id)</code> and pass in the ID to get limits event type and data from the server. There are three different limits event types: LIMITS_CHANGE, LIMITS_SET, and LIMITS_SETTING. LIMITS_CHANGE is when a particular item goes out of limits. This is by far the most common and probably the one you’re most interested in. LIMITS_SET events happen when the overall limits set changes. LIMITS_SETTING events are generated when the set_limits method is called to change the limits on an individual item. The <code class="highlighter-rouge">get_limits_event</code> method takes a boolean second parameter to determine whether or not to block when waiting for an event. The default is false which means it blocks waiting for an event. You can also pass true which means to not block waiting for events. However if no event is present <code class="highlighter-rouge">get_limits_event</code> will raise a ThreadError. Thus you must catch the error to allow your code to continue. Finally you call <code class="highlighter-rouge">unsubscribe_limits_events(id)</code> when shutting down.</p>

<div class="note warning">
  <p><b>Overflown Queues Are Deleted</b></p>
  <p>By default the limits queue is 1000 events deep. If you don't call get_limits_event fast enough to keep up with the population of this queue and it overflows, COSMOS will clean up the resources and delete the queue. At this point when you call get_limits_event you will get a "RuntimeError : Packet data queue with id X not found." Note you can pass a larger queue size to the subscribe_limits_events method.</p>
</div>

<p>Here’s a example of using the subscription APIs.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="nb">id</span> <span class="o">=</span> <span class="n">subscribe_limits_events</span><span class="p">()</span>
<span class="k">while</span> <span class="kp">true</span>
  <span class="n">type</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">get_limits_event</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span> <span class="c1"># block waiting</span>
  <span class="nb">puts</span> <span class="s2">"type:</span><span class="si">#{</span><span class="n">type</span><span class="si">}</span><span class="s2"> data:</span><span class="si">#{</span><span class="n">data</span><span class="si">}</span><span class="s2">"</span>
  <span class="c1"># break if XXX # Break the loop when ...</span>
<span class="k">end</span>
<span class="n">unsubscribe_limits_events</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>

<span class="nb">id</span> <span class="o">=</span> <span class="n">subscribe_limits_events</span><span class="p">()</span>
<span class="k">while</span> <span class="kp">true</span>
  <span class="k">begin</span>
    <span class="n">type</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">get_limits_event</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="kp">true</span><span class="p">)</span> <span class="c1"># don't block</span>
    <span class="nb">puts</span> <span class="s2">"type:</span><span class="si">#{</span><span class="n">type</span><span class="si">}</span><span class="s2"> data:</span><span class="si">#{</span><span class="n">data</span><span class="si">}</span><span class="s2">"</span>
    <span class="c1"># break if XXX # Break the loop when ...</span>
  <span class="k">rescue</span> <span class="no">ThreadError</span> <span class="c1"># raised if no event present</span>
    <span class="n">wait</span> <span class="mi">1</span> <span class="c1"># Wait before checking again</span>
  <span class="k">end</span>
<span class="k">end</span>
<span class="n">unsubscribe_limits_events</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span></code></pre></figure>

<h2 id="conclusion">Conclusion</h2>
<p>Limits are a powerful concept in COSMOS. Sets provide for a system wide setting that affects all limits items. Groups allow limits items to be grouped to typically enable and disable them together. APIs allow the user to query and set limits across the system while subscriptions provide notifications for every limits event action.</p>

<p>If you have a question which would benefit the community or find a possible bug please use our <a href="https://github.com/BallAerospace/COSMOS/issues">Github Issues</a>. If you would like more information about a COSMOS training or support contract please contact us at <a href="mailto:cosmos@ball.com">cosmos@ball.com</a>.</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2018/01/18/metadata/">
      Metadata
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      post
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      18 Jan 2018
    </span>
    <a href="https://github.com/jmthomas" class="post-author">
      <img src="https://github.com/jmthomas.png" class="avatar" alt="jmthomas avatar" width="24" height="24">
      jmthomas
    </a>
  </div>
  <div class="post-content">
    <p>Metadata is data about data, i.e. information describing the data like when it was taken, version information, etc. COSMOS has explicit support for metadata, especially since the <a href="/news/2017/08/04/cosmos-4-0-0-released/">4.0.0</a> release.</p>

<h3 id="metadata-overview">Metadata Overview</h3>

<p>In versions of COSMOS prior to 4.0.0, metadata could be defined in any target / packet combination. In the COSMOS demo we defined metadata in the META target and DATA packet. You would then explicitly tell COSMOS where this metadata was defined by passing the target and packet name to the tools. Here is a example of an old (pre 4.0.0) cmd_tlm_server.txt configuration file:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PACKET_LOG_WRITER DEFAULT meta_packet_log_writer.rb META DATA config/data/meta_init.txt
COLLECT_METADATA META DATA
</code></pre></div></div>

<p>Here is an example of a current (post 4.0.0) cmd_tlm_server.txt configuration file:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PACKET_LOG_WRITER DEFAULT packet_log_writer.rb nil true nil 2000000000 nil false
COLLECT_METADATA
</code></pre></div></div>

<p>The PACKET_LOG_WRITER and COLLECT_METADATA keywords no longer have to specify where the metadata is stored because COSMOS 4.0.0 standardized the metadata definition in the SYSTEM target and META packet. You’ll notice the old cmd_tlm_server.txt file specified the location of a meta_init.txt file. This file contains the default values to use when initializing the metadata dialog. In post COSMOS 4.0.0 this file is defined in system.txt using the META_INIT keyword like so:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>META_INIT config/data/meta_init.txt
</code></pre></div></div>

<p>Note that you do not have to define all the items in your metadata in your meta_init file. Any items not found in meta_init will simply be blank in the dialog. If you try to set any of the COSMOS reserved items (defined below) they will simply be overriden with the COSMOS defined values.</p>

<p>If you do not define any metadata in your system (you don’t declare the SYSTEM META packet), COSMOS will automatically define the following items:</p>
<ul>
  <li><code class="highlighter-rouge">SYSTEM META PKTID</code> - Always 1 and used to identify the packet</li>
  <li><code class="highlighter-rouge">SYSTEM META CONFIG</code> - Configuration name (MD5 checksum)</li>
  <li><code class="highlighter-rouge">SYSTEM META COSMOS_VERSION</code> - COSMOS Version (e.g. 4.1.1)</li>
  <li><code class="highlighter-rouge">SYSTEM META USER_VERSION</code> - Defined by the USER_VERSION constant. Typically set in <a href="https://github.com/BallAerospace/COSMOS/blob/master/demo/lib/user_version.rb">lib/user_version.rb</a> in your configuration.</li>
  <li><code class="highlighter-rouge">SYSTEM META RUBY_VERSION</code> - Ruby Version (e.g. 2.4.2p198)</li>
</ul>

<p>These items help identify the telemetry being collected by the currently running instance of the COSMOS Server. In fact, every time COSMOS starts a new log file it adds the SYSTEM META packet to the beginning. This behavior was possible prior to COSMOS 4.0.0 but required using the special meta_packet_log_writer in the cmd_tlm_server.txt definition as shown in the first cmd_tlm_server.txt example.</p>

<h3 id="defining-metadata">Defining Metadata</h3>

<p>If you want to add your own fields to the COSMOS metadata you must define the standard COSMOS metadata items and then append your new values. For example, the COSMOS demo defines the following in <a href="https://github.com/BallAerospace/COSMOS/blob/master/demo/config/targets/SYSTEM/cmd_tlm/meta_tlm.txt">targets/SYSTEM/cmd_tlm/meta_tlm.txt</a>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>TELEMETRY SYSTEM META BIG_ENDIAN "System Meta Data Telemetry Packet"
  APPEND_ID_ITEM PKTID 8 UINT 1 "Packet Id"
  APPEND_ITEM CONFIG 256 STRING "Configuration Name"
  APPEND_ITEM COSMOS_VERSION 240 STRING "COSMOS Version"
    META READ_ONLY
  APPEND_ITEM USER_VERSION 240 STRING "User Project Version"
    META READ_ONLY
  APPEND_ITEM RUBY_VERSION 240 STRING "Ruby Version"
    META READ_ONLY
  APPEND_ITEM OPERATOR_NAME 512 STRING "Operator Name"
</code></pre></div></div>

<p>Here we see the demo defining their own new metadata item called OPERATOR_NAME after the standard COSMOS items. Note that the definition of the standard COSMOS items is important! If you misspell an item, declare the wrong data type, or have the size wrong, COSMOS will warn you that the definition is incorrect and then define the standard set of items as described above. Thus if you’re trying to create additional items and do not see them, make sure you haven’t defined the COSMOS standard items incorrectly. (NOTE: COSMOS 4.1.2 fixed a <a href="https://github.com/BallAerospace/COSMOS/issues/690">bug</a> in this automatic generation of metadata items)</p>

<p>You can also see the use of the META READ_ONLY keyword being used in the demo configuration. This means that the metadata dialog which is opened when the COLLECT_METADATA keyword is used will display these items as read only as shown below:</p>

<p><img src="/img/2017_12_13_metadata.png" alt="Demo MetaData" /></p>

<p>Also note that you can declare metadata items with STATES and they will be displayed as dropdowns in the metadata dialog. For example if you add the following to the SYSTEM META packet:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>APPEND_ITEM UUT 32 UINT "Unit under test"
  STATE ARTICLE_0 0
  STATE ARTICLE_1 1
</code></pre></div></div>

<p>You would see this:</p>

<p><img src="/img/2017_12_13_metadata2.png" alt="MetaData Dropdown" /></p>

<p>Test Runner also has the ability to require the user to acknowledge the metadata dialog. If you add COLLECT_METADATA to the Test Runner <a href="https://github.com/BallAerospace/COSMOS/blob/master/demo/config/tools/test_runner/test_runner.txt">configuration file</a> you will see the metadata dialog upon starting any test. This is useful to force the test operator to think about anything in the metadata that might have changed prior to running the test. In addition, this forces a new telemetry file to be created with this new metadata information (remember each new binary file contains a SYSTEM META packet at the beginning).</p>

<p>Metadata is a useful way to add information which can’t be determined by the available hardware targets. The OPERATOR_NAME in the demo is an obvious example. Start using metadata to your advantage to help you distinguish your telemetry.</p>

<p>If you have a question which would benefit the community or find a possible bug please use our <a href="https://github.com/BallAerospace/COSMOS/issues">Github Issues</a>. If you would like more information about a COSMOS training or support contract please contact us at <a href="mailto:cosmos@ball.com">cosmos@ball.com</a>.</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2017/12/07/cosmos-4-1-1-released/">
      Ball Aerospace COSMOS 4.1.1 Released
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      release
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      07 Dec 2017
    </span>
    <a href="https://github.com/ryanmelt" class="post-author">
      <img src="https://github.com/ryanmelt.png" class="avatar" alt="ryanmelt avatar" width="24" height="24">
      ryanmelt
    </a>
  </div>
  <div class="post-content">
    <h3 id="new-features">New Features:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/663">#663</a> Built-in protocols to support allow_empty_data</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/666">#666</a> Add ability to create target in ConfigEditor</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/679">#679</a> TlmViewer screen audit shouldn’t count reserved item names</li>
</ul>

<h3 id="maintenance">Maintenance:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/660">#660</a> Update Opengl gem requirement version</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/665">#665</a> Refactor xtce parser</li>
</ul>

<h3 id="bug-fixes">Bug Fixes:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/661">#661</a> Render function bug?</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/674">#674</a> Add TlmViewerConfig spec and fix to_save</li>
</ul>

<h3 id="migration-notes-from-cosmos-40x">Migration Notes from COSMOS 4.0.x:</h3>

<p>Any custom tools in other languages that use the COSMOS API will need to be updated.</p>

<p>To upgrade to the latest version of COSMOS, run “bundle update cosmos” in your COSMOS project folder.</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2017/11/28/cosmos-4-1-0-release-notes/">
      COSMOS 4.1.0 Release Notes
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      post
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      28 Nov 2017
    </span>
    <a href="https://github.com/jmthomas" class="post-author">
      <img src="https://github.com/jmthomas.png" class="avatar" alt="jmthomas avatar" width="24" height="24">
      jmthomas
    </a>
  </div>
  <div class="post-content">
    <p>COSMOS 4.1 has been released and several new noteworthy features were released which weren’t fully captured by the recent <a href="/news/2017/11/17/cosmos-4-1-0-released/">release description</a>. This post will break down the highlights from the new features, maintence items, and bug fixes from the 4.1.0 release.</p>

<h2 id="replay-tool-enhancements">Replay Tool Enhancements</h2>

<p>I think the best new feature in COSMOS 4.1.0 is the ability of the Reply tool to work side by side with the Command and Telemetry Server (<a href="https://github.com/BallAerospace/COSMOS/issues/559">#559</a>). This change actually affects far more than just the Replay tool and the Server because a new “Replay Mode” was built into Data Viewer, Limits Monitor, Packet Viewer, Telemetry Grapher, and Telemetry Viewer.</p>

<p>Replay also got a cosmetic upgrade to look more like the Command and Telemetry Server. Here’s the new Replay in action:</p>

<p><img src="/img/2017_11_28_replay.png" alt="Replay" /></p>

<p>Replay now has tabs for Targets, Cmd Packets, Tlm Packets, Routers, and Status which correspond to the same tabs in the Server. These tabs count the number of packets being processed by Replay. Thus if you rewind the file and play it back, the counts simply keep incrementing.</p>

<p>Here’s a screenshot of Packet Viewer displaying data in this new Replay mode:</p>

<p><img src="/img/2017_11_28_packet_viewer_replay.png" alt="Packet Viewer Replay" /></p>

<p>Here’s another screenshot of Telemetry Grapher displaying data in this new Replay mode:</p>

<p><img src="/img/2017_11_28_tlm_grapher_replay.png" alt="Packet Viewer Replay" /></p>

<p>You’ll notice the tools have a new File menu option to toggle the Replay mode which displays a green “Replay Mode” bar to visually indicate the tool is no longer processing real-time data.</p>

<h2 id="zip-saved-configuration-data">Zip Saved Configuration Data</h2>

<p>Issue <a href="https://github.com/BallAerospace/COSMOS/issues/579">#579</a> was implemented to zip up the COSMOS saved configuration files. This makes configuration managing these saved configurations much easier since you only have to check in a single zip file instead of a folder containing dozens of files and folders.</p>

<p>If you’re not familiar with saved configurations, let me explain why this is important. When COSMOS starts, it parses the configuration files, calculates the MD5 sum, and puts a copy of the configuration in outputs/saved_config (by default). You should always configuration manage these files in the saved_config directory to allow COSMOS to parse old binary files created by that configuration. The only exception is during COSMOS configuration development when you’re certain you no longer need to parse old telemetry bin files.</p>

<p>As an example of how these saved configurations work, consider that you collect data during a test. Next you modify the configuration by adding some telemetry items to a packet which increases the packet length. If you try to parse the old binary file, COSMOS would complain that the binary packet is not long enough to match the new definition. However, if you save the old configuration, COSMOS would match the MD5 sum in the packet with the saved configuration and load the configuration to parse the packet. Note that if COSMOS can’t find the saved configuration it uses the current configuration.</p>

<h2 id="better-step-debugging">Better Step Debugging</h2>

<p>Issue <a href="https://github.com/BallAerospace/COSMOS/issues/620">#620</a> was to move the Script Runner Step button next to the Start, Pause, Stop buttons rather than down in the debugging pane. This should make it a lot easier to use the Step feature when debugging scripts. Here’s a screenshot of a simple script I started using the Step button (available when you enable Debugging via the Script / Toggle Debug menu).</p>

<p><img src="/img/2017_11_28_script_runner_debug.png" alt="Script Runner Debug" /></p>

<p>Issue <a href="https://github.com/BallAerospace/COSMOS/issues/619">#619</a> was implemented to prevent Script Runner from instrumenting comments and whitespace when running scripts. This should also make debugging scripts easier as you don’t have to step over a bunch of comments or whitespace.</p>

<h2 id="api-over-http">API over HTTP</h2>

<p>As Ryan mentioned in the <a href="/news/2017/11/17/cosmos-4-1-0-released/">4.1 Release Notes</a>, issue <a href="https://github.com/BallAerospace/COSMOS/issues/510">#510</a> was created to move the COSMOS API from our custom protocol to HTTP. While this change is transparent to the user, it should make it easier for other languages and tools to interface with the COSMOS system in the future.</p>

<h2 id="bug-fixes">Bug Fixes</h2>

<p>There were a number of bug fixes as noted in the <a href="/news/2017/11/17/cosmos-4-1-0-released/">4.1 Release Notes</a>. <a href="https://github.com/BallAerospace/COSMOS/issues/617">#617</a> and <a href="https://github.com/BallAerospace/COSMOS/issues/659">#659</a> were both related to Ruby 2.4.2 which is the new Ruby version in COSMOS 4.0. Ruby 2.4 is the latest version of Ruby which provides performance improvements you can read about on <a href="https://www.ruby-lang.org/en/news/2016/12/25/ruby-2-4-0-released/">ruby-lang.org</a>. <a href="https://github.com/BallAerospace/COSMOS/issues/616">#616</a> addresses an annoying message generating by QT on Windows 10. <a href="https://github.com/BallAerospace/COSMOS/issues/655">#655</a> addresses an issue with using COLLECT_METADATA in the basic “install” version of COSMOS. <a href="https://github.com/BallAerospace/COSMOS/issues/633">#633</a> fix a bug where the prompt_vertical_message_box and prompt_combo_box scripting methods were mutating the input parameters. If you’re using those scripting methods, you should upgrade to COSMOS 4.1.</p>

<p>There were a number of other enhancements and bug fixes but the previous list is a compelling reason to upgrade to COSMOS 4.1 today!</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2017/11/17/cosmos-4-1-0-released/">
      Ball Aerospace COSMOS 4.1.0 Released
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      release
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      17 Nov 2017
    </span>
    <a href="https://github.com/ryanmelt" class="post-author">
      <img src="https://github.com/ryanmelt.png" class="avatar" alt="ryanmelt avatar" width="24" height="24">
      ryanmelt
    </a>
  </div>
  <div class="post-content">
    <p>Welcome to COSMOS 4.1!  The COSMOS API has transitioned from a custom TCP protocol to HTTP.  This will make interfacing to COSMOS from programming languages other than Ruby much easier.  There are also many new APIs that allows the full functionality of the CmdTlmServer and Replay to be controlled remotely.  See below for the full list of changes!</p>

<h3 id="new-features">New Features:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/531">#531</a> Command sequence export option</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/558">#558</a> subscription APIs should work in disconnect mode</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/559">#559</a> Build Replay Functionality into CmdTlmServer</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/578">#578</a> Add ability to query available screens from Telemetry Viewer</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/579">#579</a> Create zip of configuration in saved config</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/581">#581</a> Make various log files readonly</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/587">#587</a> AUTO_INTERFACE_TARGETS ignore existing interfaces</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/591">#591</a> Investigate creating single COSMOS UDP socket for case where read_port == write_src_port</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/599">#599</a> Create subscription API for CTS messages</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/601">#601</a> Add background task and other status APIs</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/606">#606</a> Enhancement to Open File Script Interface - File Filter</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/612">#612</a> CSV support for strings and symbols</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/620">#620</a> Move Script Runner step button next to start/go</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/625">#625</a> Add APIs to start/stop background tasks</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/626">#626</a> Add API functions to get ignored parameters/items</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/635">#635</a> get_cmd_param_list should return the type for each command parameter</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/642">#642</a> Handle Infinity/NaN without invalid JSON</li>
</ul>

<h3 id="maintenance">Maintenance:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/510">#510</a> Investigate changing JsonDrb to running over HTTP</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/603">#603</a> CmdTlmServer invalid constructor argument</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/614">#614</a> Pass server message color to message subscriptions</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/619">#619</a> Script Runner instrumenting comments and whitespace</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/630">#630</a> Add ConfigEditor and CmdSequence to install launcher</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/647">#647</a> Make packet item sort consistent</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/649">#649</a> Add codecov support</li>
</ul>

<h3 id="bug-fixes">Bug Fixes:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/562">#562</a> #562 Template protocol should fill Id fields</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/577">#577</a> #577 Telemetry Viewer has fatal exception when called with JSON-RPC method display</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/593">#593</a> #593 Race condition in Cosmos.kill_thread</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/607">#607</a> #607 Support latest version of wkhtmltopdf for pdf creation and properly set working dir</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/610">#610</a> #610 target shouldn’t report error requiring file in target lib</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/616">#616</a> #616 Ignore untested Windows version message in Windows 10</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/617">#617</a> #617 Ruby 2.4’s inherent Warning class shadows Qt::MessageBox::Warning</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/633">#633</a> #633 combo_box is mutating input</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/639">#639</a> #639 Partial rendering in config parser should enforce that rendered partials start with underscore</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/654">#654</a> #654 Test Runner crashes with no config file</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/655">#655</a> #655 Metadata system triggers a nil router error in api.rb with basic setup</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/659">#659</a> #659 Hazardous commands throwing errors</li>
</ul>

<h3 id="migration-notes-from-cosmos-40x">Migration Notes from COSMOS 4.0.x:</h3>

<p>Any custom tools in other languages that use the COSMOS API will need to be updated.</p>

<p>To upgrade to the latest version of COSMOS, run “bundle update cosmos” in your COSMOS project folder.</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2017/11/13/require_vs_load/">
      Require vs Load
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      post
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      13 Nov 2017
    </span>
    <a href="https://github.com/jmthomas" class="post-author">
      <img src="https://github.com/jmthomas.png" class="avatar" alt="jmthomas avatar" width="24" height="24">
      jmthomas
    </a>
  </div>
  <div class="post-content">
    <p>As a COSMOS developer I often get asked about require vs load vs require_utility vs load_utility and what do they all mean. Let me explain these keywords and how they are used within Ruby and COSMOS.</p>

<h3 id="require-vs-load">Require vs Load</h3>

<p>The Ruby programming language defines the keywords ‘require’ and ‘load’. These are actually methods on the Kernel class and you can find the full documention on <a href="https://ruby-doc.org/">ruby-doc.org</a> for both <a href="https://ruby-doc.org/core-2.4.2/Kernel.html#method-i-require">require</a> and <a href="https://ruby-doc.org/core-2.4.2/Kernel.html#method-i-load">load</a>. They basically include additional Ruby source files into the current execution environment so they can be used by your code. The key difference is that require will only include a file once. If you try to require a file a second time the require method actually returns false indicating that the file has already been required. You can easily test this by opening an IRB session and requiring something twice.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>irb(main):001:0&gt; require 'cosmos'
=&gt; true
irb(main):002:0&gt; require 'cosmos'
=&gt; false
</code></pre></div></div>

<p>This has key implications for usage in COSMOS, especially when writing scripts for use in Script Runner or Test Runner. Let’s say you have a subroutine that you want to call (and don’t want to watch the line by line execution of). You require it in your script and execute it. You realize you have a bug in this required script and edit the file. Now you re-run the top level script but notice none of your changes have been include! What gives?! The require keyword notices that you’ve already required the file and thus does not re-load it on the next execution of your script. This has led some COSMOS users to simply close and re-open Script Runner or Test Runner each time they edit something. While this solves the require problem there is a better solution: load.</p>

<p>The load keyword loads the specified file everytime and thus reparses any changes that may have been made to the file in question. This is almost always what you want to use when writing scripts for COSMOS as it allows you to edit files and be assured that you will be running the latest. Note the difference when using load in this IRB session.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>irb(main):001:0&gt; load 'cosmos.rb'
=&gt; true
irb(main):002:0&gt; load 'cosmos.rb'
=&gt; true
irb(main):003:0&gt; load 'cosmos'
LoadError: cannot load such file -- cosmos
        from (irb):3:in `load'
        from (irb):3
        from C:/Ruby233p222-x64/bin/irb.cmd:19:in `&lt;main&gt;'
irb(main):004:0&gt; require 'cosmos.rb'
=&gt; true
</code></pre></div></div>

<p>When using the keyword load you must add the .rb Ruby extension to the file you are trying to load. Leaving this off (which is allowed with the require keyword) will result in a LoadError as shown above. Note that require works with or without the .rb Ruby extension and that the previous load of cosmos.rb did not affect the require of cosmos.rb (it still had never been required).</p>

<h3 id="load-vs-load_utility">Load vs load_utility</h3>

<p>Now that we’ve established how the require and load keywords work in Ruby, how does the load_utility keyword work in COSMOS? This keyword is COSMOS specific and means that COSMOS will step through the included source file when it is called. This is useful for debugging subroutines or for things that you simply want to watch execute. It is not recommended for subroutines that take an extended time to process like looping over large datasets. This will SIGNIFICANTLY slow down the execution of this code as it shows each line execute in the GUI.</p>

<p>Note that COSMOS also has a require_utility keyword. This keyword works exactly like load_utility which is why we recommend using load_utility going forward as it better matches the Ruby keywords in what it is doing. This keyword is effectively deprecated and may be removed in future versions of COSMOS.</p>

<h3 id="ruby-load-path">Ruby Load Path</h3>

<p>After talking aobut require and load I think this is a good place to talk a little about the Ruby Load Path since it directly affects whether a require or load will succeed. The overall Ruby load path can be found by typing $LOAD_PATH. Doing this in my IRB session running Ruby 2.3.3 results in the following.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>irb(main):004:0&gt; puts $LOAD_PATH
C:\git\cosmos\lib
C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/did_you_mean-1.0.0/lib
C:/Ruby233p222-x64/lib/ruby/site_ruby/2.3.0
C:/Ruby233p222-x64/lib/ruby/site_ruby/2.3.0/x64-msvcrt
C:/Ruby233p222-x64/lib/ruby/site_ruby
C:/Ruby233p222-x64/lib/ruby/vendor_ruby/2.3.0
C:/Ruby233p222-x64/lib/ruby/vendor_ruby/2.3.0/x64-msvcrt
C:/Ruby233p222-x64/lib/ruby/vendor_ruby
C:/Ruby233p222-x64/lib/ruby/2.3.0
C:/Ruby233p222-x64/lib/ruby/2.3.0/x64-mingw32
=&gt; nil
</code></pre></div></div>

<p>You’ll notice most of these paths are relative to my Ruby installation at C:/Ruby233p222. I also have an entry for my developer copy of COSMOS due to my environment variable of RUBYLIB=C:\git\cosmos\lib. As a COSMOS developer I have this variable set but you most likely will not. Setting the RUBYLIB environment variable is useful when developing but can interfere with loading gems since it is at the top of the $LOAD_PATH.</p>

<p>When you start requiring other libraries they typically add things to your LOAD_PATH. Watch what happens when I require ‘cosmos’.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>irb(main):001:0&gt; require 'cosmos'
=&gt; true
irb(main):002:0&gt; puts $LOAD_PATH
C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/uuidtools-2.1.5/lib
C:\git\cosmos\lib
C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/did_you_mean-1.0.0/lib
C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/bundler-1.15.4/lib
C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/json-1.8.6/lib
C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/extensions/x64-mingw32/2.3.0/json-1.8.6
C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/rack-2.0.3/lib
C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/puma-3.10.0/lib
C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/extensions/x64-mingw32/2.3.0/puma-3.10.0
C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/uuidtools-2.1.5/lib
C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/mini_portile2-2.3.0/lib
C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/nokogiri-1.8.1-x64-mingw32/lib
C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/rubyzip-1.1.7/lib
C:/Ruby233p222-x64/lib/ruby/site_ruby/2.3.0
C:/Ruby233p222-x64/lib/ruby/site_ruby/2.3.0/x64-msvcrt
C:/Ruby233p222-x64/lib/ruby/site_ruby
C:/Ruby233p222-x64/lib/ruby/vendor_ruby/2.3.0
C:/Ruby233p222-x64/lib/ruby/vendor_ruby/2.3.0/x64-msvcrt
C:/Ruby233p222-x64/lib/ruby/vendor_ruby
C:/Ruby233p222-x64/lib/ruby/2.3.0
C:/Ruby233p222-x64/lib/ruby/2.3.0/x64-mingw32
=&gt; nil
</code></pre></div></div>

<p>Now a bunch of gems have added themselves to my $LOAD_PATH. These gems are the gems that cosmos has dependencies on. Note that when you require or load a file the $LOAD_PATH entries are searched in order. Thus in the above example a file in the uuidtools library will be found before a file in the rubyzip library.</p>

<p>You can display your $LOAD_PATH from Script Runner by simply running “puts $LOAD_PATH” from Script Runner. When I do this I get the following in my Script Output:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2017/11/13 10:58:21.815 (SCRIPTRUNNER): Starting script:
2017/11/13 10:58:22.076 (:1): C:/git/COSMOS/demo/procedures
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/uuidtools-2.1.5/lib
2017/11/13 10:58:22.076 (:1): C:/git/COSMOS/demo/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/bundler-1.15.4/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/ruby-prof-0.15.9/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/extensions/x64-mingw32/2.3.0/ruby-prof-0.15.9
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/roodi-4.1.1/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/reek-1.6.6/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/unparser-0.2.4/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/rainbow-2.2.2/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/extensions/x64-mingw32/2.3.0/rainbow-2.2.2
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/procto-0.0.3/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/parser-2.2.3.0/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/guard-rspec-4.7.3/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/rspec-3.5.0/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/rspec-mocks-3.5.0/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/rspec-expectations-3.5.0/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/rspec-core-3.5.4/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/rspec-support-3.5.0/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/guard-bundler-2.1.0/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/guard-compat-1.2.1/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/guard-2.14.1/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/notiffany-0.1.1/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/shellany-0.0.1/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/nenv-0.3.0/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/lumberjack-1.0.12/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/listen-2.10.1/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/rb-inotify-0.9.10/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/rb-fsevent-0.10.2/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/formatador-0.2.5/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/flog-4.6.1/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/flay-2.10.0/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/ruby_parser-3.10.1/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/sexp_processor-4.10.0/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/path_expander-1.0.2/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/ffi-1.9.18-x64-mingw32/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/erubis-2.7.0/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/diff-lcs-1.2.5/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/coveralls-0.8.21/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/thor-0.19.4/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/term-ansicolor-1.6.0/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/tins-1.15.0/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/simplecov-0.14.1/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/simplecov-html-0.10.2/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/docile-1.1.5/lib
2017/11/13 10:58:22.076 (:1): C:/git/COSMOS/lib
2017/11/13 10:58:22.076 (:1): C:/git/extensions/x64-mingw32/2.3.0/cosmos-0.0.0
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/uuidtools-2.1.5/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/snmp-1.2.0/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/rubyzip-1.1.7/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/rdoc-4.3.0/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/rack-2.0.3/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/qtbindings-4.8.6.3-x64-mingw32/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/qtbindings-qt-4.8.6.3-x64-mingw32/qtlib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/puma-3.10.0/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/extensions/x64-mingw32/2.3.0/puma-3.10.0
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/pry-doc-0.6.0/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/yard-0.9.9/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/pry-0.10.4/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/slop-3.6.0/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/method_source-0.8.2/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/opengl-0.9.2-x64-mingw32/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/nokogiri-1.8.1-x64-mingw32/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/mini_portile2-2.3.0/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/json-1.8.6/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/extensions/x64-mingw32/2.3.0/json-1.8.6
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/httpclient-2.8.3/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/concord-0.1.5/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/equalizer-0.0.11/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/coderay-1.1.2/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/celluloid-0.16.0/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/timers-4.0.4/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/hitimes-1.2.6/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/extensions/x64-mingw32/2.3.0/hitimes-1.2.6
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/benchmark-ips-2.7.2/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/ast-2.3.0/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/adamantium-0.2.0/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/memoizable-0.4.2/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/thread_safe-0.3.6/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/ice_nine-0.11.2/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/abstract_type-0.0.7/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/rake-12.1.0/lib
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/site_ruby/2.3.0
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/site_ruby/2.3.0/x64-msvcrt
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/site_ruby
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/vendor_ruby/2.3.0
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/vendor_ruby/2.3.0/x64-msvcrt
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/vendor_ruby
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/2.3.0
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/2.3.0/x64-mingw32
2017/11/13 10:58:22.076 (:1): C:/Ruby233p222-x64/lib/ruby/gems/2.3.0/gems/qtbindings-4.8.6.3-x64-mingw32/lib/../lib/2.3
2017/11/13 10:58:22.076 (:1): C:/git/COSMOS/demo/config/targets/INST/lib
2017/11/13 10:58:22.076 (:1): C:/git/COSMOS/demo/config/targets/INST/procedures
2017/11/13 10:58:22.076 (:1): C:/git/COSMOS/demo/config/targets/EXAMPLE/lib
2017/11/13 10:58:22.076 (:1): C:/git/COSMOS/demo/config/targets/TEMPLATED/lib
2017/11/13 10:58:22.076 (:1): C:/git/COSMOS/demo/config/targets/SYSTEM/lib
2017/11/13 10:58:22.092 (SCRIPTRUNNER): Script completed:
</code></pre></div></div>

<p>Wow, that is a lot of gems! COSMOS requires a lot of libraries to support how it operates including many used for development purposes like rspec and simplecov. An important thing to note is at the top of the list the following paths are listed.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>C:/git/COSMOS/demo/procedures
C:/git/COSMOS/demo/lib
</code></pre></div></div>

<p>The first path is due to the following line in the COSMOS Demo configuration’s system.txt configuration file: <code class="highlighter-rouge">PATH PROCEDURES ./procedures</code>. This adds the procedures directory in the current COSMOS configuration (C:/git/COSMOS/demo on my machine) to the path.</p>

<p>The second path is added to every COSMOS configuration. The lib directory in the current COSMOS configuration (C:/git/COSMOS/demo on my machine).</p>

<p>You should also note the last few lines of the $LOAD_PATH.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>C:/git/COSMOS/demo/config/targets/INST/lib
C:/git/COSMOS/demo/config/targets/INST/procedures
C:/git/COSMOS/demo/config/targets/EXAMPLE/lib
C:/git/COSMOS/demo/config/targets/TEMPLATED/lib
C:/git/COSMOS/demo/config/targets/SYSTEM/lib
</code></pre></div></div>

<p>These are added because COSMOS automatically adds the lib and procedures directory from each Target folder. Thus you are able to directly load a file in the INST/procedures directory by doing “load ‘checks.rb’” (for example). If a file is in a subdirectory like the INST/procedures/utilities directory, then you must specify the additional subpath such as “load_utility ‘utilities/clear.rb’”.</p>

<h3 id="require_relative">require_relative</h3>

<p>Just for completeness note that there is also a Ruby keyword called <a href="https://ruby-doc.org/core-2.4.2/Kernel.html#method-i-require_relative">require_relative</a>. This works similar to require but instead of using the LOAD_PATH as described above, it looks relative to the current executing file. This should rarely be needed in COSMOS except perhaps in test files.</p>

<p>If you have a question which would benefit the community or find a possible bug please use our <a href="https://github.com/BallAerospace/COSMOS/issues">Github Issues</a>. If you would like more information about a COSMOS training or support contract please contact us at <a href="mailto:cosmos@ball.com">cosmos@ball.com</a>.</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2017/10/30/config-editor/">
      Config Editor
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      post
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      30 Oct 2017
    </span>
    <a href="https://github.com/jmthomas" class="post-author">
      <img src="https://github.com/jmthomas.png" class="avatar" alt="jmthomas avatar" width="24" height="24">
      jmthomas
    </a>
  </div>
  <div class="post-content">
    <p>COSMOS gained a new tool in the <a href="/news/2017/08/04/cosmos-4-0-0-released/">4.0.0 release</a> called Configuration Editor. This tool provides contextual help when editing COSMOS configuration files and thus should make configuring COSMOS much easier than in the past.</p>

<h3 id="configuration-editor-basics">Configuration Editor Basics</h3>

<p>When creating a new project from from the Demo you’ll notice a new icon in the Launcher under the Utilities label:</p>

<p><img src="/img/2017_10_30_demo_launcher.png" alt="Demo Launcher" /></p>

<p>Note that as of this post the Install Launcher does not have the new Configuration Editor or Command Sequence buttons but this will be addressed in the next release.</p>

<p>Clicking the Config Editor button brings up the Configuration Editor tool:</p>

<p><img src="/img/2017_10_30_config_editor.png" alt="Config Editor" /></p>

<p>Configuration Editor has three vertical panes. The far left is a Windows Explorer type tree view which opens at the base of your COSMOS configuration. This makes it easy to see and navigate through all the COSMOS configuration files.</p>

<p>The middle pane is a file editor which opens files when they are clicked on in the left pane tree view.</p>

<p>The right pane is what Configuration Editor was created for. It provides contextual help for all the COSMOS keywords. As the editor cursor in the middle pane changes the contextual help changes to reflect current editor line. Here’s an example of the right pane when the Demo’s INST target’s command definition is edited:</p>

<p><img src="/img/2017_10_30_inst_cmds.png" alt="Config Editor" /></p>

<p>The user can either edit the configuration file directly in the middle pane or use the configuration help in the right pane. Edits in the middle pane are immediately reflected in the right pane. Edits in the right pane are not reflected back in the configuration pane until the user tabs or clicks to another field. Note that tabbing through the fields is a quick way to transition from one parameter to another.</p>

<p>Configuration Editor contains the same Edit and Search menu options that Script Runner supports. Searching for keywords and transitioning from one to another also updates the configuration help pane which is another way to quickly check particular keywords.</p>

<h3 id="configuration-editor-links">Configuration Editor Links</h3>

<p>If you have an older (pre-4.0) COSMOS configuration or generated a basic configuration from the install (4.0.0-4.0.3) you will not have a link to the new Configuration Editor tool in your Launcher. Follow the following steps to add this tool.</p>

<ol>
  <li>Edit config/tools/launcher/launcher.txt</li>
  <li>Add the following line (typically after Utilities LABEL)
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>TOOL "Config Editor" "LAUNCH ConfigEditor" "config_editor.png"
</code></pre></div>    </div>
  </li>
</ol>

<p>Restart your Launcher and you should see this new tool to help you configure COSMOS. Note that if you don’t have the Configuration Editor button then you probably also don’t have a button for the new Command Sequence tool. Add the following line after the Command Sender line to access this tool:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>TOOL "Command Sequence" "LAUNCH CmdSequence" "cmd_sequence.png"
</code></pre></div></div>

<p>Enjoy these new COSMOS 4.0 tools!</p>

<p>If you have a question which would benefit the community or find a possible bug please use our <a href="https://github.com/BallAerospace/COSMOS/issues">Github Issues</a>. If you would like more information about a COSMOS training or support contract please contact us at <a href="mailto:cosmos@ball.com">cosmos@ball.com</a>.</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2017/10/24/cosmos-4-0-3-released/">
      Ball Aerospace COSMOS 4.0.3 Released
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      release
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      24 Oct 2017
    </span>
    <a href="https://github.com/jmthomas" class="post-author">
      <img src="https://github.com/jmthomas.png" class="avatar" alt="jmthomas avatar" width="24" height="24">
      jmthomas
    </a>
  </div>
  <div class="post-content">
    <p><strong>Important Bug Fix:</strong> UdpInterface was only working for locahost on earlier versions of COSMOS 4.0.x. Please upgrade to COSMOS 4.0.3 if you need support for UDP.</p>

<h3 id="new-features">New Features:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/585">#585</a> Add packet level config_name</li>
</ul>

<h3 id="maintenance">Maintenance:</h3>

<p>None</p>

<h3 id="bug-fixes">Bug Fixes:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/590">#590</a> UdpReadSocket must be created before UdpWriteSocket if read_port == write_src_port</li>
</ul>

<h3 id="migration-notes-from-cosmos-3x">Migration Notes from COSMOS 3.x:</h3>

<p>COSMOS 4 includes several breaking changes from the COSMOS 3.x series.</p>

<p>The first and simplest is that the Command and Telemetry Server now opens an additional port at 7780 by default, that provides a router that will send out each command that the system has sent.  This can allow external systems to also log all commands sent by COSMOS.  For most people this change will be transparent and no updates to your COSMOS configuration will be required.</p>

<p>The second is that the Command and Telemetry Server now always supports a meta data packet called SYSTEM META.  This packet will always contain the MD5 sum for the current running COSMOS configuration, the version of COSMOS running, the version of your COSMOS Project, and the version of Ruby being used.  You can also add your own requirements for meta data with things like the name of the operator currently running the system, or the name of a specific test you are currently running.  In general you shouldn’t need to do anything for this change unless you were using the previous metadata functionality in COSMOS.  If you were, then you will need to migrate your meta data to the new SYSTEM META packet, and change the parameters in your CmdTlmServer or TestRunner configurations regarding meta data.  If you weren’t using metadata before, then you will probably just notice this new packet in your log files, and in your telemetry stream.</p>

<p>Finally the most exciting breaking change is in how COSMOS interfaces handle protocols.  Before, the COSMOS TCP/IP and Serial interface classes each took a protocol like LENGTH, TERMINATED, etc that defined how packets were delineated by the interface.  Now each interface can take a set of one or more protocols.  This allows COSMOS to much more easily support nested protocols, such as the frame focused protocols of CCSDS.  It also allows for creating helpful reusable protocols such as the new CRC protocol for automatically adding CRCs to outgoing commands and verifying incoming CRCs on telemetry packets.  It’s a great change, but if you have any custom interface classes you have written, they will probably require some modification.  See the Interfaces section at cosmosrb.com to see how the new interface classes work. We will also be writing up a blog post to help document the process of upgrading.  Look for this in a week or two.</p>

<p>To upgrade to the latest version of COSMOS, run “bundle update cosmos” in your COSMOS project folder.</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2017/09/29/cosmos-4-0-2-released/">
      Ball Aerospace COSMOS 4.0.2 Released
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      release
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      29 Sep 2017
    </span>
    <a href="https://github.com/jmthomas" class="post-author">
      <img src="https://github.com/jmthomas.png" class="avatar" alt="jmthomas avatar" width="24" height="24">
      jmthomas
    </a>
  </div>
  <div class="post-content">
    <p><strong>Important Bug Fix:</strong> UdpInterface was only working for locahost on earlier versions of COSMOS 4.0.x. Please upgrade to COSMOS 4.0.2 if you need support for UDP.</p>

<h3 id="new-features">New Features:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/577">#577</a> LIMITSBAR widget shouldn’t allow RAW</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/565">#565</a> Template Protocol support for logging rather than disconnect on timeout</li>
</ul>

<h3 id="maintenance">Maintenance:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/551">#551</a> TlmViewer meta AUTO_TARGET needs parameter</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/553">#553</a> Create cosmosrb documentation based on metadata</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/554">#554</a> TEMP1 limits getting disabled in demo is confusing</li>
</ul>

<h3 id="bug-fixes">Bug Fixes:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/564">#564</a> Items with STATES don’t respect LIMITS</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/568">#568</a> CSV shouldn’t call compact</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/569">#569</a> combo_box and vertical_message_box don’t report correct user selection</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/580">#580</a> Udp interface does not work for non-localhost</li>
</ul>

<h3 id="migration-notes-from-cosmos-38x">Migration Notes from COSMOS 3.8.x:</h3>

<p>COSMOS 4 includes several breaking changes from the COSMOS 3.x series.</p>

<p>The first and simplest is that the Command and Telemetry Server now opens an additional port at 7780 by default, that provides a router that will send out each command that the system has sent.  This can allow external systems to also log all commands sent by COSMOS.  For most people this change will be transparent and no updates to your COSMOS configuration will be required.</p>

<p>The second is that the Command and Telemetry Server now always supports a meta data packet called SYSTEM META.  This packet will always contain the MD5 sum for the current running COSMOS configuration, the version of COSMOS running, the version of your COSMOS Project, and the version of Ruby being used.  You can also add your own requirements for meta data with things like the name of the operator currently running the system, or the name of a specific test you are currently running.  In general you shouldn’t need to do anything for this change unless you were using the previous metadata functionality in COSMOS.  If you were, then you will need to migrate your meta data to the new SYSTEM META packet, and change the parameters in your CmdTlmServer or TestRunner configurations regarding meta data.  If you weren’t using metadata before, then you will probably just notice this new packet in your log files, and in your telemetry stream.</p>

<p>Finally the most exciting breaking change is in how COSMOS interfaces handle protocols.  Before, the COSMOS TCP/IP and Serial interface classes each took a protocol like LENGTH, TERMINATED, etc that defined how packets were delineated by the interface.  Now each interface can take a set of one or more protocols.  This allows COSMOS to much more easily support nested protocols, such as the frame focused protocols of CCSDS.  It also allows for creating helpful reusable protocols such as the new CRC protocol for automatically adding CRCs to outgoing commands and verifying incoming CRCs on telemetry packets.  It’s a great change, but if you have any custom interface classes you have written, they will probably require some modification.  See the Interfaces section at cosmosrb.com to see how the new interface classes work. We will also be writing up a blog post to help document the process of upgrading.  Look for this in a week or two.</p>

<p>To upgrade to the latest version of COSMOS, run “bundle update cosmos” in your COSMOS project folder.</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2017/08/23/cloud-deploy/">
      Deploying COSMOS to the Cloud
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      post
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      23 Aug 2017
    </span>
    <a href="https://github.com/jmthomas" class="post-author">
      <img src="https://github.com/jmthomas.png" class="avatar" alt="jmthomas avatar" width="24" height="24">
      jmthomas
    </a>
  </div>
  <div class="post-content">
    <p>COSMOS is a GUI application which runs equally well on Windows, Linux, and Mac OS X due to the QT GUI framework and Ruby language it is written in. Traditionally this means you install it locally on your own workstation and you’re off and running. But can COSMOS also be deployed to the cloud? Yes! This post describes how I deployed COSMOS to Amazon Web Services (AWS) using several different technologies.</p>

<h3 id="aws">AWS</h3>

<p>AWS consists of a lot of different services. To deploy COSMOS you need to create an AWS EC2 instance. The first step is to sign up for AWS which enables you to use their Free Tier for 12 months. This includes 750hrs each on Linux and Windows Server.</p>

<h3 id="deploying-to-windows-server">Deploying to Windows Server</h3>

<p>Deploying to Windows Server is probably the easiest way to get COSMOS in the cloud. Simply create a Windows Server instance by selecting the following image:
<img src="/img/2017_08_23_aws_win_server.png" alt="Windows Image" /></p>

<p>Then select the t2.micro Type which is marked “Free tier eligible”. Launch the Instance and you should see the key pair dialog:
<img src="/img/2017_08_23_aws_key_pair.png" alt="Key Pair Dialog" /></p>

<p>Create a new key pair and give the name something generic because you can use the same key pair for all the EC2 instances you create. Create the instance and then View Instance which will show the instance status. Click the Connect button at top which will bring up the Connect dialog:
<img src="/img/2017_08_23_aws_win_connect.png" alt="Connect Dialog" /></p>

<p>Click the Download Remote Desktop File and open it in Remote Desktop to connect to the Windows Server instance. Note that it does take a while for the Windows instance to boot so this won’t work until your Status Checks show a green check. Also note that many corporate firewalls may block doing a Remote Desktop outside your corporate network.</p>

<p>You also need to click Get Password and locate your ‘pem’ file you saved earlier to Decrypt your password. Login to the instance as Administrator with the decrypted password. Once you’ve logged in you can change the password to something a little more reasonable. Then simply follow the usual <a href="/docs/installation/">COSMOS installation </a> instructions.</p>

<p>Here is a screenshot of my successful COSMOS installation running on the AWS Microsoft Server instance:
<img src="/img/2017_08_23_aws_windows.png" alt="COSMOS on Windows" /></p>

<h3 id="deploying-to-red-hat-linux-with-x-forwarding">Deploying to Red Hat Linux (with X forwarding)</h3>

<p>Deploying to Red Hat Linux is similar to Windows. Create a Red Hat instance by selecting the following image:
<img src="/img/2017_08_23_aws_red_hat.png" alt="Red Hat Image" /></p>

<p>Use the same key pair when creating your Windows instance and create the instance. View Instance and click the Connect button which brings up the Connect dialog:
<img src="/img/2017_08_23_aws_red_hat_connect.png" alt="Connect Dialog" /></p>

<p>SSH to the instance using the connection string provided making sure to specify the full path to your ‘pem’ file in the quoted path after the -i option. Install a GUI by issuing the following command:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo yum groupinstall 'Server with GUI'
</code></pre></div></div>

<p>Install COSMOS using the installation bash file:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bash &lt;(\curl -sSL https://raw.githubusercontent.com/BallAerospace/COSMOS/master/vendor/installers/linux_mac/INSTALL_COSMOS.sh)
</code></pre></div></div>

<p>Chose the sudo option when asked how to install. To enable X forwarding edit the SSH config file:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo vim /etc/ssh/sshd_config
</code></pre></div></div>

<p>Enable the following settings:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>X11Forwarding yes
X11DisplayOffset 10
X11UseLocalhost no
</code></pre></div></div>

<p>Close your current SSH connection and reconnect with SSH adding the -X option to enable X11 forwarding and -Y to enable trusted X11 fowarding. If you host OS is Mac OS X you’ll need to install <a href="https://www.xquartz.org/">XQuartz</a>. Linux has X11 forward support built-in. Windows should probably install Xming which is an exercise left to the reader.</p>

<p>Now launch COSMOS and you should see the COSMOS windows appear on your own machine. While this approach works I found the performance to be significantly slower than VNC. Here is a screenshot of it running while I connected via a Mac OS X machine:
<img src="/img/2017_08_23_aws_red_hat_x.png" alt="Red Hat X" /></p>

<h3 id="deploying-on-ubuntu-with-vnc">Deploying on Ubuntu (with VNC)</h3>

<p>Deploying to Ubuntu Linux is very similar to Red Hat. Create an Ubuntu instance by selecting the following image:
<img src="/img/2017_08_23_aws_ubuntu.png" alt="Ubuntu Image" /></p>

<p>Use the same key pair as when creating your Windows or Red Hat instance and create the instance. View Instance and click the Connect button which brings up the Connect dialog:
<img src="/img/2017_08_23_aws_red_hat_connect.png" alt="Connect Dialog" /></p>

<p>Click on the instance and click the Description tab which appears below the instance. Click the link next to Security groups to open the Security Groups configuration. Click the Inbound tab and create Edit to create a new Custom TCP Rule to enable TCP traffic on Ports 5900-5910 from Anywhere. Your rule should look like the following:
<img src="/img/2017_08_23_aws_security_group.png" alt="Security Group" /></p>

<p>SSH to the instance using the connection string provided making sure to specify the full path to your ‘pem’ file in the quoted path after the -i option. Install a GUI by issuing the following command:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo apt-get update
sudo apt install xfce4 xfce4-goodies tightvncserver
</code></pre></div></div>

<p>Run the following commands to setup the VNC server:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vncserver
vncserver -kill :1
vim ~/.vnc/xstartup
</code></pre></div></div>

<p>Ensure your xstartup file matches the following:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/sh</span>

<span class="c"># Uncomment the following two lines for normal desktop:</span>
<span class="nb">unset </span>SESSION_MANAGER
<span class="c"># exec /etc/X11/xinit/xinitrc</span>
<span class="nb">unset </span>DBUS_SESSION_BUS_ADDRESS
startxfce4 &amp;

<span class="o">[</span> <span class="nt">-x</span> /etc/vnc/xstartup <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nb">exec</span> /etc/vnc/xstartup
<span class="o">[</span> <span class="nt">-r</span> <span class="nv">$HOME</span>/.Xresources <span class="o">]</span> <span class="o">&amp;&amp;</span> xrdb <span class="nv">$HOME</span>/.Xresources
xsetroot <span class="nt">-solid</span> grey
vncconfig <span class="nt">-iconic</span> &amp;
<span class="c">#x-terminal-emulator -geometry 80x24+10+10 -ls -title "$VNCDESKTOP Desktop" &amp;</span>
<span class="c">#x-window-manager &amp;</span>
</code></pre></div></div>

<p>Restart VNC:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vncserver
</code></pre></div></div>

<p>Install COSMOS using the installation bash file:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bash &lt;(\curl -sSL https://raw.githubusercontent.com/BallAerospace/COSMOS/master/vendor/installers/linux_mac/INSTALL_COSMOS.sh)
</code></pre></div></div>

<p>Chose the sudo option when asked how to install. On your local machine install a VNC viewer such as TightVNC and connect by entering the Public DNS address of your AWS instance in the Remote Host as well as the Port number of 5901. Typically this is added by appending it to the Remote Host address with a colon. Here is a screenshot of it running while I connected via TightVNC:
<img src="/img/2017_08_23_aws_ubuntu_vnc.png" alt="Red Hat X" /></p>

<p>If you have a question which would benefit the community or find a possible bug please use our <a href="https://github.com/BallAerospace/COSMOS/issues">Github Issues</a>. If you would like more information about a COSMOS training or support contract please contact us at <a href="mailto:cosmos@ball.com">cosmos@ball.com</a>.</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2017/08/23/cosmos-4-0-1-released/">
      Ball Aerospace COSMOS 4.0.1 Released
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      release
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      23 Aug 2017
    </span>
    <a href="https://github.com/ryanmelt" class="post-author">
      <img src="https://github.com/ryanmelt.png" class="avatar" alt="ryanmelt avatar" width="24" height="24">
      ryanmelt
    </a>
  </div>
  <div class="post-content">
    <h3 id="new-features">New Features:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/527">#527</a> Editing config files should now bring up ConfigEditor</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/528">#528</a> ConfigEditor missing some keywords</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/534">#534</a> Create ConfigEditor Mac app</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/536">#536</a> Clickable canvas objects open screens</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/543">#542</a> Automatically populate COMMAND SYSTEM META</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/543">#543</a> Allow SYSTEM META items to be read only</li>
</ul>

<h3 id="maintenance">Maintenance:</h3>

<ul>
  <li>None</li>
</ul>

<h3 id="bug-fixes">Bug Fixes:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/533">#533</a> TestRunner strips all comments when running</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/538">#538</a> META_INIT broken</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/540">#540</a> Background task packet subscription get_packet broken</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/547">#547</a> convert_packet_to_data should copy buffer</li>
</ul>

<h3 id="migration-notes-from-cosmos-38x">Migration Notes from COSMOS 3.8.x:</h3>

<p>COSMOS 4 includes several breaking changes from the COSMOS 3.x series.</p>

<p>The first and simplest is that the Command and Telemetry Server now opens an additional port at 7780 by default, that provides a router that will send out each command that the system has sent.  This can allow external systems to also log all commands sent by COSMOS.  For most people this change will be transparent and no updates to your COSMOS configuration will be required.</p>

<p>The second is that the Command and Telemetry Server now always supports a meta data packet called SYSTEM META.  This packet will always contain the MD5 sum for the current running COSMOS configuration, the version of COSMOS running, the version of your COSMOS Project, and the version of Ruby being used.  You can also add your own requirements for meta data with things like the name of the operator currently running the system, or the name of a specific test you are currently running.  In general you shouldn’t need to do anything for this change unless you were using the previous metadata functionality in COSMOS.  If you were, then you will need to migrate your meta data to the new SYSTEM META packet, and change the parameters in your CmdTlmServer or TestRunner configurations regarding meta data.  If you weren’t using metadata before, then you will probably just notice this new packet in your log files, and in your telemetry stream.</p>

<p>Finally the most exciting breaking change is in how COSMOS interfaces handle protocols.  Before, the COSMOS TCP/IP and Serial interface classes each took a protocol like LENGTH, TERMINATED, etc that defined how packets were delineated by the interface.  Now each interface can take a set of one or more protocols.  This allows COSMOS to much more easily support nested protocols, such as the frame focused protocols of CCSDS.  It also allows for creating helpful reusable protocols such as the new CRC protocol for automatically adding CRCs to outgoing commands and verifying incoming CRCs on telemetry packets.  It’s a great change, but if you have any custom interface classes you have written, they will probably require some modification.  See the Interfaces section at cosmosrb.com to see how the new interface classes work. We will also be writing up a blog post to help document the process of upgrading.  Look for this in a week or two.</p>

<p>To upgrade to the latest version of COSMOS, run “bundle update cosmos” in your COSMOS project folder.</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2017/08/04/cosmos-4-0-0-released/">
      Ball Aerospace COSMOS 4.0.0 Released
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      release
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      04 Aug 2017
    </span>
    <a href="https://github.com/ryanmelt" class="post-author">
      <img src="https://github.com/ryanmelt.png" class="avatar" alt="ryanmelt avatar" width="24" height="24">
      ryanmelt
    </a>
  </div>
  <div class="post-content">
    <p>COSMOS 4 is here!</p>

<p>48 tickets have gone into this release, and it brings with it two new tools and some great under the hood improvements.</p>

<p>New Tools:</p>

<p>COSMOS now has a dedicated Configuration Editor and Command Sequence Builder.</p>

<p>The config editor gives you contextual help when building config files, and make it super easy to define packets and configure tools without having to have the online documentation up in front of you.  It’s going to make setting up COSMOS even easier than it was before.</p>

<p>Command Sequence builder allows you to define series of commands that should be sent at either absolute or relative timestamps to each other.  This is great for planning time specific commanding.  You can execute these on the ground directly from the tool, or you can convert them to your own internal format and upload to the system you are commanding.</p>

<p>Highlighted changes:</p>

<ol>
  <li>New protocol system allows assigning multiple protocols to each interface to support layered protocols, and common functionality like CRC checking/adding to commands.</li>
  <li>The ability to View the most recent raw data received or sent on each interface</li>
  <li>The Command and Telemetry Server can now run on JRuby in –no-gui mode (may help performance for huge projects with 50+ targets)</li>
  <li>New router provides the ability to get a copy of every command sent out from COSMOS in a stream</li>
  <li>New SYSTEM META packet output by the CmdTlmServer</li>
  <li>Lots more!  See the full ticket list below</li>
</ol>

<h3 id="new-features">New Features:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/229">#229</a> Gem Based Targets should support DataViewer and other tool configurations</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/234">#234</a> Add a method to system.txt to add files used in the marshall file MD5 sum calculation</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/253">#253</a> Create “generators” for targets, tools, etc</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/258">#258</a> Create COSMOS Command Sequence Tool</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/261">#261</a> Provide a method for specifying binary data in STRING and BLOCK default values</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/278">#278</a> Consider adding wait_ methods to internal API for use in Background tasks</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/281">#281</a> Add support for stretch and spacers in widget layouts</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/319">#319</a> Add the ability to grab telemetry ARRAY_ITEMs</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/337">#337</a> Support specifying default parameters to default log reader and log writer in system.txt</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/347">#347</a> COSMOS GLobal Time Zone Setting (Local/UTC)</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/356">#356</a> Interface protocols</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/360">#360</a> Add raw stream preamble and postamble data to “View Raw”</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/381">#381</a> Float Infinity and NaN as command values</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/401">#401</a> tolerance scripting calls should support array telemetry items</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/404">#404</a> Packet Viewer easy access to edit configuration files</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/405">#405</a> Telemetry Viewer easy access to edit screen definition</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/423">#423</a> Add “Cmd router” to CmdTlmServer to support external logging of all commands</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/424">#424</a> TlmViewer should call update_widget for a screen with no value items and with CmdTlmServer not running</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/426">#426</a> Standardize meta data to SYSTEM META packet</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/432">#432</a> Export processed config files</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/442">#442</a> Label value widgets should support right aligned labels</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/459">#459</a> Script Editor code completion enhancements</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/479">#479</a> Limits Monitor doesn’t detect newly connected targets</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/489">#489</a> Built in support for limits group enable and disable</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/497">#497</a> Update serial_interface.rb to support hardware flow control</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/498">#498</a> Script helper for activities that should cause an exception</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/511">#511</a> Make CmdTlmServer run on JRuby</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/512">#512</a> Create a CRC Protocol</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/513">#513</a> Create a GUI config file editor</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/516">#516</a> Recreate COSMOS C Extension Code in Pure Ruby</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/517">#517</a> Make hostname for tools to connect to CTS API configurable in system.txt</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/519">#519</a> Replay should support alternate packet log readers</li>
</ul>

<h3 id="maintenance">Maintenance:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/354">#354</a> Targets need to be path namespaced to avoid conflicts</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/323">#323</a> Catch Signals in CmdTlmServer</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/341">#341</a> Document COSMOS JSON API on cosmosrb.com</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/398">#398</a> Documentation, code cleanup</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/429">#429</a> Command Endianness and Parameter Endianness</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/437">#437</a> Remove CMD_TLM_VERSION from system.txt</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/438">#438</a> Cache script text as part of instrumenting script</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/446">#446</a> Windows 10 Install fails</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/476">#476</a> Separate apt and yum package install lines</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/477">#477</a> Deprecate userpath.txt</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/484">#484</a> require_file should re-raise existing exception</li>
</ul>

<h3 id="bug-fixes">Bug Fixes:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/456">#456</a> Replay doesn’t shut down properly if closed while playing</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/481">#481</a> show_backtrace not working in ScriptRunner</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/494">#494</a> Details dialog crashes for items with LATEST packet</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/502">#502</a> Target REQUIRE should also search system path</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/506">#506</a> Don’t call read_interface if data is cached in protocols for another packet</li>
</ul>

<h3 id="migration-notes-from-cosmos-38x">Migration Notes from COSMOS 3.8.x:</h3>

<p>COSMOS 4 includes several breaking changes from the COSMOS 3.x series.</p>

<p>The first and simplest is that the Command and Telemetry Server now opens an additional port at 7780 by default, that provides a router that will send out each command that the system has sent.  This can allow external systems to also log all commands sent by COSMOS.  For most people this change will be transparent and no updates to your COSMOS configuration will be required.</p>

<p>The second is that the Command and Telemetry Server now always supports a meta data packet called SYSTEM META.  This packet will always contain the MD5 sum for the current running COSMOS configuration, the version of COSMOS running, the version of your COSMOS Project, and the version of Ruby being used.  You can also add your own requirements for meta data with things like the name of the operator currently running the system, or the name of a specific test you are currently running.  In general you shouldn’t need to do anything for this change unless you were using the previous metadata functionality in COSMOS.  If you were, then you will need to migrate your meta data to the new SYSTEM META packet, and change the parameters in your CmdTlmServer or TestRunner configurations regarding meta data.  If you weren’t using metadata before, then you will probably just notice this new packet in your log files, and in your telemetry stream.</p>

<p>Finally the most exciting breaking change is in how COSMOS interfaces handle protocols.  Before, the COSMOS TCP/IP and Serial interface classes each took a protocol like LENGTH, TERMINATED, etc that defined how packets were delineated by the interface.  Now each interface can take a set of one or more protocols.  This allows COSMOS to much more easily support nested protocols, such as the frame focused protocols of CCSDS.  It also allows for creating helpful reusable protocols such as the new CRC protocol for automatically adding CRCs to outgoing commands and verifying incoming CRCs on telemetry packets.  It’s a great change, but if you have any custom interface classes you have written, they will probably require some modification.  See the Interfaces section at cosmosrb.com to see how the new interface classes work. We will also be writing up a blog post to help document the process of upgrading.  Look for this in a week or two.</p>

<p>To upgrade to the latest version of COSMOS, run “bundle update cosmos” in your COSMOS project folder.</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2017/07/05/arduino-battle-bots/">
      Arduinos & Battle Bots
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      post
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      05 Jul 2017
    </span>
    <a href="https://github.com/jmthomas" class="post-author">
      <img src="https://github.com/jmthomas.png" class="avatar" alt="jmthomas avatar" width="24" height="24">
      jmthomas
    </a>
  </div>
  <div class="post-content">
    <p>Ball Aerospace COSMOS has been featured in a <a href="http://www.williamosman.com/2016/08/cosmos-and-arduino-20-telemetry-system.html">blog post</a> by <a href="http://www.williamosman.com/">William Osman</a> about creating a telemetry system for a race car. William mentions first seeing COSMOS in action on the set of Battle Bots <a href="http://www.battlebots.com/bracket-s2/">Season 2</a> where <a href="http://battlebots.com/robot/chomp-2/">Team Chomp</a> was using it enroute to their quarterfinal finish. What an awesome example of COSMOS in action!</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2017/06/19/template_protocol/">
      Template Protocol
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      post
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      19 Jun 2017
    </span>
    <a href="https://github.com/jmthomas" class="post-author">
      <img src="https://github.com/jmthomas.png" class="avatar" alt="jmthomas avatar" width="24" height="24">
      jmthomas
    </a>
  </div>
  <div class="post-content">
    <p>The <a href="/docs/protocols/#template-protocol">Template Protocol</a> is probably one of the more confusing protocols in the COSMOS protocol library but it is extremely helpful when implementing string based protocols such as Standard Commands for Programmable Instruments (SCPI; often pronounced “skippy”).</p>

<p>For this example we’ll assume we’re trying to talk to a SCPI enabled power supply such as the Keysight N6700. We start by creating a directory under our config/targets called POWER. The supply has a TCP/IP interface so we’ll use the <a href="/docs/interfaces/#tcpip-client-interface">TCP/IP Client Interface</a> to connect to it. Thus we create our POWER/cmd_tlm_server.txt file as follows:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>INTERFACE POWER_INT tcpip_client_interface.rb 127.0.0.1 5025 5025 10.0 nil TEMPLATE 0x0A 0x0A
  TARGET POWER
</code></pre></div></div>

<p>This definition declares an interface named POWER_INT using the TCP/IP client interface which connects to ‘127.0.0.1’ (obviously you’ll change this to your actual power supply IP addres) using a write and read port of 5025 (standard SCPI ports for Keysight instruments) with a write timeout of 10s and no read timeout (block on read). We specify the TEMPLATE protocol with both write and read termination characters of 0x0A (ASCII newline). Note the <a href="/docs/protocols/#template-protocol">TEMPLATE protocol</a> takes many additional parameters to allow you to work with off nominal protocol conditions.</p>

<p>Now you can define your target’s command and telemetry definitions. We’ll create example commands which get and set the voltage setting in our power supply. Create a POWER/cmd_tlm/cmd.txt file which has the following:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>COMMAND POWER GET_VOLTAGE BIG_ENDIAN "Get voltage"
  APPEND_ID_PARAMETER CMD_ID 8 UINT 1 1 1 "Command Id" # Unique command ID
  APPEND_PARAMETER CHANNEL 8 UINT 1 4 1 "Channel"
  APPEND_PARAMETER CMD_TEMPLATE 512 STRING "MEAS:VOLT? (@&lt;CHANNEL&gt;)"
  APPEND_PARAMETER RSP_TEMPLATE 512 STRING "&lt;VOLTAGE&gt;"
  APPEND_PARAMETER RSP_PACKET 512 STRING "TLM"

COMMAND POWER SET_VOLTAGE BIG_ENDIAN "Set voltage"
  APPEND_ID_PARAMETER CMD_ID 8 UINT 2 2 2 "Command Id" # Unique command ID
  APPEND_PARAMETER CHANNEL 8 UINT 1 4 1 "Channel"
  APPEND_PARAMETER VOLTAGE 8 UINT 0 100 10 "Voltage"
  APPEND_PARAMETER CMD_TEMPLATE 512 STRING "VOLT &lt;VOLTAGE&gt;,(@&lt;CHANNEL&gt;)"
  APPEND_PARAMETER RSP_TEMPLATE 512 STRING "&lt;SET_VOLTAGE&gt;"
  APPEND_PARAMETER RSP_PACKET 512 STRING "TLM"
</code></pre></div></div>

<p>The CMD_ID parameter is defined by <a href="/docs/command/#append_id_parameter">APPEND_ID_PARAMETER</a>. This ID parameter is not used by the SCPI protocol but is needed for COSMOS to identify the command when it is logged. The CMD_TEMPLATE parameter is the actual SCPI command which is being sent to the target. Anything inside brackets &lt;&gt; will be replaced by the value in the named parameter. For example, both commands define the CHANNEL parameter and thus &lt;CHANNEL&gt; will be replaced by the value of that parameter when constructing the command. The RSP_TEMPLATE is the expected string response back from the target. This is parsed by pulling out values into the bracket delimited values. The RSP_PACKET defines the packet where the bracket delimited values are defined. So for our GET_VOLTAGE example we parse the VOLTAGE value and place it in the TLM packet.</p>

<p>Create a POWER/cmd_tlm/tlm.txt file to define the response telemetry:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>TELEMETRY POWER TLM BIG_ENDIAN "Power Supply Telemetry"
  APPEND_ID_ITEM TLM_ID 32 INT 1 "Packet Identifier" # Unique telemetry ID
  APPEND_ITEM VOLTAGE 32 FLOAT "PS Measured Voltage"
    FORMAT_STRING "%0.3f"
    UNITS "Volts" "V"
  APPEND_ITEM SET_VOLTAGE 32 FLOAT "PS Set Voltage"
    FORMAT_STRING "%0.3f"
    UNITS "Volts" "V"
</code></pre></div></div>

<p>The TLM_ID item is defined by <a href="/docs/telemetry/#append_id_item">APPEND_ID_ITEM</a>. This ID item is not used by the SCPI protocol but is needed by COSMOS to decode this logged telemetry packet. The packet is named TLM which matches our RSP_PACKET definition in the commands. We define VOLTAGE and SET_VOLTAGE which also match the values used in the RSP_TEMPLATE parameters in our commands.</p>

<p>With Keysight supplies you can string together a bunch of SCIP commands in one CMD_TEMPLATE if you delimit them with semicolons. Then in the RSP_TEMPLATE you can break the response apart and set a bunch of telemetry items at once. For example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>COMMAND POWER GET_STATUS BIG_ENDIAN "Get status"
  APPEND_ID_PARAMETER CMD_ID 8 UINT 3 3 3 "Command Id" # Unique command ID
  APPEND_PARAMETER CHANNEL 8 UINT 1 4 1 "Channel"
  APPEND_PARAMETER CMD_TEMPLATE 512 STRING "MEAS:VOLT (@&lt;CHANNEL&gt;);CURR (@&lt;CHANNEL&gt;);POW (@&lt;CHANNEL&gt;)"
  APPEND_PARAMETER RSP_TEMPLATE 512 STRING "&lt;VOLTAGE&gt;,&lt;CURRENT&gt;,&lt;POWER&gt;"
  APPEND_PARAMETER RSP_PACKET 512 STRING "TLM"
</code></pre></div></div>

<p>The RSP_TEMPLATE expects to have three values delimited by the comma character. For this example to be complete you would also need to declare CURRENT and POWER items in the TLM packet.</p>

<p>Using the TEMPLATE processor can be complex but makes working with with string based command / response protocols like SCPI much easier.</p>

<p>If you have a question which would benefit the community or find a possible bug please use our <a href="https://github.com/BallAerospace/COSMOS/issues">Github Issues</a>. If you would like more information about a COSMOS training or support contract please contact us at <a href="mailto:cosmos@ball.com">cosmos@ball.com</a>.</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2017/05/18/cosmos-3-9-2-released/">
      Ball Aerospace COSMOS 3.9.2 Released
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      release
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      18 May 2017
    </span>
    <a href="https://github.com/ryanmelt" class="post-author">
      <img src="https://github.com/ryanmelt.png" class="avatar" alt="ryanmelt avatar" width="24" height="24">
      ryanmelt
    </a>
  </div>
  <div class="post-content">
    <h3 id="new-features">New Features:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/147">#147</a> TlmExtractor Full Column Names Mode</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/148">#148</a> TlmExtractor Share individual columns</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/189">#189</a> ScriptRunner Breakpoints don’t adapt to edits</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/233">#233</a> Add Config Option to Increase Tcpip Interface Timeout to TlmGrapher</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/280">#280</a> Method for determining interface packet count</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/313">#313</a> Add command line option to automatically start ScriptRunner</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/336">#336</a> Add Log Analyze Feature to TlmExtractor/CmdExtractor</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/395">#395</a> Implement Stylesheets Throughout</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/408">#408</a> Easy way to find which targets use an interface?</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/433">#433</a> Scripting support for TlmViewer close all screens</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/434">#434</a> TlmViewer option for no resize of screens</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/436">#436</a> PacketViewer option to ignore target.txt ignored items</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/441">#441</a> PacketViewer should identify derived items in the GUI</li>
</ul>

<h3 id="maintenance">Maintenance:</h3>

<p>None</p>

<h3 id="bug-fixes">Bug Fixes:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/417">#417</a>  Table Manager not checking ranges</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/419">#419</a>  Support multiple arrays in string based commands</li>
</ul>

<h3 id="migration-notes-from-cosmos-38x">Migration Notes from COSMOS 3.8.x:</h3>
<p><strong>The Table Manager configuration file format has changed.</strong>
Documentation will updated the first week of April.</p>

<p>You can migrate existing config files using:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bundle exec ruby tools\TableManager --convert config\tools\table_manager\old_table_def.txt
</code></pre></div></div>

<p>To upgrade to the latest version of COSMOS, run “bundle update cosmos” in your COSMOS project folder.</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2017/05/08/packet_processors/">
      Packet Processors
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      post
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      08 May 2017
    </span>
    <a href="https://github.com/jmthomas" class="post-author">
      <img src="https://github.com/jmthomas.png" class="avatar" alt="jmthomas avatar" width="24" height="24">
      jmthomas
    </a>
  </div>
  <div class="post-content">
    <p>COSMOS Packet Processors are a powerful concept that allow you to run code each time a specified packet is received. COSMOS provides a few generic Packet Processors which allows you to include statistics about individual telemetry points in your defined packets. Let’s break down how the COSMOS included processors are used and how you can implement your own Packet Processor.</p>

<p>First <a href="/docs/installation">install</a> COSMOS and start up the demo application. You’ll notice we declare a few targets of which one is called INST (for instrument). If you open up Packet Viewer and navigate to the INST target and the HEALTH_STATUS packet you can see a bunch of derived telemetry points at the top.</p>

<p><img src="/img/2017_05_08_packet_viewer.png" alt="Packet Viewer" /></p>

<p>These points aren’t immediately obvious in the GUI (<a href="https://github.com/BallAerospace/COSMOS/issues/441">Ticket #441</a>) but here they include all the items down to and including TEMP1STDDEV. If you right click on one of them and choose “Details” you can see that Data Type is DERVIED.</p>

<p><img src="/img/2017_05_08_details.png" alt="Derived" /></p>

<p>This is all controlled by the INST target’s cmd/tlm definition files. If you open the INST/cmd_tlm/inst_tlm.txt file from the demo you’ll see the following at the end of the HEALTH_STATUS packet definition:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  ITEM TEMP1HIGH 0 0 DERIVED "High-water mark for TEMP1"
    READ_CONVERSION processor_conversion.rb TEMP1WATER HIGH_WATER
  ITEM TEMP1LOW 0 0 DERIVED "Low-water mark for TEMP1"
    READ_CONVERSION processor_conversion.rb TEMP1WATER LOW_WATER
  ITEM TEMP1MAX 0 0 DERIVED "Maximum of most recent 100 samples for TEMP1"
    READ_CONVERSION processor_conversion.rb TEMP1STAT MAX
  ITEM TEMP1MIN 0 0 DERIVED "Minimum of most recent 100 samples for TEMP1"
    READ_CONVERSION processor_conversion.rb TEMP1STAT MIN
  ITEM TEMP1MEAN 0 0 DERIVED "Mean of most recent 100 samples for TEMP1"
    READ_CONVERSION processor_conversion.rb TEMP1STAT MEAN
  ITEM TEMP1STDDEV 0 0 DERIVED "Stddev of most recent 100 samples for TEMP1"
    READ_CONVERSION processor_conversion.rb TEMP1STAT STDDEV
  PROCESSOR TEMP1STAT statistics_processor.rb TEMP1 100
  PROCESSOR TEMP1WATER watermark_processor.rb TEMP1
</code></pre></div></div>

<p>These definitions create six new telemetry <a href="/docs/telemetry/#item">ITEMs</a>. The <a href="/docs/telemetry/#read_conversion">READ_CONVERSION</a> line takes a conversion class and then variable parameters that are passed to the class. Here we’re using the COSMOS provided processor_conversion.rb class which pulls a result calculated by a PROCESSOR. The last two lines define the two <a href="/docs/telemetry/#processor">PROCESSORs</a>.</p>

<p>Currently COSMOS provides the following three processors:</p>

<ol>
  <li>new_packet_log_processor.rb - This processor creates a new packet log whenever the given Packet is seen.</li>
  <li>watermark_processor.rb - This processor monitors a telemetry item and tracks the high and low water points of that item since the launch of the Command and Telemetry Server.</li>
  <li>statistics_processor.rb - This processor collects a given number of samples of a telemetry item and calculates the minimum, maximum, mean, and standard deviation over the sample.</li>
</ol>

<p>If all you want to do is to calculate useful statistics on your telemetry items you can stop reading now. For those who want to know how this works or want to implement their own Packet Processors, let’s continue into the source code.</p>

<h2 id="processor-implementation">Processor Implementation</h2>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="nb">require</span> <span class="s1">'cosmos/processors/processor'</span>
<span class="k">module</span> <span class="nn">Cosmos</span>
  <span class="k">class</span> <span class="nc">WatermarkProcessor</span> <span class="o">&lt;</span> <span class="no">Processor</span>
    <span class="c1"># @param item_name [String] The name of the item to gather statistics on</span>
    <span class="c1"># @param value_type #See Processor::initialize</span>
    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">item_name</span><span class="p">,</span> <span class="n">value_type</span> <span class="o">=</span> <span class="ss">:CONVERTED</span><span class="p">)</span>
      <span class="k">super</span><span class="p">(</span><span class="n">value_type</span><span class="p">)</span>
      <span class="vi">@item_name</span> <span class="o">=</span> <span class="n">item_name</span><span class="p">.</span><span class="nf">to_s</span><span class="p">.</span><span class="nf">upcase</span>
      <span class="n">reset</span><span class="p">()</span>
    <span class="k">end</span>

    <span class="c1"># See Processor#call</span>
    <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span> <span class="n">buffer</span><span class="p">)</span>
      <span class="n">value</span> <span class="o">=</span> <span class="n">packet</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="vi">@item_name</span><span class="p">,</span> <span class="vi">@value_type</span><span class="p">,</span> <span class="n">buffer</span><span class="p">)</span>
      <span class="n">high_water</span> <span class="o">=</span> <span class="vi">@results</span><span class="p">[</span><span class="ss">:HIGH_WATER</span><span class="p">]</span>
      <span class="vi">@results</span><span class="p">[</span><span class="ss">:HIGH_WATER</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span> <span class="k">if</span> <span class="o">!</span><span class="n">high_water</span> <span class="n">or</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="n">high_water</span>
      <span class="n">low_water</span> <span class="o">=</span> <span class="vi">@results</span><span class="p">[</span><span class="ss">:LOW_WATER</span><span class="p">]</span>
      <span class="vi">@results</span><span class="p">[</span><span class="ss">:LOW_WATER</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span> <span class="k">if</span> <span class="o">!</span><span class="n">low_water</span> <span class="n">or</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="n">low_water</span>
    <span class="k">end</span>

    <span class="c1"># Reset any state</span>
    <span class="k">def</span> <span class="nf">reset</span>
      <span class="vi">@results</span><span class="p">[</span><span class="ss">:HIGH_WATER</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
      <span class="vi">@results</span><span class="p">[</span><span class="ss">:LOW_WATER</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
    <span class="k">end</span>

    <span class="c1"># Convert to configuration file string</span>
    <span class="k">def</span> <span class="nf">to_config</span>
      <span class="s2">"  PROCESSOR </span><span class="si">#{</span><span class="vi">@name</span><span class="si">}</span><span class="s2"> </span><span class="si">#{</span><span class="nb">self</span><span class="p">.</span><span class="nf">class</span><span class="p">.</span><span class="nf">name</span><span class="p">.</span><span class="nf">to_s</span><span class="p">.</span><span class="nf">class_name_to_filename</span><span class="si">}</span><span class="s2"> </span><span class="si">#{</span><span class="vi">@item_name</span><span class="si">}</span><span class="s2"> </span><span class="si">#{</span><span class="vi">@value_type</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></figure>

<p>The initialize method gets passed the parameters from the config file. Thus our config file of:
<code class="highlighter-rouge">PROCESSOR TEMP1WATER watermark_processor.rb TEMP1</code>
passes ‘TEMP1’ into ‘item_name’ of the initialize method:
<code class="highlighter-rouge">def initialize(item_name, value_type = :CONVERTED)</code>
Since we only pass one value, we use the default value_type of :CONVERTED.</p>

<p>We store the item_name into a Ruby instance variable @item_name and call reset() to initialize our @results. But how did we get a @results instance variable? If you look at the class definition we are inheriting from <a href="https://github.com/BallAerospace/COSMOS/blob/master/lib/cosmos/processors/processor.rb">Processor</a> which is the base class for all COSMOS Processors. It declares a @results instance variable and initializes @results in its initialize method which we call using super(value_type).</p>

<p>The call method is the most important Processor method. It is always passed the packet and buffer. The packet is the COSMOS Packet instance which contains the value you’re interested in. Buffer is the raw binary buffer which this packet is based on. The Processor base class should never be directly used as it defines but does not implement call. Instead, you inherit from Processor like we did with WatermarkProcessor and implement your own call method. WatermarkProcessor reads the item we’re interested in and then compares it with the currently stored high and low value to determine if it should be saved. Note how it is saving the value in the @results hash with the :HIGH_WATER and :LOW_WATER symbol keys.</p>

<h2 id="processor-conversion">Processor Conversion</h2>

<p>If you then open up the processor_conversion.rb code you can see how these results are converted into new telemetry items.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="nb">require</span> <span class="s1">'cosmos/conversions/conversion'</span>
<span class="k">module</span> <span class="nn">Cosmos</span>
  <span class="c1"># Retrieves the result from an item processor</span>
  <span class="k">class</span> <span class="nc">ProcessorConversion</span> <span class="o">&lt;</span> <span class="no">Conversion</span>
    <span class="c1"># @param processor_name [String] The name of the associated processor</span>
    <span class="c1"># @param result_name [String] The name of the associated result in the processor</span>
    <span class="c1"># @param converted_type [String or nil] The datatype of the result of the processor</span>
    <span class="c1"># @param converted_bit_size [Integer or nil] The bit size of the result of the processor</span>
    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">processor_name</span><span class="p">,</span> <span class="n">result_name</span><span class="p">,</span> <span class="n">converted_type</span> <span class="o">=</span> <span class="kp">nil</span><span class="p">,</span> <span class="n">converted_bit_size</span> <span class="o">=</span> <span class="kp">nil</span><span class="p">)</span>
      <span class="k">super</span><span class="p">()</span>
      <span class="vi">@processor_name</span> <span class="o">=</span> <span class="n">processor_name</span><span class="p">.</span><span class="nf">to_s</span><span class="p">.</span><span class="nf">upcase</span>
      <span class="vi">@result_name</span> <span class="o">=</span> <span class="n">result_name</span><span class="p">.</span><span class="nf">to_s</span><span class="p">.</span><span class="nf">upcase</span><span class="p">.</span><span class="nf">intern</span>
      <span class="k">if</span> <span class="no">ConfigParser</span><span class="p">.</span><span class="nf">handle_nil</span><span class="p">(</span><span class="n">converted_type</span><span class="p">)</span>
        <span class="vi">@converted_type</span> <span class="o">=</span> <span class="n">converted_type</span><span class="p">.</span><span class="nf">to_s</span><span class="p">.</span><span class="nf">upcase</span><span class="p">.</span><span class="nf">intern</span>
        <span class="k">raise</span> <span class="no">ArgumentError</span><span class="p">,</span> <span class="s2">"Unknown converted type: </span><span class="si">#{</span><span class="n">converted_type</span><span class="si">}</span><span class="s2">"</span> <span class="k">if</span> <span class="o">!</span><span class="no">BinaryAccessor</span><span class="o">::</span><span class="no">DATA_TYPES</span><span class="p">.</span><span class="nf">include?</span><span class="p">(</span><span class="vi">@converted_type</span><span class="p">)</span>
      <span class="k">end</span>
      <span class="vi">@converted_bit_size</span> <span class="o">=</span> <span class="no">Integer</span><span class="p">(</span><span class="n">converted_bit_size</span><span class="p">)</span> <span class="k">if</span> <span class="no">ConfigParser</span><span class="p">.</span><span class="nf">handle_nil</span><span class="p">(</span><span class="n">converted_bit_size</span><span class="p">)</span>
    <span class="k">end</span>

    <span class="c1"># @param (see Conversion#call)</span>
    <span class="c1"># @return [Varies] The result of the associated processor</span>
    <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">packet</span><span class="p">,</span> <span class="n">buffer</span><span class="p">)</span>
      <span class="n">packet</span><span class="p">.</span><span class="nf">processors</span><span class="p">[</span><span class="vi">@processor_name</span><span class="p">].</span><span class="nf">results</span><span class="p">[</span><span class="vi">@result_name</span><span class="p">]</span> <span class="o">||</span> <span class="mi">0</span> <span class="c1"># Never return nil</span>
    <span class="k">end</span>
    <span class="k">def</span> <span class="nf">to_s</span><span class="p">;</span> <span class="k">end</span> <span class="c1"># Not shown for brevity</span>
    <span class="k">def</span> <span class="nf">to_config</span><span class="p">(</span><span class="n">read_or_write</span><span class="p">);</span> <span class="k">end</span> <span class="c1"># Not shown for brevity</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></figure>

<p>First of all note that ProcessorConversion inherits from the <a href="https://github.com/BallAerospace/COSMOS/blob/master/lib/cosmos/conversions/conversion.rb">Conversion</a> base class. This is very similar to the WatermarkProcessor inheriting from the Processor base class. Again, there is an initialize method and a call method. The initialize method requires the processor_name and result_name and takes optional parameters that help describe the converted type. Let’s see how these map together in our definition.</p>

<p>Our config file looked like the following:
<code class="highlighter-rouge">READ_CONVERSION processor_conversion.rb TEMP1WATER HIGH_WATER</code>
This passes TEMP1WATER and HIGH_WATER as processor_name and result_name into initialize:
<code class="highlighter-rouge">def initialize(processor_name, result_name, converted_type = nil, converted_bit_size = nil)</code></p>

<p>We store the processor name and result name into Ruby instance variables (first turning them into upper case strings). We additionally turn the result name into a Ruby symbol by calling intern on it. This allows us to match the symbol names we used in the WatermarkProcessor code.</p>

<p>All Conversion classes also implement the call method except with a slightly different signature. In addition to the packet and buffer being passed, the raw value is returned. The ProcessorConversion class uses the packet instance to access the processors hash by the given processor name and then accesses the results hash by the passed result name. We add a ‘|| 0’ which does a logical OR on the initial result to ensure that we don’t return a nil value as a result of the conversion.</p>

<h2 id="custom-processor">Custom Processor</h2>

<p>So how could we implement our own Processor? Let’s say you had some telemetry points that you wanted to average and report that averaged value as a new telemetry item. This is useful because you can then add limits to this new item and act on its value in scripts without having to constantly perform the averaging operation.</p>

<p>First create your new Processor class. Let’s call it MeanProcessor. This code should go into a file called mean_processor.rb and can either live in one of your target/lib folders or since it’s generic we can put it in the top level /lib directory in our project.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="nb">require</span> <span class="s1">'cosmos/processors/processor'</span>
<span class="k">module</span> <span class="nn">Cosmos</span>
  <span class="k">class</span> <span class="nc">MeanProcessor</span> <span class="o">&lt;</span> <span class="no">Processor</span>
    <span class="c1"># @param item_name [Array&lt;String&gt;] The names of the items to mean</span>
    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="o">*</span><span class="n">item_names</span><span class="p">)</span> <span class="c1"># the splat operator accepts a variable length argument list</span>
      <span class="k">super</span><span class="p">(</span><span class="ss">:CONVERTED</span><span class="p">)</span> <span class="c1"># Hard code to work on converted values</span>
      <span class="vi">@item_names</span> <span class="o">=</span> <span class="n">item_names</span> <span class="c1"># Array of the item names</span>
      <span class="n">reset</span><span class="p">()</span>
    <span class="k">end</span>

    <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span> <span class="n">buffer</span><span class="p">)</span>
      <span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
      <span class="vi">@item_names</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">item</span><span class="o">|</span>
        <span class="n">values</span> <span class="o">&lt;&lt;</span> <span class="n">packet</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="ss">:CONVERTED</span><span class="p">,</span> <span class="n">buffer</span><span class="p">)</span>
      <span class="k">end</span>
      <span class="vi">@results</span><span class="p">[</span><span class="ss">:MEAN</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span><span class="p">.</span><span class="nf">inject</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="o">+</span><span class="p">).</span><span class="nf">to_f</span> <span class="o">/</span> <span class="n">values</span><span class="p">.</span><span class="nf">length</span>
    <span class="k">end</span>

    <span class="c1"># Reset any state</span>
    <span class="k">def</span> <span class="nf">reset</span>
      <span class="vi">@results</span><span class="p">[</span><span class="ss">:MEAN</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">end</span>

    <span class="c1"># Convert to configuration file string</span>
    <span class="k">def</span> <span class="nf">to_config</span>
      <span class="s2">"  PROCESSOR </span><span class="si">#{</span><span class="vi">@name</span><span class="si">}</span><span class="s2"> </span><span class="si">#{</span><span class="nb">self</span><span class="p">.</span><span class="nf">class</span><span class="p">.</span><span class="nf">name</span><span class="p">.</span><span class="nf">to_s</span><span class="p">.</span><span class="nf">class_name_to_filename</span><span class="si">}</span><span class="s2"> </span><span class="si">#{</span><span class="vi">@item_names</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="s1">' '</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></figure>

<p>This class introduces some new Ruby syntax. Since we want to accept any number of items to average we have to accept a variable number of arguments in our initialize method. The ruby splat operator (or star operator) does this and places the arguments into a Ruby array. We store these names and then use them in our call method to perform the mean. I’m using a cool feature of Ruby’s Enumerable mixin, which is part of Array, to sum up the values (starting with 0) and then dividing by the number of values we have to get the mean. Note I’m also calling to_f to ensure the numerator is a floating point number so we do floating point math during the division. Integer division would truncate the value to an integer value.</p>

<p>First to use this new processor you need to require it in your target’s <a href="/docs/system/#targettxt-keywords">target.txt</a> configuration file:
<code class="highlighter-rouge">REQUIRE mean_processor.rb</code>
Then delcare the processing in your configuration definition as follows:
<code class="highlighter-rouge">TELEMETRY INST HEALTH_STATUS BIG_ENDIAN "Health and status from the instrument"
  ... # See demo configuration
  ITEM TEMPS_MEAN 0 0 DERIVED "Mean of TEMP1, TEMP2, TEMP3, TEMP4"
    READ_CONVERSION processor_conversion.rb TEMPMEAN MEAN
  PROCESSOR TEMPMEAN mean_processor.rb TEMP1 TEMP2 TEMP3 TEMP4
</code></p>

<p>We define the processor on the INST HEALTH_STATUS packet and pass in 4 items to average. We also define a new derived item called TEMPS_MEAN which uses our previously described processor_conversion to pull out the MEAN value that we calculated. The result is shown in this PacketViewer screen shot:</p>

<p><img src="/img/2017_05_08_packet_viewer2.png" alt="Packet Viewer" /></p>

<p>Creating a custom processor definitely requires you to dive into the COSMOS API and play with the underlying Ruby code. Hopefully the existing processor code and this blog post helps you to derive whatever telemetry points you need.</p>

<p>If you have a question which would benefit the community or find a possible bug please use our <a href="https://github.com/BallAerospace/COSMOS/issues">Github Issues</a>. If you would like more information about a COSMOS training or support contract please contact us at <a href="mailto:cosmos@ball.com">cosmos@ball.com</a>.</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2017/04/24/wired/">
      WIRED Article
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      post
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      24 Apr 2017
    </span>
    <a href="https://github.com/jmthomas" class="post-author">
      <img src="https://github.com/jmthomas.png" class="avatar" alt="jmthomas avatar" width="24" height="24">
      jmthomas
    </a>
  </div>
  <div class="post-content">
    <p>Ball Aerospace COSMOS has been featured in an article on <a href="https://www.wired.com/2017/04/aerospace-coder-drags-stodgy-industry-toward-open-source/">WIRED.com</a>. The article focues on the fact that COSMOS is open source and what that means for the industry. The author includes quotes from GitHub’s VP of Product Engineering, Aerospace Corporation’s Principle Director of IT, and of course Ryan Melton and Jason Thomas of Ball Aerospace.</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2017/03/29/cosmos-3-9-1-released/">
      Ball Aerospace COSMOS 3.9.1 Released
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      release
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      29 Mar 2017
    </span>
    <a href="https://github.com/ryanmelt" class="post-author">
      <img src="https://github.com/ryanmelt.png" class="avatar" alt="ryanmelt avatar" width="24" height="24">
      ryanmelt
    </a>
  </div>
  <div class="post-content">
    <h3 id="new-features">New Features:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/382">#382</a> CmdTlmServer Start/Stop for background tasks</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/385">#385</a> Quick access to COSMOS gem code</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/388">#388</a> Legal Dialog should show COSMOS version</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/409">#409</a> Update LINC interface to support multiple targets on the same interface</li>
</ul>

<h3 id="maintenance">Maintenance:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/369">#369</a> Table Manager refactoring</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/386">#386</a> Batch file for offline installation</li>
</ul>

<h3 id="bug-fixes">Bug Fixes:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/236">#236</a> Test Runner doesn’t support status_bar</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/329">#329</a> Using XTCE file instead of .txt cmd_tlm file didn’t work as online docs suggest</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/378">#378</a> TlmViewer displaying partials in the screen list</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/402">#402</a> Mac installation is failed - Please help.</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/411">#411</a> xtce explicit byte order list processing isn’t correct</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/412">#412</a> subscribe_packet_data needs to validate parameters</li>
</ul>

<h3 id="migration-notes-from-cosmos-38x">Migration Notes from COSMOS 3.8.x:</h3>
<p><strong>The Table Manager configuration file format has changed.</strong>
Documentation will updated the first week of April.</p>

<p>You can migrate existing config files using:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bundle exec ruby tools\TableManager --convert config\tools\table_manager\old_table_def.txt
</code></pre></div></div>

<p>To upgrade to the latest version of COSMOS, run “bundle update cosmos” in your COSMOS project folder.</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2017/02/22/routers/">
      Routers
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      post
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      22 Feb 2017
    </span>
    <a href="https://github.com/jmthomas" class="post-author">
      <img src="https://github.com/jmthomas.png" class="avatar" alt="jmthomas avatar" width="24" height="24">
      jmthomas
    </a>
  </div>
  <div class="post-content">
    <p>COSMOS Routers can be a confusing topic for people new and old alike to the COSMOS system. Let’s break them down and explore how COSMOS uses them internally and how you might use them in your configuration.</p>

<p>A COSMOS Router is first and foremost an interface like any other COSMOS interface. In fact if you look through the source code you won’t even see a Router class because they are instances of the Interface class. As a reminder, an Interface provides the lowest level connection between COSMOS and a target (something you’re trying to get COSMOS to talk to). Thus a Router is also providing a low level connection between COSMOS and something. So what’s the difference? Normal Interfaces read the target and send data (telemetry) to COSMOS and send commands to the target. Routers do the exact opposite: they route telemetry out to clients connected to them and route commands sent to them back to a target. Thus they provide a conduit for other clients to communicate with a target.</p>

<p>The COSMOS Command and Telemetry Server always starts a Router called the PREIDENTIFIED_ROUTER which appears in the Routers tab of the GUI:
<img src="/img/2017_02_22_router_tab.png" alt="Server Routers" /></p>

<p>The Preidentified Router is controlled by the system.txt configuration file:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Ethernet Ports
PORT CTS_API 7777
PORT TLMVIEWER_API 7778
PORT CTS_PREIDENTIFIED 7779
</code></pre></div></div>

<p>This Router is called the PREIDENTIFIED router because it uses a special stream protocol which adds the packet received time, the target name, and the packet name before sending the packet. This stream is used by the Telemetry Grapher so it doesn’t have to spend additional cycles identifying packets and can directly graph the packets it is interested in. The Replay tool also creates this router for the exact same purpose.</p>

<p>If you look back at the picture you’ll see in our demo configuration that we also create another Router called the INST_ROUTER. This is how that Router is configured:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ROUTER INST_ROUTER tcpip_server_interface.rb 2055 2055 10.0 nil LENGTH 32 16 7
  OPTION LISTEN_ADDRESS 127.0.0.1
  ROUTE INST_INT
</code></pre></div></div>

<p>Basically we’re creating a Router that routes only the INST interface data. We create this Router using a TCPIP Server interface with a LENGTH protocol of bit offset 32, length field size of 16, and length value offset of 7. These values were chosen to match the INST command and telemetry which use CCSDS headers. The CCSDS standard specifies a 16 bit length field at offset 32. The CCSDS standard also specifies that the length field is the length of the packet past the length field minus 1. Thus we add 7 for the 4 bytes of offset, 2 bytes of length field, and the minus 1.</p>

<p>For more information about the options you can pass to a Router (and Interface) see the <a href="http://cosmosrb.com/docs/interfaces/">Interface Configuration</a> part of the documentation.</p>

<p>To connect to the INST_ROUTER that we created we can write a little Ruby code using existing COSMOS interface classes and streams.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="nb">require</span> <span class="s1">'cosmos'</span>
<span class="nb">require</span> <span class="s1">'cosmos/interfaces/tcpip_client_interface'</span>
<span class="n">i</span> <span class="o">=</span> <span class="no">Cosmos</span><span class="o">::</span><span class="no">TcpipClientInterface</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span><span class="mi">2055</span><span class="p">,</span><span class="mi">2055</span><span class="p">,</span><span class="kp">nil</span><span class="p">,</span><span class="kp">nil</span><span class="p">,</span><span class="s1">'LENGTH'</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="n">i</span><span class="p">.</span><span class="nf">connect</span>
<span class="kp">loop</span> <span class="k">do</span>
  <span class="n">pkt</span> <span class="o">=</span> <span class="no">Cosmos</span><span class="o">::</span><span class="no">System</span><span class="p">.</span><span class="nf">telemetry</span><span class="p">.</span><span class="nf">identify!</span><span class="p">(</span><span class="n">i</span><span class="p">.</span><span class="nf">read</span><span class="p">.</span><span class="nf">buffer</span><span class="p">,</span> <span class="p">[</span><span class="s1">'INST'</span><span class="p">])</span>
  <span class="nb">puts</span> <span class="n">pkt</span><span class="p">.</span><span class="nf">packet_name</span>
<span class="k">end</span></code></pre></figure>

<p>Obviously we need the TCPIP Client Interface to match the port number of the TCPIP Server and we also need to match the LENGTH protocol options. Notice how we have to call the System.telemetry.identify! method to identify the raw packet stream. When I run this from a command prompt after starting the Server I see a stream of packet names similar to this:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>MECH
ADCS
MECH
IMAGE
PARAMS
ADCS
HEALTH_STATUS
MECH
ADCS
...
</code></pre></div></div>
<p>You should see MECH and ADCS come out at 10Hz and the IMAGE, PARAMS, and HEALTH_STATUS come out at 1Hz. This matches the Packet Count ratio on the Tlm Packets tab of the Server.</p>

<p>We can also write some code to connect to the PREIDENTIFIED router. It looks very similar to the previous code except we do not need to identify the packets as they are pre-identified!</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="nb">require</span> <span class="s1">'cosmos'</span>
<span class="nb">require</span> <span class="s1">'cosmos/interfaces/tcpip_client_interface'</span>
<span class="n">i</span> <span class="o">=</span> <span class="no">Cosmos</span><span class="o">::</span><span class="no">TcpipClientInterface</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span><span class="mi">7779</span><span class="p">,</span><span class="mi">7779</span><span class="p">,</span><span class="kp">nil</span><span class="p">,</span><span class="kp">nil</span><span class="p">,</span><span class="s1">'PREIDENTIFIED'</span><span class="p">)</span>
<span class="n">i</span><span class="p">.</span><span class="nf">connect</span>
<span class="kp">loop</span> <span class="k">do</span>
  <span class="n">pkt</span> <span class="o">=</span> <span class="n">i</span><span class="p">.</span><span class="nf">read</span>
  <span class="nb">puts</span> <span class="n">pkt</span><span class="p">.</span><span class="nf">packet_name</span>
<span class="k">end</span></code></pre></figure>

<p>This time you should see some LIMITS_CHANGE packet names sprinkled in with the output from before. That’s because we’re accessing the ENTIRE COSMOS telemetry stream and not just the stream from the INST interface. Keep this in mind if you have performance issues when trying to process the entire telemetry stream.</p>

<p>If you have a question which would benefit the community or find a possible bug please use our <a href="https://github.com/BallAerospace/COSMOS/issues">Github Issues</a>. If you would like more information about a COSMOS training or support contract please contact us at <a href="mailto:cosmos@ball.com">cosmos@ball.com</a>.</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2016/12/06/cosmos-3-8-3-released/">
      Ball Aerospace COSMOS 3.8.3 Released
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      release
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      06 Dec 2016
    </span>
    <a href="https://github.com/ryanmelt" class="post-author">
      <img src="https://github.com/ryanmelt.png" class="avatar" alt="ryanmelt avatar" width="24" height="24">
      ryanmelt
    </a>
  </div>
  <div class="post-content">
    <h3 id="new-features">New Features:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/230">#230</a> Make AUTO_TARGETS ignore target folders that have already been manually referenced</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/257">#257</a> Increment received_count in packet log reader</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/264">#264</a> Validate command/telemetry conversions during startup</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/292">#292</a> Target directory for API methods</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/314">#314</a> Update .bat files to handle spaces in path</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/316">#316</a> Add option to radiobutton widget to be checked by default</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/326">#326</a> Script Runner Crash using message_box with boolean parameter</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/339">#339</a> Add ‘Help’ menu item to open cosmosrb.com -&gt; Documentation</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/340">#340</a> Packet Viewer - Allow select cell and copy value as text</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/357">#357</a> Add support for mixed endianness within tables</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/359">#359</a> Table Manager support MIN/MAX UINTX macros</li>
</ul>

<h3 id="maintenance">Maintenance:</h3>
<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/349">#349</a> Optimize cmd() to not build commands twice</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/362">#362</a> restore_defaults should take an optional parameter to exclude specified parameters</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/365">#365</a> Windows installer can have issues if .gem files are present in same folder</li>
  <li>TestRunner support for newer Bundler (Abstract error when starting)</li>
</ul>

<h3 id="bug-fixes">Bug Fixes:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/322">#322</a> Udp interface thread does not gracefully shutdown</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/327">#327</a> TlmGrapher Screenshot in Linux captures the screenshot dialog box</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/332">#332</a> ERB template local variables dont’ support strings</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/338">#338</a> Setting received_time and received_count on a packet should clear the read conversion cache</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/342">#342</a> Cut and Paste Error in top_level.rb</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/344">#344</a> CmdTlmServer connect/disconnect button doesn’t work after calling connect_interface from script</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/359">#359</a> Table Manager doesn’t support strings</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/372">#372</a> TestRunner reinstantiating TestSuite/Test objects every execution</li>
</ul>

<h3 id="migration-notes-from-cosmos-37x">Migration Notes from COSMOS 3.7.x:</h3>
<p>None</p>

<p>To upgrade to the latest version of COSMOS, run “bundle update cosmos” in your COSMOS project folder.</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2016/10/13/cosmos-cubesat-ops/">
      SmallSat Ops
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      post
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      13 Oct 2016
    </span>
    <a href="https://github.com/jmthomas" class="post-author">
      <img src="https://github.com/jmthomas.png" class="avatar" alt="jmthomas avatar" width="24" height="24">
      jmthomas
    </a>
  </div>
  <div class="post-content">
    <p>The fact that COSMOS is the only open source C2 system has made it an ideal small satellite operations platform. This is one of the reasons Ryan attended the Small Satellite Conference back in August. He gave a very well received COSMOS presentation and was able to meet with many players in the industry.</p>

<p><img src="/img/2016_10_13_ryan_smallsat.png" alt="Ryan at SmallSat" />
<em>Ryan enjoying the moment at Small Sat 2016</em></p>

<p>I recently googled for “COSMOS Command and Control” and came across a <a href="https://www.linkedin.com/pulse/cosmos-lightweight-command-control-system-cubesats-richard-ibbotson">LinkedIn article</a> about COSMOS. We had heard from Pat Stakem during the summer of 2015 but hadn’t heard much since. He and his students created a CubeSat using the open source <a href="https://cfs.gsfc.nasa.gov/">Core Flight System</a> from NASA Goddard. Of course they used COSMOS for their ground system running on Ubuntu. They integrated Apache to serve up the COSMOS telemetry files generated from Telemetry Extractor to operate their satellite “lights out”. They put together a great <a href="/assets/Stakem-etal-FSW-15.pdf">PowerPoint</a> presentation with screenshots of COSMOS. They also created a <a href="/assets/A Lightweight Open Source Command and Control Center and its interface to Cubesats.pdf">whitepaper</a> detailing the entire process.</p>

<p><img src="/img/2016_10_13_stakem_screenshot.png" alt="Stakem Screenshot" />
<em>Screenshot showing COSMOS in action</em></p>

<p>Since COSMOS is open source, we don’t always hear about what people are doing with it. If you have a COSMOS success story you’d like to share with us please contact us at <a href="mailto:cosmos@ball.com">cosmos@ball.com</a>.</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2016/09/12/erb-config/">
      ERB Config Files
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      post
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      12 Sep 2016
    </span>
    <a href="https://github.com/jmthomas" class="post-author">
      <img src="https://github.com/jmthomas.png" class="avatar" alt="jmthomas avatar" width="24" height="24">
      jmthomas
    </a>
  </div>
  <div class="post-content">
    <p>COSMOS configuration files support ERB (Embedded RuBy) which is used heavily by <a href="http://rubyonrails.org/">Ruby on Rails</a>. I found a pretty good description of ERB <a href="http://www.stuartellis.eu/articles/erb/">here</a>. ERB allows you to put executable Ruby code in your configuration files. The trick is to surround the Ruby code with the special markers: <code class="highlighter-rouge">&lt;% &lt;code&gt; %&gt;</code>. If you want the result of your Ruby code to be placed in the configuration file you need to add the equal sign to the first marker: <code class="highlighter-rouge">&lt;%= &lt;code&gt; %&gt;</code></p>

<p>A COSMOS user recently asked if he could include environment variables in his COSMOS configuration. This is very easy using the ERB syntax. For example, you have an environment variable named “LOG_DIR” in your system which points to the path you want to store your COSMOS logs. To use this value you would modify your system.txt file as follows:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>...
# Paths
PATH LOGS &lt;%= ENV["LOG_DIR"] %&gt;
...
</code></pre></div></div>

<p>When this file gets parsed by COSMOS, the value of the LOG_DIR environment variable gets inserted into the system.txt output file. Note the %= syntax to insert the value and how I’m using the <a href="https://ruby-doc.org/core-2.3.0/ENV.html">ENV</a> from the Ruby core library.</p>

<p>It’s recommended that you don’t put too much logic in these ERB statements to keep your configuration files readable and maintainable. If you have a complex piece of code you want to use in an ERB statement, you can create a utility in your ‘lib’ folder and define methods to use. For example, in your ‘lib’ folder create utilties.rb:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">def</span> <span class="nf">log_path</span>
  <span class="no">File</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="no">Cosmos</span><span class="o">::</span><span class="no">USERPATH</span><span class="p">,</span> <span class="s1">'outputs'</span><span class="p">,</span> <span class="s1">'mylogs'</span><span class="p">)</span>
<span class="k">end</span></code></pre></figure>

<p>Now in system.txt we can use that ‘log_path’ routine after we first require ‘utilities’.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;% require 'utilities' %&gt;
...
# Paths
PATH LOGS &lt;%= log_path() %&gt;
...
</code></pre></div></div>
<p>Notice how the first ERB statement does NOT use the %= syntax since I’m simply requiring the file I want to use. I don’t want to put anything in the template itself. Later in the PATH statement I use the %= syntax to insert the result of the log_path() method.</p>

<p>ERB templates are particularly useful in command and telemetry definitions as they allow you to reuse sections. We’ve added our own routine called ‘render’ (similar to Ruby on Rails) which can render a command or telemetry template. The best example of this is in the COSMOS Demo INST target. If you open the inst_cmds.txt file you’ll see this:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>COMMAND INST COLLECT BIG_ENDIAN "Starts a collect on the instrument"
  &lt;%= render "_ccsds_cmd.txt", locals: {id: 1} %&gt;
  PARAMETER    TYPE           64  16  UINT MIN MAX 0 "Collect type"
    REQUIRED
    STATE NORMAL  0
    STATE SPECIAL 1 HAZARDOUS
  PARAMETER    DURATION       80  32  FLOAT 0.0 10.0 1.0 "Collect duration"
  PARAMETER    OPCODE        112   8  UINT 0x0 0xFF 0xAB "Collect opcode"
    FORMAT_STRING "0x%0X"
  PARAMETER    TEMP          120  32  FLOAT 0.0 25.0 0.0 "Collect temperature"
    UNITS Celsius C

COMMAND INST ABORT BIG_ENDIAN "Aborts a collect on the instrument"
  &lt;%= render "_ccsds_cmd.txt", locals: {id: 2} %&gt;

...
</code></pre></div></div>

<p>Notice the call to <code class="highlighter-rouge">&lt;%= render "_ccsds_cmd.txt", locals: {id: 1} %&gt;</code>. Opening the ‘_ccsds_cmd.txt’ file reveals this command template:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  PARAMETER    CCSDSVER        0   3  UINT  0     0   0 "CCSDS primary header version number"
  PARAMETER    CCSDSTYPE       3   1  UINT  1     1   1 "CCSDS primary header packet type"
  PARAMETER    CCSDSSHF        4   1  UINT  0     0   0 "CCSDS primary header secondary header flag"
  ID_PARAMETER CCSDSAPID       5  11  UINT  0  2047 999 "CCSDS primary header application id"
  PARAMETER    CCSDSSEQFLAGS  16   2  UINT  3     3   3 "CCSDS primary header sequence flags"
  PARAMETER    CCSDSSEQCNT    18  14  UINT  0 16383   0 "CCSDS primary header sequence count"
    OVERFLOW TRUNCATE
  PARAMETER    CCSDSLENGTH    32  16  UINT MIN MAX 12 "CCSDS primary header packet length"
  ID_PARAMETER PKTID          48  16  UINT MIN MAX &lt;%= id %&gt; "Packet id"
</code></pre></div></div>

<p>The call to render replaces everything in the named template with the render call. We follow the Ruby on Rails convention of naming these templates (Rails calls them ‘partials’) with a leading underscore to differentiate them from full command and telemetry definitions. Notice too that we are passing local variables to the template. The ‘id: 1’ syntax is basically setting the ‘id’ variable in the template to 1. This allows us to send a different PKTID to each command.</p>

<p>ERB is incredibly powerful and a great way to avoid WET (Write Each Time) command and telemetry definitions. Now go DRY (Don’t Repeat Yourself) up your COSMOS configuration!</p>

<p>If you have a question which would benefit the community or find a possible bug please use our <a href="https://github.com/BallAerospace/COSMOS/issues">Github Issues</a>. If you would like more information about a COSMOS training or support contract please contact us at <a href="mailto:cosmos@ball.com">cosmos@ball.com</a>.</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2016/08/22/custom-widgets/">
      Custom Widgets
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      post
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      22 Aug 2016
    </span>
    <a href="https://github.com/jmthomas" class="post-author">
      <img src="https://github.com/jmthomas.png" class="avatar" alt="jmthomas avatar" width="24" height="24">
      jmthomas
    </a>
  </div>
  <div class="post-content">
    <p>Sometimes we receive requests to make custom COSMOS widgets or to modify existing COSMOS widgets to add certain looks or functionality. While this is a project we’re happy to perform for our customers, it’s also something that can be done by end users willing to dig into some of the Qt and COSMOS documentation. In this post, I’m going to describe how to create a custom COSMOS widget.</p>

<p>When asked to perform customizations like this I first bring up the COSMOS Demo. We try to include all the COSMOS features in the Demo so end users have concrete examples to follow instead of relying solely on the excellent documentation at <a href="http://cosmosrb.com/docs/home">cosmosrb.com</a>. Obviously you must first have COSMOS installed so follow the <a href="http://cosmosrb.com/docs/installation/">installation instructions</a> and then launch the Demo by running the Launcher in the Demo folder. Here is how the server appears on my Windows machine:</p>

<p><img src="/img/2016_08_22_server.png" alt="COSMOS Demo Server" /></p>

<p>I’m going to create a custom widget in the INST target to display some of the Array data in a table. If you first launch the Telemetry Viewer and open the INST ARRAY screen you should see the following:</p>

<p><img src="/img/2016_08_22_inst_array.png" alt="COSMOS Inst Array" /></p>

<p>This screen is already using the Array widget to display this data in a text box. We will add our new widget to the top of the screen which will display the data in a table. Let’s add the line to the screen which will call our new widget. Edit <code class="highlighter-rouge">demo/config/targets/INST/screens/array.txt</code> and add the following line in the middle:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>...
TITLE "Instrument Array Data"
DEMOTABLE INST HEALTH_STATUS ARY
ARRAY INST HEALTH_STATUS ARY 300 50 nil 8 FORMATTED
...
</code></pre></div></div>

<p>Now we need to create the DemotableWidget which will implement the actual display. Create a new file called <code class="highlighter-rouge">demotable_widget.rb</code> in <code class="highlighter-rouge">demo/config/targets/INST/lib</code>. Note that the name of the line in the config file, DEMOTABLE, must be all lowercase followed by an underscore and ‘widget’. The class name in the file must be one word with the first letter and Widget capitalized. This is how it should start:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="nb">require</span> <span class="s1">'cosmos/tools/tlm_viewer/widgets/widget'</span>

<span class="k">module</span> <span class="nn">Cosmos</span>
  <span class="k">class</span> <span class="nc">DemotableWidget</span> <span class="o">&lt;</span> <span class="no">Qt</span><span class="o">::</span><span class="no">TableWidget</span>
    <span class="kp">include</span> <span class="no">Widget</span>

    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">parent_layout</span><span class="p">,</span> <span class="n">target_name</span><span class="p">,</span> <span class="n">packet_name</span><span class="p">,</span> <span class="n">item_name</span><span class="p">,</span> <span class="n">value_type</span> <span class="o">=</span> <span class="ss">:WITH_UNITS</span><span class="p">)</span>
      <span class="k">super</span><span class="p">(</span><span class="n">target_name</span><span class="p">,</span> <span class="n">packet_name</span><span class="p">,</span> <span class="n">item_name</span><span class="p">,</span> <span class="n">value_type</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></figure>

<p>We’re extending the closest widget that Qt offers to what we’re trying to achieve. In this case it’s pretty obvious but you can get documentation on <a href="http://doc.qt.io/qt-4.8/classes.html">all the Qt classes</a>. In many cases it might be easier to extend an existing <a href="https://github.com/BallAerospace/COSMOS/tree/master/lib/cosmos/tools/tlm_viewer/widgets">COSMOS widget</a>.</p>

<p>Note that our initialize method takes the parent_layout as the first value. All COSMOS widgets make the first parameter the parent_layout so they can be added. The next four paramaters are typically the target_name, packet_name, item_name and value_type. Additional parameters can follow the value_type parameter. The first thing we do in the initialize method is call super which calls the Widget initialize method. If you run this code you should see that the screen displays but doesn’t look any different. That’s because we haven’t actually added our new widget to the parent_layout. Before adding widgets to the layout you typically want to configure them. For our table, we need to set the number of rows and columns. First I grab the telemetry value from the server using the <code class="highlighter-rouge">System.telemetry.value</code> method defined in <a href="https://github.com/BallAerospace/COSMOS/blob/master/lib/cosmos/packets/telemetry.rb">telemetry.rb</a>. Since this is an array value I call <code class="highlighter-rouge">length</code> to determine how many rows to display in the table. I then use the Qt methods <code class="highlighter-rouge">setRowCount</code> and <code class="highlighter-rouge">setColumnCount</code> to initialize the table. You can find these methods in the <a href="http://doc.qt.io/qt-4.8/qtablewidget.html">Qt::TableWidget</a> documentation. Finally I call the addWidget method which is a part of all the <a href="http://doc.qt.io/qt-4.8/qlayout.html">Qt::Layout</a> classes.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby">    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">parent_layout</span><span class="p">,</span> <span class="n">target_name</span><span class="p">,</span> <span class="n">packet_name</span><span class="p">,</span> <span class="n">item_name</span><span class="p">,</span> <span class="n">value_type</span> <span class="o">=</span> <span class="ss">:WITH_UNITS</span><span class="p">)</span>
      <span class="k">super</span><span class="p">(</span><span class="n">target_name</span><span class="p">,</span> <span class="n">packet_name</span><span class="p">,</span> <span class="n">item_name</span><span class="p">,</span> <span class="n">value_type</span><span class="p">)</span>
      <span class="n">value</span> <span class="o">=</span> <span class="no">System</span><span class="p">.</span><span class="nf">telemetry</span><span class="p">.</span><span class="nf">value</span><span class="p">(</span><span class="n">target_name</span><span class="p">,</span> <span class="n">packet_name</span><span class="p">,</span> <span class="n">item_name</span><span class="p">)</span> <span class="c1"># Get the value</span>
      <span class="vi">@rows</span> <span class="o">=</span> <span class="n">value</span><span class="p">.</span><span class="nf">length</span> <span class="c1"># Store the rows</span>
      <span class="n">setRowCount</span><span class="p">(</span><span class="vi">@rows</span><span class="p">)</span>
      <span class="n">setColumnCount</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
      <span class="n">parent_layout</span><span class="p">.</span><span class="nf">addWidget</span><span class="p">(</span><span class="nb">self</span><span class="p">)</span> <span class="k">if</span> <span class="n">parent_layout</span>
    <span class="k">end</span></code></pre></figure>

<p>Now if you stop and restart the Telemetry Viewer (so it can re-require the new widget code) it should display an empty table:</p>

<p><img src="/img/2016_08_22_inst_array2.png" alt="COSMOS Inst Array" /></p>

<p>To actually populate it with data we must follow the Cosmos Widget conventions. First of all by including Widget you include all the <a href="https://github.com/BallAerospace/COSMOS/blob/master/lib/cosmos/tools/tlm_viewer/widgets/widget.rb">Widget</a> code which creates two key class methods: <code class="highlighter-rouge">layout_manager?</code> and <code class="highlighter-rouge">takes_value?</code>. These must be overridden to return true if your widget is either a layout or takes a value respectively. Since our widget will be taking the array data as a value we must override <code class="highlighter-rouge">takes_value?</code>:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="nb">require</span> <span class="s1">'cosmos/tools/tlm_viewer/widgets/widget'</span>

<span class="k">module</span> <span class="nn">Cosmos</span>
  <span class="k">class</span> <span class="nc">DemotableWidget</span> <span class="o">&lt;</span> <span class="no">Qt</span><span class="o">::</span><span class="no">TableWidget</span>
    <span class="kp">include</span> <span class="no">Widget</span>

    <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">takes_value?</span>
      <span class="k">return</span> <span class="kp">true</span>
    <span class="k">end</span></code></pre></figure>

<p>Typically class methods are defined at the top of the source file and begin with self. You can also type out the class name but this is less robust as changing the class name requires changing the method name. Implementing this class method allows Telemetry Viewer to call the <code class="highlighter-rouge">value=(data)</code> method with new telemetry data. The value method implementation should look like this:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby">    <span class="k">def</span> <span class="nf">value</span><span class="o">=</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
      <span class="p">(</span><span class="mi">0</span><span class="o">...</span><span class="vi">@rows</span><span class="p">).</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">row</span><span class="o">|</span> <span class="c1"># Note the extra 'dot' which means up to but not including</span>
        <span class="n">setItem</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="no">Qt</span><span class="o">::</span><span class="no">TableWidgetItem</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">row</span><span class="p">].</span><span class="nf">to_s</span><span class="p">))</span>
      <span class="k">end</span>
    <span class="k">end</span></code></pre></figure>

<p>The data value passed to the method is the same target, packet, and item used in the screen definition. In our value= method we are using our stored instance variable <code class="highlighter-rouge">@rows</code> to index into the array data and create new <a href="http://doc.qt.io/qt-4.8/qtablewidgetitem.html">Qt::TableWidgetItem</a> instances to store the data. TableWidgetItems expect Strings to be passed so I call to_s on the data item to ensure it is a String. If you now re-launch Telemetry Viewer you should see the values populated in the table:</p>

<p><img src="/img/2016_08_22_inst_array3.png" alt="COSMOS Inst Array" /></p>

<p>At this point you could be done. But wait! The Array widget below the table fades darker to implement “aging”, showing the user the values haven’t changed. How do we implement “aging” in our new widget? To start we require the aging_widget and include the AgingWidget module. Then we must call the setup_aging method in our initialize method as well as redefine the process_settings method:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="nb">require</span> <span class="s1">'cosmos/tools/tlm_viewer/widgets/widget'</span>
<span class="nb">require</span> <span class="s1">'cosmos/tools/tlm_viewer/widgets/aging_widget'</span>

<span class="k">module</span> <span class="nn">Cosmos</span>
  <span class="k">class</span> <span class="nc">DemotableWidget</span> <span class="o">&lt;</span> <span class="no">Qt</span><span class="o">::</span><span class="no">TableWidget</span>
    <span class="kp">include</span> <span class="no">Widget</span>
    <span class="kp">include</span> <span class="no">AgingWidget</span>

    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">parent_layout</span><span class="p">,</span> <span class="n">target_name</span><span class="p">,</span> <span class="n">packet_name</span><span class="p">,</span> <span class="n">item_name</span><span class="p">,</span> <span class="n">value_type</span> <span class="o">=</span> <span class="ss">:WITH_UNITS</span><span class="p">)</span>
      <span class="k">super</span><span class="p">(</span><span class="n">target_name</span><span class="p">,</span> <span class="n">packet_name</span><span class="p">,</span> <span class="n">item_name</span><span class="p">,</span> <span class="n">value_type</span><span class="p">)</span>
      <span class="n">setup_aging</span><span class="p">()</span>
      <span class="n">value</span> <span class="o">=</span> <span class="no">System</span><span class="p">.</span><span class="nf">telemetry</span><span class="p">.</span><span class="nf">value</span><span class="p">(</span><span class="n">target_name</span><span class="p">,</span> <span class="n">packet_name</span><span class="p">,</span> <span class="n">item_name</span><span class="p">)</span> <span class="c1"># Get the value</span>
      <span class="vi">@rows</span> <span class="o">=</span> <span class="n">value</span><span class="p">.</span><span class="nf">length</span> <span class="c1"># Store the rows</span>
      <span class="n">setRowCount</span><span class="p">(</span><span class="vi">@rows</span><span class="p">)</span>
      <span class="n">setColumnCount</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
      <span class="n">parent_layout</span><span class="p">.</span><span class="nf">addWidget</span><span class="p">(</span><span class="nb">self</span><span class="p">)</span> <span class="k">if</span> <span class="n">parent_layout</span>
    <span class="k">end</span>

    <span class="k">def</span> <span class="nf">process_settings</span>
      <span class="k">super</span>
      <span class="n">process_aging_settings</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></figure>

<p>Note that we were able to remove the class method <code class="highlighter-rouge">self.takes_value?</code> because AgingWidget already implements it. This is all required to setup aging but we must still modify the value= method to do the work. First in value= we call super to call the AgingWidget’s value= method. This method returns a string representation of the data with the correct foreground color and text character indicating the color, e.g. G=Green, Y=Yellow, R=Red. This is important for values with limits settings but since our array value doesn’t have limits I’m going to igore the return value and simply allow the aging routine to age the data. Interally this updates the <code class="highlighter-rouge">@background</code> instance variable with the current ‘aged’ background color. I then set the TableWidgetItem’s background color to this color before adding it to the table:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby">    <span class="k">def</span> <span class="nf">value</span><span class="o">=</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
      <span class="k">super</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
      <span class="p">(</span><span class="mi">0</span><span class="o">...</span><span class="vi">@rows</span><span class="p">).</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">row</span><span class="o">|</span>
        <span class="n">item</span> <span class="o">=</span> <span class="no">Qt</span><span class="o">::</span><span class="no">TableWidgetItem</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">row</span><span class="p">])</span>
        <span class="n">item</span><span class="p">.</span><span class="nf">setBackgroundColor</span><span class="p">(</span><span class="vi">@background</span><span class="p">)</span>
        <span class="n">setItem</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
      <span class="k">end</span>
    <span class="k">end</span></code></pre></figure>

<p>The end result is aging:</p>

<p><img src="/img/2016_08_22_inst_array4.png" alt="COSMOS Inst Array" /></p>

<p>Note that if you have a widget that implements aging and limits you’ll want to keep the value returned by super and use it in your widget. If you don’t want the aging routine to directly use your data value you can pass a string as the second parameter, e.g. super(data, text). This text string will be modified with the color blind settings. Basically that means that whatever the calculated <code class="highlighter-rouge">@foreground</code> color string is, a corresponding text character is added (R=Red, G=Green, etc) to aid people who can’t distinguish colors. See <a href="https://github.com/BallAerospace/COSMOS/blob/master/lib/cosmos/tools/tlm_viewer/widgets/aging_widget.rb">aging_widget.rb</a> for more details.</p>

<p>If you have a question which would benefit the community or find a possible bug please use our <a href="https://github.com/BallAerospace/COSMOS/issues">Github Issues</a>. If you would like more information about a COSMOS training or support contract please contact us at <a href="mailto:cosmos@ball.com">cosmos@ball.com</a>.</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2016/08/04/custom-cosmos_interface/">
      Custom COSMOS Interface
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      post
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      04 Aug 2016
    </span>
    <a href="https://github.com/jmthomas" class="post-author">
      <img src="https://github.com/jmthomas.png" class="avatar" alt="jmthomas avatar" width="24" height="24">
      jmthomas
    </a>
  </div>
  <div class="post-content">
    <div class="note warning">
  <h5>Interfaces were changed dramatically in <a href="/news/2017/08/04/cosmos-4-0-0-released/">COSMOS 4.0.0</a></h5>
  <p>This article only applies to pre-4.0.0 COSMOS releases. For current COSMOS releases please see the new <a href="/docs/interfaces/">Interface</a> and <a href="/docs/protocols/">Protocol</a> documentation.</p>
</div>

<p>One of our Ball Aerospace engineers asked how they could add a checksum to an existing COSMOS interface when talking to their target. COSMOS does not support this directly so it requires creating a custom interface. While this might sound daunting, the COSMOS interfaces were designed just for this type of extension and provide hooks for customization.</p>

<p>In this example we will assume the original interface is the COSMOS <a href="/docs/interfaces/#serial-interface">Serial Interface</a>. In your target’s lib folder create a new interface called checksum_serial_interface.rb:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="nb">require</span> <span class="s1">'cosmos'</span> <span class="c1"># always require cosmos</span>
<span class="nb">require</span> <span class="s1">'cosmos/interfaces/serial_interface'</span> <span class="c1"># original interface being extended</span>

<span class="k">module</span> <span class="nn">Cosmos</span>
<span class="k">class</span> <span class="nc">ChecksumSerialInterface</span> <span class="o">&lt;</span> <span class="no">SerialInterface</span>
  <span class="k">def</span> <span class="nf">pre_write_packet</span><span class="p">(</span><span class="n">packet</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">packet</span><span class="p">.</span><span class="nf">buffer</span>
    <span class="n">checksum</span> <span class="o">=</span> <span class="mh">0xFFFF</span>
    <span class="n">data</span><span class="p">.</span><span class="nf">each_byte</span> <span class="p">{</span><span class="o">|</span><span class="n">x</span><span class="o">|</span> <span class="n">checksum</span> <span class="o">+=</span> <span class="n">x</span> <span class="p">}</span>
    <span class="n">checksum</span> <span class="o">&amp;=</span> <span class="mh">0xFFFF</span>
    <span class="n">data</span> <span class="o">&lt;&lt;</span> <span class="p">[</span><span class="n">checksum</span><span class="p">].</span><span class="nf">pack</span><span class="p">(</span><span class="s2">"n"</span><span class="p">)</span> <span class="c1"># Pack as 16 bit unsigned bit endian</span>
    <span class="k">return</span> <span class="n">data</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">post_read_data</span><span class="p">(</span><span class="n">packet_data</span><span class="p">)</span>
    <span class="n">len</span> <span class="o">=</span> <span class="n">packet_data</span><span class="p">.</span><span class="nf">length</span>
    <span class="n">calc_checksum</span> <span class="o">=</span> <span class="mh">0xFFFF</span>
    <span class="n">packet_data</span><span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="p">(</span><span class="n">len</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)].</span><span class="nf">each_byte</span> <span class="p">{</span><span class="o">|</span><span class="n">x</span><span class="o">|</span> <span class="n">calc_checksum</span> <span class="o">+=</span> <span class="n">x</span> <span class="p">}</span>
    <span class="n">calc_checksum</span> <span class="o">&amp;=</span> <span class="mh">0xFFFF</span>
    <span class="n">rx_checksum</span> <span class="o">=</span> <span class="n">packet_data</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="o">..-</span><span class="mi">1</span><span class="p">].</span><span class="nf">unpack</span><span class="p">(</span><span class="s2">"n"</span><span class="p">)</span> <span class="c1"># Unpack as 16 bit unsigned big endian</span>
    <span class="k">if</span> <span class="n">calc_checksum</span> <span class="o">==</span> <span class="n">rx_checksum</span>
      <span class="k">return</span> <span class="n">packet_data</span>
    <span class="k">else</span>
      <span class="nb">puts</span> <span class="s2">"Bad checksum detected. Calculated: 0x</span><span class="si">#{</span><span class="n">calc_checksum</span><span class="p">.</span><span class="nf">to_s</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="si">}</span><span class="s2"> Received: 0x</span><span class="si">#{</span><span class="n">rx_checksum</span><span class="p">.</span><span class="nf">to_s</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="si">}</span><span class="s2">. Dropping packet."</span>
      <span class="k">return</span> <span class="s2">""</span> <span class="c1"># Also can return nil to break the connection and reconnect to the target</span>
    <span class="k">end</span>
  <span class="k">end</span>

<span class="k">end</span>
<span class="k">end</span></code></pre></figure>

<p>What we’re doing is overriding pre_write_packet in StreamInterface to allow us to modify the data before it is written to the packet and sent over the interface. We also override post_read_data to operate on data received before it is sent back to the COSMOS server and thus the tools. Note there is also a post_read_packet(packet) method which is called after post_read_data is called and after the COSMOS Packet has been created. All Interfaces inheriting from StreamInterface includes these callback methods, including SerialInterface, TcpipServerInterface, and TcpipClientInterface. Note that UdpInterface inherits directly from Interface and thus does NOT include these callbacks.</p>

<p>Then in your cmd_tlm_server.txt file for your target you use your new interface:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#         interface name  file name                    write read baud   parity stop timeouts stream
INTERFACE UART_INTERFACE  checksum_serial_interface.rb COM1  COM1 115200 NONE   1    nil nil  BURST
</code></pre></div></div>

<p>I added a comment line above the definition which describes the settings. For more information see the <a href="/docs/interfaces/#serial-interface">Serial Interface</a> documentation.</p>

<p>This same technique can obviously be used to extend the the other TCPIP interfaces and can be used with all the various <a href="/docs/interfaces/#streams">Streams</a> COSMOS defines.</p>

<p>If you have a question which would benefit the community or find a possible bug please use our <a href="https://github.com/BallAerospace/COSMOS/issues">Github Issues</a>. If you would like more information about a COSMOS training or support contract please contact us at <a href="mailto:cosmos@ball.com">cosmos@ball.com</a>.</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2016/07/06/cosmos-cmd-tlm-names/">
      COSMOS Cmd/Tlm Naming
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      post
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      06 Jul 2016
    </span>
    <a href="https://github.com/jmthomas" class="post-author">
      <img src="https://github.com/jmthomas.png" class="avatar" alt="jmthomas avatar" width="24" height="24">
      jmthomas
    </a>
  </div>
  <div class="post-content">
    <p>Recently a user asked if they could add exclamation points and question marks to their command and telemetry items. Absolutely!  COSMOS provides great flexibility in command and telemetry naming conventions. (See <a href="http://cosmosrb.com/docs/command">Command</a>). For example, adding an exclamation point to a command to denote a more severe version of the same command:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>COMMAND TGT ABORT BIG_ENDIAN "Tries to abort a collect on the instrument"
COMMAND TGT ABORT! BIG_ENDIAN "Force aborts a collect on the instrument"
</code></pre></div></div>

<p>While it doesn’t make sense to define a command with a question mark, it works well with telemetry points. For example, there is a telemetry point which indicates whether a mechanism is deployed or not. It is an analog value that indicates deployed if the value is above zero. To view both the raw value and the deployed status, define a derived telemetry point which indicates a TRUE or FALSE status:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>APPEND_ITEM DEPLOYED 16 UINT "Deployed raw value"
ITEM DEPLOYED? 0 0 DERIVED "Deployed status"
  STATE FALSE 0
  STATE TRUE 1
  GENERIC_READ_CONVERSION_START UINT 8
    myself.read('DEPLOYED') &gt; 0 ? 1 : 0
  GENERIC_READ_CONVERSION_END
</code></pre></div></div>

<p>Note that this is probably overkill in this case because the conversion could just as easily be applied directly to the item. The raw value could then be obtained by calling tlm_raw(“TGT PKT DEPLOYED”) (see <a href="http://cosmosrb.com/docs/scripting/#tlmraw">tlm_raw</a>).</p>

<p>These practices are similar to the Ruby convention of using methods with an exclamation point (bang) to indicate a dangerous method which typically directly modifies its caller. Ruby also has a convention of methods with question marks returning a boolean true or false value. Read more in the <a href="http://docs.ruby-lang.org/en/trunk/syntax/methods_rdoc.html">Ruby documentation</a>.</p>


  </div>
</article>


  <article>
  <h2>
    <a href="/news/2016/07/05/cosmos-3-8-2-released/">
      Ball Aerospace COSMOS 3.8.2 Released
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      release
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      05 Jul 2016
    </span>
    <a href="https://github.com/jmthomas" class="post-author">
      <img src="https://github.com/jmthomas.png" class="avatar" alt="jmthomas avatar" width="24" height="24">
      jmthomas
    </a>
  </div>
  <div class="post-content">
    <h3 id="new-features">New Features:</h3>

<h3 id="maintenance">Maintenance:</h3>

<ul>
  <li>COSMOS Downloads graph rake task updates</li>
</ul>

<h3 id="bug-fixes">Bug Fixes:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/303">#303</a> Need to clear read conversion cache on Packet#clone</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/304">#304</a> Win32 Serial Driver clean disconnect</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/309">#309</a> Fix Script Runner insert_return when not running</li>
</ul>

<h3 id="migration-notes-from-cosmos-37x">Migration Notes from COSMOS 3.7.x:</h3>
<p>None</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2016/05/12/cosmos-3-8-1-released/">
      Ball Aerospace COSMOS 3.8.1 Released
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      release
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      12 May 2016
    </span>
    <a href="https://github.com/ryanmelt" class="post-author">
      <img src="https://github.com/ryanmelt.png" class="avatar" alt="ryanmelt avatar" width="24" height="24">
      ryanmelt
    </a>
  </div>
  <div class="post-content">
    <h3 id="new-features">New Features:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/184">#184</a> Limits Monitor show green for blue limits items</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/190">#190</a> Simpler MIN MAX syntax for command definitions</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/254">#254</a> Get buffer from commands</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/259">#259</a> Proper support for user selected text editor on linux</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/262">#262</a> PackerViewer option for listing derived items last</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/271">#271</a> Time.formatted option for no microseconds</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/288">#288</a> check_tolerance should enforce a positive tolerance</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/301">#301</a> Update use of COSMOS_DEVEL</li>
</ul>

<h3 id="maintenance">Maintenance:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/268">#268</a> xtce_converter doesn’t support byte order list</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/277">#277</a> Test Runner support for Script Runner options</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/285">#285</a> xtce converter doesn’t support LocationInContainerInBits</li>
</ul>

<h3 id="bug-fixes">Bug Fixes:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/256">#256</a> Defining initialize method in Cosmos::Test class breaks the class when using Test Selection in TestRunner</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/273">#273</a> Wrap Qt::Application.instance in main_thread</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/287">#287</a> Installer issue on newer versions of Ubuntu and Debian related to libssl</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/293">#293</a> Units applied after a read_conversion that returns a string modifies cached conversion value</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/294">#294</a> String#convert_to_value should always just return the starting string if the conversion fails</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/298">#298</a> COSMOS IoMultiplexer breaks gems that invoke stream operator on STDOUT/ERR</li>
</ul>

<h3 id="migration-notes-from-cosmos-37x">Migration Notes from COSMOS 3.7.x:</h3>
<p>None</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2016/03/03/sparkfun/">
      Sparkfun Blog Post
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      post
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      03 Mar 2016
    </span>
    <a href="https://github.com/jmthomas" class="post-author">
      <img src="https://github.com/jmthomas.png" class="avatar" alt="jmthomas avatar" width="24" height="24">
      jmthomas
    </a>
  </div>
  <div class="post-content">
    <p>Ball Aerospace COSMOS has been featured in a blog post on <a href="https://www.sparkfun.com/news/2022">SparkFun</a>. SparkFun is an online retail store that sells electronics primarily for hobbyists. Ball recently purchased a Raspberry Pi, Arduino, and various other parts to interface to COSMOS. We think hobbyists will find COSMOS a great way to interface to their embedded projects and SparkFun agrees! <a href="http://cosmosrb.com/docs/installation">Get started</a> with COSMOS now!</p>

<p>A Ball engineer wrote a <a href="https://bitbucket.org/dholshouser/alagna/wiki/HowTo">Wiki</a> on how he configured COSMOS to talk to his Arduino Uno. It’s a little old but it gives a nice step by step tutorial on how to use COSMOS with an Arduino.</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2016/02/27/xtce-support/">
      XTCE Support
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      post
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      27 Feb 2016
    </span>
    <a href="https://github.com/ryanmelt" class="post-author">
      <img src="https://github.com/ryanmelt.png" class="avatar" alt="ryanmelt avatar" width="24" height="24">
      ryanmelt
    </a>
  </div>
  <div class="post-content">
    <p>Ball Aerospace COSMOS now has support for the <a href="http://www.omg.org/space/xtce/" target="_blank">XTCE Command and Telemetry Definition Standard</a>. This is an open standard designed to allow command and telemetry definitions to be transferred between different ground systems. COSMOS can run directly using the .xtce files, or can convert them into the COSMOS configuration file format.</p>

<p>See the docs for more information: <a href="/docs/xtce">XTCE Support</a></p>


  </div>
</article>


  <article>
  <h2>
    <a href="/news/2016/02/27/fukuoka-award/">
      Fukuoka Special Award Winner
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      post
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      27 Feb 2016
    </span>
    <a href="https://github.com/ryanmelt" class="post-author">
      <img src="https://github.com/ryanmelt.png" class="avatar" alt="ryanmelt avatar" width="24" height="24">
      ryanmelt
    </a>
  </div>
  <div class="post-content">
    <p>Ball Aerospace COSMOS has been honored by the Ruby community by receiving one of the three Fukuoka Special Awards handed out this year! This is a great honor with the contest judging being led by Matz himself (the creator of the Ruby programming language).  Read more on the MyFukuoka website here: <a href="http://myfukuoka.com/events/2016-fukuoka-ruby-award-winners/" target="_blank">MyFukuoka 2016 Ruby Award Winners</a></p>


  </div>
</article>


  <article>
  <h2>
    <a href="/news/2016/02/26/cosmos-3-8-0-released/">
      Ball Aerospace COSMOS 3.8.0 Released
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      release
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      26 Feb 2016
    </span>
    <a href="https://github.com/ryanmelt" class="post-author">
      <img src="https://github.com/ryanmelt.png" class="avatar" alt="ryanmelt avatar" width="24" height="24">
      ryanmelt
    </a>
  </div>
  <div class="post-content">
    <p>With this release COSMOS now has initial support for the XTCE Command and Telemetry Definition standard.</p>

<h3 id="new-features">New Features:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/251">#251</a> Create COSMOS XTCE Converter</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/252">#252</a> Add polling rate command line option to PacketViewer</li>
</ul>

<h3 id="bug-fixes">Bug Fixes:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/245">#245</a> TlmGrapher Crashes on Inf</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/248">#248</a> Can’t script commands containing ‘with’ in the name</li>
</ul>

<h3 id="migration-notes-from-cosmos-37x">Migration Notes from COSMOS 3.7.x:</h3>
<p>None</p>


  </div>
</article>


  <article>
  <h2>
    <a href="/news/2016/02/11/simulated-target/">
      COSMOS Simulated Target
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      post
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      11 Feb 2016
    </span>
    <a href="https://github.com/jmthomas" class="post-author">
      <img src="https://github.com/jmthomas.png" class="avatar" alt="jmthomas avatar" width="24" height="24">
      jmthomas
    </a>
  </div>
  <div class="post-content">
    <h2 id="creating-a-cosmos-simulated-target">Creating a COSMOS Simulated Target</h2>

<p>Sometimes you have a need to create a simulated target in COSMOS. This simulated target is not a physical target producing data and accepting commands but a software target which generates data and sends it to COSMOS. This is exactly how the COSMOS Demo operates within the INST target that it creates. While this is a very full featured example its complexity can be a little overwhelming. In this post I’m going to break down a much simpler simulated target so you can create your own.</p>

<p>First of all create a new COSMOS target directory in config/targets. I called mine INST (instrument) to match the COSMOS demo. Create the ‘cmd_tlm’ and ‘lib’ subdirectories. For my demo I created a simple ‘cmd.txt’ file which contains a single command:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>COMMAND INST SET_STATUS BIG_ENDIAN "Set status"
  APPEND_PARAMETER STATUS 0 STRING "STATUS" "Status"
    STATE "OK" "OK"
    STATE "ERROR" "ERROR"
</code></pre></div></div>

<p>I created a ‘tlm.txt’ file which contains two different telemetry packets:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>TELEMETRY INST STATUS BIG_ENDIAN "Status from the instrument"
  APPEND_ID_ITEM ID 16 UINT 1 "Packet ID"
  APPEND_ITEM COUNTER 16 UINT "Packet counter"
  APPEND_ITEM STATUS 0 STRING "Most recent ASCIICMD string"
    STATE "OK" "OK"
    STATE "ERROR" "ERROR"

TELEMETRY INST DATA BIG_ENDIAN "Data from the instrument"
  APPEND_ID_ITEM ID 16 UINT 2 "Packet ID"
  APPEND_ITEM COUNTER 16 UINT "Packet counter"
  APPEND_ITEM TIMESEC 32 UINT "Seconds since epoch (January 1st, 1970, midnight)"
  APPEND_ITEM TIMEUS  32 UINT "Microseconds of second"
  APPEND_ITEM TEMP1 32 INT "Temperature #1"
    UNITS CELSIUS C
    FORMAT_STRING "%0.3f"
    LIMITS DEFAULT 1 ENABLED -80.0 -70.0 60.0 80.0 -20.0 20.0
</code></pre></div></div>

<p>The cmd_tlm_server.txt file is very simple:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>INTERFACE INST_INT simulated_target_interface.rb sim_inst.rb
  TARGET INST
</code></pre></div></div>

<p>The real work is in implementing how your simulated target is going to behave. This is done in the lib/sim_inst.rb file. Note that whatever you name your simulated target file must match the last parameter of the INTERFACE in the cmd_tlm_server.rb as shown above.</p>

<p>I’ll break down my sim_inst.rb piece by piece and then list it in its entirety. First you must inherit from the Cosmos::SimulatedTarget.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">require</span> <span class="s1">'cosmos'</span>
<span class="k">module</span> <span class="nn">Cosmos</span>
  <span class="k">class</span> <span class="nc">SimInst</span> <span class="o">&lt;</span> <span class="no">SimulatedTarget</span>
</code></pre></div></div>

<p>Next you can initialize any of your packets in the initialize method. This is entirely optional but I show how to use the <code class="highlighter-rouge">@tlm_packets</code> hash to access all the defined packets. This hash is created automatically by the SimulatedTarget based on all the packets you have defined in your cmd_tlm/tlm.txt file. Note that there is NOT a corresponding <code class="highlighter-rouge">@cmd_packets</code>.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">target_name</span><span class="p">)</span>
  <span class="k">super</span><span class="p">(</span><span class="n">target_name</span><span class="p">)</span>

  <span class="c1"># We grab the STATUS packet to set initial values</span>
  <span class="n">packet</span> <span class="o">=</span> <span class="vi">@tlm_packets</span><span class="p">[</span><span class="s1">'STATUS'</span><span class="p">]</span>
  <span class="n">packet</span><span class="p">.</span><span class="nf">enable_method_missing</span> <span class="c1"># required to use packet.&lt;item&gt; = value</span>
  <span class="n">packet</span><span class="p">.</span><span class="nf">status</span> <span class="o">=</span> <span class="s2">"NONE"</span>
<span class="k">end</span>
</code></pre></div></div>

<p>We then have to configure the telemetry packet rates of our target. That is, how fast do the packets get sent out. This is handled by implementing the <code class="highlighter-rouge">set_rates</code> method and by calling <code class="highlighter-rouge">set_rate</code> for each packet defined in your system. If you do not call <code class="highlighter-rouge">set_rate</code> the packet will not be send out periodically (which may be desirable for event based packets).</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">set_rates</span>
  <span class="c1"># The SimulatedTarget operates on a 101Hz clock</span>
  <span class="c1"># Thus the rates are determined by dividing this rate</span>
  <span class="c1"># by the set rate to get the output rate of the packet</span>
  <span class="n">set_rate</span><span class="p">(</span><span class="s1">'STATUS'</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="c1"># 100 / 100 = 1Hz</span>
  <span class="n">set_rate</span><span class="p">(</span><span class="s1">'DATA'</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="c1"># 100 / 10 = 10Hz</span>
<span class="k">end</span>
</code></pre></div></div>

<p>If your target will accept command you need to implemented the <code class="highlighter-rouge">write(packet)</code> method. My write method is simple in that I only have a single command that directly sets a value in one of my telemetry packets.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="n">packet</span><span class="p">)</span>
  <span class="c1"># We directly set the telemetry value from the only command</span>
  <span class="c1"># If you have more than one command you'll need to switch</span>
  <span class="c1"># on the packet.packet_name to determine what command it is</span>
  <span class="vi">@tlm_packets</span><span class="p">[</span><span class="s1">'STATUS'</span><span class="p">].</span><span class="nf">status</span> <span class="o">=</span> <span class="n">packet</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="s2">"status"</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Your target must implement the <code class="highlighter-rouge">read(count_100hz, time)</code> method to return telemetry packets back to COSMOS. You’ll call the <code class="highlighter-rouge">get_pending_packets(count_100hz)</code> method implemented by SimulatedTarget and then perform whatever operations you want on the packets before returning the array of packets back to COSMOS. Note my use of the <code class="highlighter-rouge">cycle_tlm_item</code> method to automatically cycle the telemetry item as each packet is sent out. This is used heavily in the COSMOS Demo.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="n">count_100hz</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span>
  <span class="c1"># The SimulatedTarget implements get_pending_packets to return</span>
  <span class="c1"># packets at the correct time interval based on their rates</span>
  <span class="n">pending_packets</span> <span class="o">=</span> <span class="n">get_pending_packets</span><span class="p">(</span><span class="n">count_100hz</span><span class="p">)</span>

  <span class="n">pending_packets</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">packet</span><span class="o">|</span>
    <span class="k">case</span> <span class="n">packet</span><span class="p">.</span><span class="nf">packet_name</span>
    <span class="k">when</span> <span class="s1">'STATUS'</span>
      <span class="n">packet</span><span class="p">.</span><span class="nf">counter</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">when</span> <span class="s1">'DATA'</span>
      <span class="c1"># This method in SimulatedTarget cycles the specified telemetry</span>
      <span class="c1"># point between the two given values by the given increment for</span>
      <span class="c1"># each packet sent out.</span>
      <span class="n">cycle_tlm_item</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span> <span class="s1">'temp1'</span><span class="p">,</span> <span class="o">-</span><span class="mf">95.0</span><span class="p">,</span> <span class="mf">95.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

      <span class="n">packet</span><span class="p">.</span><span class="nf">timesec</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">tv_sec</span>
      <span class="n">packet</span><span class="p">.</span><span class="nf">timeus</span>  <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">tv_usec</span>
      <span class="n">packet</span><span class="p">.</span><span class="nf">counter</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">end</span>
  <span class="k">end</span>
  <span class="n">pending_packets</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Hopefully that a little easier to understand than the full <a href="https://github.com/BallAerospace/COSMOS/tree/master/demo">COSMOS Demo</a> which has much more complex command and telemetry definitions and simulated targets in order to better exercise the various COSMOS tools. While there are other ways to simulate COSMOS targets they can get you into trouble if you’re not careful about properly cloning packets sending back updated data. Additionally, using the SimulatedTargetInterface in your Interface makes it very clear to other developers that this target is indeed simulated.</p>

<p>Without further ado, here is my sim_inst.rb in its entirety:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">require</span> <span class="s1">'cosmos'</span>
<span class="k">module</span> <span class="nn">Cosmos</span>
  <span class="k">class</span> <span class="nc">SimInst</span> <span class="o">&lt;</span> <span class="no">SimulatedTarget</span>
    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">target_name</span><span class="p">)</span>
      <span class="k">super</span><span class="p">(</span><span class="n">target_name</span><span class="p">)</span>

      <span class="c1"># We grab the STATUS packet to set initial values</span>
      <span class="n">packet</span> <span class="o">=</span> <span class="vi">@tlm_packets</span><span class="p">[</span><span class="s1">'STATUS'</span><span class="p">]</span>
      <span class="n">packet</span><span class="p">.</span><span class="nf">enable_method_missing</span> <span class="c1"># required to use packet.&lt;item&gt; = value</span>
      <span class="n">packet</span><span class="p">.</span><span class="nf">status</span> <span class="o">=</span> <span class="s2">"NONE"</span>
    <span class="k">end</span>

    <span class="k">def</span> <span class="nf">set_rates</span>
      <span class="c1"># The SimulatedTarget operates on a 100Hz clock</span>
      <span class="c1"># Thus the rates are determined by dividing this rate</span>
      <span class="c1"># by the set rate to get the output rate of the packet</span>
      <span class="n">set_rate</span><span class="p">(</span><span class="s1">'STATUS'</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="c1"># 100 / 100 = 1Hz</span>
      <span class="n">set_rate</span><span class="p">(</span><span class="s1">'DATA'</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="c1"># 100 / 10 = 10Hz</span>
    <span class="k">end</span>

    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="n">packet</span><span class="p">)</span>
      <span class="c1"># We directly set the telemetry value from the only command</span>
      <span class="c1"># If you have more than one command you'll need to switch</span>
      <span class="c1"># on the packet.packet_name to determine what command it is</span>
      <span class="vi">@tlm_packets</span><span class="p">[</span><span class="s1">'STATUS'</span><span class="p">].</span><span class="nf">status</span> <span class="o">=</span> <span class="n">packet</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="s2">"status"</span><span class="p">)</span>
    <span class="k">end</span>

    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="n">count_100hz</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span>
      <span class="c1"># The SimulatedTarget implements get_pending_packets to return</span>
      <span class="c1"># packets at the correct time interval based on their rates</span>
      <span class="n">pending_packets</span> <span class="o">=</span> <span class="n">get_pending_packets</span><span class="p">(</span><span class="n">count_100hz</span><span class="p">)</span>

      <span class="n">pending_packets</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">packet</span><span class="o">|</span>
        <span class="k">case</span> <span class="n">packet</span><span class="p">.</span><span class="nf">packet_name</span>
        <span class="k">when</span> <span class="s1">'STATUS'</span>
          <span class="n">packet</span><span class="p">.</span><span class="nf">counter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">when</span> <span class="s1">'DATA'</span>
          <span class="c1"># This method in SimulatedTarget cycles the specified telemetry</span>
          <span class="c1"># point between the two given values by the given increment for</span>
          <span class="c1"># each packet sent out.</span>
          <span class="n">cycle_tlm_item</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span> <span class="s1">'temp1'</span><span class="p">,</span> <span class="o">-</span><span class="mf">95.0</span><span class="p">,</span> <span class="mf">95.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

          <span class="n">packet</span><span class="p">.</span><span class="nf">timesec</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">tv_sec</span>
          <span class="n">packet</span><span class="p">.</span><span class="nf">timeus</span>  <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">tv_usec</span>
          <span class="n">packet</span><span class="p">.</span><span class="nf">counter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">end</span>
      <span class="k">end</span>
      <span class="n">pending_packets</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Happy simulated target programming!</p>

<p>If you have a question which would benefit the community or find a possible bug please use our <a href="https://github.com/BallAerospace/COSMOS/issues">Github Issues</a>. If you would like more information about a COSMOS training or support contract please contact us at <a href="mailto:cosmos@ball.com">cosmos@ball.com</a>.</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2015/12/29/cosmos-3-7-1-released/">
      Ball Aerospace COSMOS 3.7.1 Released
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      release
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      29 Dec 2015
    </span>
    <a href="https://github.com/ryanmelt" class="post-author">
      <img src="https://github.com/ryanmelt.png" class="avatar" alt="ryanmelt avatar" width="24" height="24">
      ryanmelt
    </a>
  </div>
  <div class="post-content">
    <h3 id="bug-fixes">Bug Fixes:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/228">#228</a> Fix typo in udp_interface</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/231">#231</a> MACRO_APPEND with multiple items not working</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/235">#235</a> Improve IntegerChooser and FloatChooser Validation</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/236">#236</a> TestRunner doesn’t support status_bar</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/240">#240</a> Make sure super() is called in all bundled conversion classes</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/241">#241</a> Don’t reformat BLOCK data types with a conversion in Structure#formatted</li>
</ul>

<h3 id="migration-notes-from-cosmos-36x">Migration Notes from COSMOS 3.6.x:</h3>

<ol>
  <li>Background task arguments are now broken out instead of being received as a single array</li>
  <li>udp_interface now takes an optional argument for bind_address</li>
  <li>line_graph_script has been significantly updated to support modifying plots from the script.</li>
</ol>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2015/11/25/cosmos-3-7-0-released/">
      Ball Aerospace COSMOS 3.7.0 Released
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      release
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      25 Nov 2015
    </span>
    <a href="https://github.com/ryanmelt" class="post-author">
      <img src="https://github.com/ryanmelt.png" class="avatar" alt="ryanmelt avatar" width="24" height="24">
      ryanmelt
    </a>
  </div>
  <div class="post-content">
    <h3 id="new-features">New Features:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/213">#213</a> Vertical Limits Bar</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/214">#214</a> TlmGrapher show full date for plotted points</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/219">#219</a> State Color Widget</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/225">#225</a> Set Bind Address in UDP interface</li>
</ul>

<h3 id="maintenance">Maintenance:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/223">#223</a> C Extension Improvements</li>
</ul>

<h3 id="bug-fixes">Bug Fixes:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/199">#199</a> Investigate TlmGrapher Formatted Time Item</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/211">#211</a> Background task with arguments not working</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/217">#217</a> Graph Right Margin Too Small</li>
</ul>

<h3 id="migration-notes-from-cosmos-36x">Migration Notes from COSMOS 3.6.x:</h3>

<ol>
  <li>Background task arguments are now broken out instead of being received as a single array</li>
  <li>udp_interface now takes an optional argument for bind_address</li>
  <li>line_graph_script has been significantly updated to support modifying plots from the script.</li>
</ol>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2015/10/30/cosmos-3-6-3-released/">
      Ball Aerospace COSMOS 3.6.3 Released
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      release
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      30 Oct 2015
    </span>
    <a href="https://github.com/ryanmelt" class="post-author">
      <img src="https://github.com/ryanmelt.png" class="avatar" alt="ryanmelt avatar" width="24" height="24">
      ryanmelt
    </a>
  </div>
  <div class="post-content">
    <h3 id="new-features">New Features:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/200">#200</a> ScriptRunner Find Dialog Does Not Cross Windows</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/201">#201</a> Table Manager to support arbitrary inputs on State Fields</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/209">#209</a> Add UTS Timestamp Flag to TlmGrapher Plots</li>
</ul>

<h3 id="maintenance">Maintenance:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/194">#194</a> Allow up to one minute for TlmViewer to start when calling display() from a script</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/203">#203</a> load_utility should raise LoadError like load and require</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/205">#205</a> Add testing for array and matrix</li>
</ul>

<h3 id="bug-fixes">Bug Fixes:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/191">#191</a> Installing COSMOS Issue on Windows 7</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/193">#193</a> Fix ask() on linux and qt 4.6.2</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/197">#197</a> Improve linc interface</li>
</ul>

<h3 id="migration-notes-from-cosmos-35x">Migration Notes from COSMOS 3.5.x:</h3>

<p>None</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2015/10/28/cosmos-at-ats-conference/">
      COSMOS at the ATS Conference
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      conference
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      28 Oct 2015
    </span>
    <a href="https://github.com/ryanmelt" class="post-author">
      <img src="https://github.com/ryanmelt.png" class="avatar" alt="ryanmelt avatar" width="24" height="24">
      ryanmelt
    </a>
  </div>
  <div class="post-content">
    <p>Ball Aerospace COSMOS is being featured in three papers and presentations at this years <a href="http://www.cvent.com/events/2015-aerospace-testing-seminar-ats-/custom-118-518ccae66e804adb9dac56355e03868b.aspx">Aerospace Testing Seminar (ATS)</a> taking place at the Renaissance Los Angeles Airport Hotel October 27-29, 2015.</p>

<p>The three papers presented are here:</p>

<ul>
  <li><a href="/assets/Ball_Aerospaces_COSMOS_Open_Source_Test_System.pdf">Ball Aerospace’s COSMOS Open Source Test System</a></li>
  <li><a href="/assets/System_Level_Integration_And_Test_Leveraging_Software_Unit_Testing_Techniques.pdf">System Level Integration and Test Leveraging Software Unit Testing Techniques</a></li>
  <li><a href="/assets/The_Hidden_Benefits_of_Automated_Testing.pdf">The Hidden Benefits of Automated Testing</a></li>
</ul>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2015/08/10/cosmos-3-6-2-released/">
      Ball Aerospace COSMOS 3.6.2 Released
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      release
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      10 Aug 2015
    </span>
    <a href="https://github.com/ryanmelt" class="post-author">
      <img src="https://github.com/ryanmelt.png" class="avatar" alt="ryanmelt avatar" width="24" height="24">
      ryanmelt
    </a>
  </div>
  <div class="post-content">
    <p>Huge new feature in this release: All COSMOS configuration files are now interpreted with the ERB preprocessor!  This allows you to use Ruby code within the configuration files to help build them.  You can also render partials of common information such as packet headers so you only have to define them once.  See the INST target in the updated Demo project for examples.</p>

<h3 id="bug-fixes">Bug Fixes:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/187">#187</a> Must require tempfile in config_parser.rb on non-windows systems</li>
</ul>

<h3 id="migration-notes-from-cosmos-35x">Migration Notes from COSMOS 3.5.x:</h3>

<p>None</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2015/08/10/cosmos-3-6-1-released/">
      Ball Aerospace COSMOS 3.6.1 Released
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      release
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      10 Aug 2015
    </span>
    <a href="https://github.com/ryanmelt" class="post-author">
      <img src="https://github.com/ryanmelt.png" class="avatar" alt="ryanmelt avatar" width="24" height="24">
      ryanmelt
    </a>
  </div>
  <div class="post-content">
    <h3 id="bug-fixes">Bug Fixes:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/185">#185</a> target.txt order not being preserved</li>
</ul>

<h3 id="migration-notes-from-cosmos-35x">Migration Notes from COSMOS 3.5.x:</h3>

<p>None</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2015/08/07/cosmos-3-6-0-released/">
      Ball Aerospace COSMOS 3.6.0 Released
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      release
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      07 Aug 2015
    </span>
    <a href="https://github.com/ryanmelt" class="post-author">
      <img src="https://github.com/ryanmelt.png" class="avatar" alt="ryanmelt avatar" width="24" height="24">
      ryanmelt
    </a>
  </div>
  <div class="post-content">
    <p>Huge new feature in this release: All COSMOS configuration files are now interpreted with the ERB preprocessor!  This allows you to use Ruby code within the configuration files to help build them.  You can also render partials of common information such as packet headers so you only have to define them once.  See the INST target in the updated Demo project for examples.</p>

<h3 id="bug-fixes">Bug Fixes:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/168">#168</a> Select unreliably unblocks when closing sockets on linux</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/177">#177</a> MACRO_APPEND in descending order is broken</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/179">#179</a> ScriptRunnerFrame Context Menu Crash</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/182">#182</a> Overriding LOG_WRITERS in cmd_tlm_server.txt can cause issues</li>
</ul>

<h3 id="new-features">New Features:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues170">#170</a> Consider supporting a preprocessor over COSMOS config files</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/171">#171</a> Script Runner should have file open and save GUI dialogs</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/174">#174</a> Add View in Command Sender in Server</li>
</ul>

<h3 id="maintenance">Maintenance:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/80">#80</a> Investigate performance of nonblocking IO without exceptions</li>
</ul>

<h3 id="migration-notes-from-cosmos-35x">Migration Notes from COSMOS 3.5.x:</h3>

<p>None</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2015/07/14/cosmos-3-5-3-released/">
      Ball Aerospace COSMOS 3.5.3 Released
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      release
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      14 Jul 2015
    </span>
    <a href="https://github.com/ryanmelt" class="post-author">
      <img src="https://github.com/ryanmelt.png" class="avatar" alt="ryanmelt avatar" width="24" height="24">
      ryanmelt
    </a>
  </div>
  <div class="post-content">
    <h3 id="bug-fixes">Bug Fixes:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/169">#169</a> Make windows bat files support running outside of the current directory</li>
</ul>

<h3 id="new-features">New Features:</h3>

<ul>
  <li>N/A</li>
</ul>

<h3 id="maintenance">Maintenance:</h3>

<ul>
  <li>N/A</li>
</ul>

<h3 id="migration-notes-from-cosmos-342">Migration Notes from COSMOS 3.4.2:</h3>

<p>The launcher scripts and .bat files that live in the COSMOS project tools folder have been updated to be easier to maintain and to ensure that the user always sees some sort of error message if a problem occurs starting a tool. All users should copy the new files from the tools folder in the COSMOS demo folder into their projects as part of the upgrade to COSMOS 3.5.1</p>

<p>COSMOS now disables reverse DNS lookups by default because they can take a long time in some environments. If you still want to see hostnames when someone connects to a TCP/IP server interface/router then you will need to add ENABLE_DNS to your system.txt file.</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2015/07/14/cosmos-3-5-2-released/">
      Ball Aerospace COSMOS 3.5.2 Released
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      release
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      14 Jul 2015
    </span>
    <a href="https://github.com/ryanmelt" class="post-author">
      <img src="https://github.com/ryanmelt.png" class="avatar" alt="ryanmelt avatar" width="24" height="24">
      ryanmelt
    </a>
  </div>
  <div class="post-content">
    <h3 id="bug-fixes">Bug Fixes:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/167">#167</a> Use updated url for wkhtmltopdf downloads</li>
</ul>

<h3 id="new-features">New Features:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/pull/166">#166</a> Add install script for Ubuntu</li>
</ul>

<h3 id="maintenance">Maintenance:</h3>

<ul>
  <li>N/A</li>
</ul>

<h3 id="migration-notes-from-cosmos-342">Migration Notes from COSMOS 3.4.2:</h3>

<p>The launcher scripts and .bat files that live in the COSMOS project tools folder have been updated to be easier to maintain and to ensure that the user always sees some sort of error message if a problem occurs starting a tool. All users should copy the new files from the tools folder in the COSMOS demo folder into their projects as part of the upgrade to COSMOS 3.5.1</p>

<p>COSMOS now disables reverse DNS lookups by default because they can take a long time in some environments. If you still want to see hostnames when someone connects to a TCP/IP server interface/router then you will need to add ENABLE_DNS to your system.txt file.</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2015/07/08/cosmos-3-5-1-released/">
      Ball Aerospace COSMOS 3.5.1 Released
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      release
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      08 Jul 2015
    </span>
    <a href="https://github.com/jmthomas" class="post-author">
      <img src="https://github.com/jmthomas.png" class="avatar" alt="jmthomas avatar" width="24" height="24">
      jmthomas
    </a>
  </div>
  <div class="post-content">
    <p>This release fixes a bug and completes the installation scripts for linux/mac.</p>

<h3 id="bug-fixes">Bug Fixes:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/pull/165">#165</a> Change launch_tool to tool_launch in Launcher</li>
</ul>

<h3 id="new-features">New Features:</h3>

<ul>
  <li>N/A</li>
</ul>

<h3 id="maintenance">Maintenance:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/102">#102</a> Create Installation Scripts</li>
</ul>

<h3 id="migration-notes-from-cosmos-342">Migration Notes from COSMOS 3.4.2:</h3>

<p>The launcher scripts and .bat files that live in the COSMOS project tools folder have been updated to be easier to maintain and to ensure that the user always sees some sort of error message if a problem occurs starting a tool. All users should copy the new files from the tools folder in the COSMOS demo folder into their projects as part of the upgrade to COSMOS 3.5.1</p>

<p>COSMOS now disables reverse DNS lookups by default because they can take a long time in some environments. If you still want to see hostnames when someone connects to a TCP/IP server interface/router then you will need to add ENABLE_DNS to your system.txt file.</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2015/06/22/cosmos-3-5-0-released/">
      Ball Aerospace COSMOS 3.5.0 Released
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      release
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      22 Jun 2015
    </span>
    <a href="https://github.com/ryanmelt" class="post-author">
      <img src="https://github.com/ryanmelt.png" class="avatar" alt="ryanmelt avatar" width="24" height="24">
      ryanmelt
    </a>
  </div>
  <div class="post-content">
    <p>This release contains a lot of new functionality and a key new feature:  The ability to create new COSMOS targets and tools as reusable gems!  This will hopefully allow the open source community to create sharable configuration for a large amount of hardware and allow for community generated tools to be easily integrated.</p>

<h3 id="bug-fixes">Bug Fixes:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/153">#153</a> set_tlm should support settings strings with spaces using the normal syntax</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/155">#155</a> Default to not performing DNS lookups</li>
</ul>

<h3 id="new-features">New Features:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/25">#25</a> Warn users if reading a packet log uses the latest instead of the version specified in the file header</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/106">#106</a> Allow the server to run headless</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/109">#109</a> Cmd value api</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/129">#129</a> Script Runner doesn’t syntax highlight module namespacing</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/133">#133</a> Add sound to COSMOS alerts</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/138">#138</a> Limits Monitor should show what is stale</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/142">#142</a> Support gem based targets and tools</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/144">#144</a> Never have nothing happen when trying to launch a tool</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/152">#152</a> Provide a method to retrieve current suite/group/case in TestRunner</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/157">#157</a> Launcher support command line options in combobox</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/163">#163</a> Allow message_box to display buttons vertically</li>
</ul>

<h3 id="maintenance">Maintenance:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/131">#131</a> Consolidate Find/Replace logic in the FindReplaceDialog</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/137">#137</a> Improve Server message log performance</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/142">#142</a> Improve Windows Installer bat file</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/146">#146</a> Need support for additional non-standard serial baud rates</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/150">#150</a> Improve Win32 serial driver performance</li>
</ul>

<h3 id="migration-notes-from-cosmos-342">Migration Notes from COSMOS 3.4.2:</h3>

<p>The launcher scripts and .bat files that live in the COSMOS project tools folder have been updated to be easier to maintain and to ensure that the user always sees some sort of error message if a problem occurs starting a tool.  All users should copy the new files from the tools folder in the COSMOS demo folder into their projects as part of the upgrade to COSMOS 3.5.0</p>

<p>COSMOS now disables reverse DNS lookups by default because they can take a long time in some environments.  If you still want to see hostnames when someone connects to a TCP/IP server interface/router then you will need to add ENABLE_DNS to your system.txt file.</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2015/05/08/cosmos-3-4-2-released/">
      Ball Aerospace COSMOS 3.4.2 Released
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      release
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      08 May 2015
    </span>
    <a href="https://github.com/ryanmelt" class="post-author">
      <img src="https://github.com/ryanmelt.png" class="avatar" alt="ryanmelt avatar" width="24" height="24">
      ryanmelt
    </a>
  </div>
  <div class="post-content">
    <h3 id="issues">Issues:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/123">#123</a> TestRunner command line option to launch a test automatically</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/125">#125</a> Fix COSMOS issues for qtbindings 4.8.6.2</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/126">#126</a> COSMOS GUI Chooser updates</li>
</ul>

<h3 id="migration-notes-from-cosmos-33x-or-34x">Migration Notes from COSMOS 3.3.x or 3.4.x:</h3>

<p>COSMOS 3.4.2 requires qtbindings 4.8.6.2. You must also update qtbindings when installing this release. Also note that earlier versions of COSMOS will not work with qtbindings 4.8.6.2. All users are strongly recommended to update both gems.</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2015/05/01/cosmos-3-4-1-released/">
      Ball Aerospace COSMOS 3.4.1 Released
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      release
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      01 May 2015
    </span>
    <a href="https://github.com/ryanmelt" class="post-author">
      <img src="https://github.com/ryanmelt.png" class="avatar" alt="ryanmelt avatar" width="24" height="24">
      ryanmelt
    </a>
  </div>
  <div class="post-content">
    <h3 id="issues">Issues:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/121">#121</a> BinaryAccessor write crashes with negative bit sizes</li>
</ul>

<h3 id="migration-notes-from-cosmos-33x">Migration Notes from COSMOS 3.3.x:</h3>

<p>None</p>

<p>Note: COSMOS 3.4.0 has a serious regression when writing to variably sized packets. Please upgrade to 3.4.1 immediately if you are using 3.4.0.</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2015/04/27/cosmos-3-4-0-released/">
      Ball Aerospace COSMOS 3.4.0 Released
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      release
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      27 Apr 2015
    </span>
    <a href="https://github.com/ryanmelt" class="post-author">
      <img src="https://github.com/ryanmelt.png" class="avatar" alt="ryanmelt avatar" width="24" height="24">
      ryanmelt
    </a>
  </div>
  <div class="post-content">
    <h3 id="issues">Issues:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/23">#23</a> Handbook Creator User’s Guide Mode</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/72">#72</a> Refactor binary_accessor</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/101">#101</a> Support Ruby 2.2 and 64-bit Ruby on Windows</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/104">#104</a> CmdTlmServer Loading Tmp &amp; SVN Conflict Files</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/107">#107</a> Remove truthy and falsey from specs</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/110">#110</a> Optimize TlmGrapher</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/111">#111</a> Protect Interface Thread Stop from AutoReconnect</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/114">#114</a> Refactor Cosmos::Script module</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/118">#118</a> Allow PacketViewer to hide ignored items</li>
</ul>

<h3 id="migration-notes-from-cosmos-33x">Migration Notes from COSMOS 3.3.x:</h3>

<p>None</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2015/04/06/cosmos-c-extension/">
      COSMOS BinaryAccessor#write C Extension
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      post
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      06 Apr 2015
    </span>
    <a href="https://github.com/jmthomas" class="post-author">
      <img src="https://github.com/jmthomas.png" class="avatar" alt="jmthomas avatar" width="24" height="24">
      jmthomas
    </a>
  </div>
  <div class="post-content">
    <h2 id="how-i-created-a-cosmos-c-extension">How I created a COSMOS C Extension</h2>

<p>The COSMOS framework has several <a href="https://github.com/BallAerospace/COSMOS/tree/master/ext/cosmos/ext">C extensions</a> created to increase performance. One critical piece that was created early on is the extension to the <a href="https://github.com/BallAerospace/COSMOS/blob/master/lib/cosmos/packets/binary_accessor.rb">BinaryAccessor</a> class. This allows for increased performance when reading items from binary packets which is the most common operation in the COSMOS system. I created a COSMOS <a href="https://github.com/BallAerospace/COSMOS/tree/master/test/performance">performance configuration</a> which spawns 30 fake targets and attempts to send commands to them as fast as possible. Sending commands exercies the write portion of BinaryAccessor and profiling showed this was now becoming a bottleneck. Therefore I set out to port the write method to the existing C extension.</p>

<p>The fact that <a href="https://github.com/ryanatball">Ryan</a> had already implemented the read method as a C extension gave me a huge head start. I first copied all the Ruby code directly into the C extension so I could try to translate it line by line. Initially if I didn’t know how to do the translation I would just comment it out and see how much I could compile. A nice way to do this in C code is use <code class="highlighter-rouge">#if 0 ... #endif</code>. I also copied the read method signature and locals since the methods are similar. Before I get to far into the guts I should note that this effort relied on a very comprehensive <a href="https://github.com/BallAerospace/COSMOS/blob/master/spec/packets/binary_accessor_spec.rb">spec</a> or I would have had no idea if I was successful.</p>

<p>Once I implemented the initial parameter checking I dove into the String and Block (binary string) handling portion of the write method. The write method modifies the given buffer by writing a String or Block into it. I started with Google and found <a href="http://clalance.blogspot.com/2011/01/writing-ruby-extensions-in-c-part-8.html">Chris Lalancette’s</a> post and this excellent write-up on <a href="http://silverhammermba.github.io/emberb/c">The Ruby C API</a>. I also cloned <a href="https://github.com/ruby/ruby">ruby</a> itself and went directly to the <a href="https://github.com/ruby/ruby/blob/trunk/string.c">code</a>. I found the code a little difficult to follow but the important thing to remember is if the method is NOT delcared static then you can use it in your C extension. I ended up using <code class="highlighter-rouge">rb_str_concat</code> to add to the buffer and <code class="highlighter-rouge">rb_str_update</code> to directly modify the buffer.</p>

<div class="note warning">
  <h5>Modifying Ruby strings</h5>
  <p>If you directly modify the Ruby string buffer in a C extension with memcpy, memmove, or memset (after getting a pointer with RSTRING_PTR), you need to tell the Ruby runtime with the rb_str_modify method. Calling Ruby's methods like rb_str_update automatically handles this for you.</p>
</div>

<p>Another issue I ran into was the existing Ruby code was calling <code class="highlighter-rouge">to_s</code> on the input value to ensure it was a String. In the C extension you can check for a type using <code class="highlighter-rouge">RB_TYPE_P(value, T_STRING)</code> where value is a unknown Ruby VALUE instance and T_STRING can be any number of Ruby types. If the value was not a Ruby String I used <code class="highlighter-rouge">rb_funcall</code> to directly call the Ruby runtime and call the <code class="highlighter-rouge">to_s</code> method. If you are unable to find an appropriate method in the C library to do what you want, this is the way to use Ruby from within your C extension.</p>

<p>Next I started to tackle the writing of signed and unsigned integers. COSMOS supports overflow of integers by either truncating a passed in value, saturating to the high or low, or raising an error. So I implemented a <code class="highlighter-rouge">check_overflow</code> method in C to handle this logic. This code was very difficult to get right because of the size of the values involved. Since COSMOS handles integers of any size, I had to create Ruby Bignum constants to perform the comparisons. This involved another dive into the Ruby source to understand <a href="https://github.com/ruby/ruby/blob/trunk/bignum.c">bignum.c</a>. One of the tricks was to create Ruby Constants up front in the Initialization routine so I wasn’t constantly recalulating Bignums for comparison. COSMOS also handles bitfields so those values I generate dynamically using <code class="highlighter-rouge">rb_big_pow</code> and <code class="highlighter-rouge">rb_bit_minus</code>. I also created a <code class="highlighter-rouge">TO_BIGNUM</code> macro which converts Fixnum to Bignum so all the math uses Bignum methods. I could then use the <code class="highlighter-rouge">rb_big_cmp</code> to compare the given value with the appropriate minimum and maximum values.</p>

<p>The bitfield logic was the most complex to convert to C. This required a lot of C printfs and Ruby puts at each step of the way to ensure all the intermediary calculations were matching up. COSMOS supports big and little endian data buffers so I had to ensure the bytes were reversed and shifted as necessary before finally writing them back to the buffer. Again the <code class="highlighter-rouge">rb_str_modify</code> function is called to notify the Ruby runtime that the buffer has been changed.</p>

<p>The floating point values were probably the easiest because I simply called <code class="highlighter-rouge">RFLOAT_VALUE(value)</code> to get the double value of the passed in Ruby value. At this point I was able to successfully run the full spec. However, once I ran the entire COSMOS spec suite I hit a failure on a simple write call in api_spec.rb. I determined the spec was trying to send an integer value where there was a floating point value defined. The old Ruby code simply converted this value inline but I was calling <code class="highlighter-rouge">RFLOAT_VALUE(value)</code> which ASSUMES the value is a float. I updated the binary_accessor_spec.rb to capture this failure and also noted a similar issue in the integer logic. The Ruby code was calling <code class="highlighter-rouge">value = Integer(value)</code> for integers and <code class="highlighter-rouge">value = Float(value)</code> for floats. This not only handles the case of passing an integer value when you want to write a float, it also handles truncating a float to an integer and even handles parsing a String which contains a numeric value. When you have a tremendous amount of work being done by Ruby you are best to fall back to <code class="highlighter-rouge">rb_funcall</code>. But how to call the <code class="highlighter-rouge">Integer()</code> method which doesn’t appear to have a receiver. Remember that if a method doesn’t appear to have a receiver it’s probably being called on Kernel which is <a href="http://www.rubydoc.info/stdlib/core/Kernel#Integer-instance_method">exactly the case</a>. Thus I call it with <code class="highlighter-rouge">value = rb_funcall(rb_mKernel, rb_intern("Float"), 1, value);</code>. (NOTE: I also discovered I could call the method passing ‘self’ instead of rb_mKernel but using Kernel felt more explicit).</p>

<p>At this point I refactored to combine some of the functionality in the read method with the new write method. I probably could have done more refactoring but refactoring C code just isn’t as much fun as refactoring Ruby code. Once I completed the refactor I wanted to benchmark my new C extension to determine how much faster (or slower?) I made it. I love the <a href="https://github.com/evanphx/benchmark-ips">benchmark-ips</a> gem as it benchmarks iterations per second and automatically determines how many times to run the code to get good data. But I didn’t want to re-write our existing specs to support using this gem so I looked into how to integrate it with RSpec. It turns out this is all that was needed in our spec_helper.rb:</p>

<p><code class="highlighter-rouge">if ENV.key?("BENCHMARK")
    c.around(:each) do |example|
      Benchmark.ips do |x|
        x.report(example.metadata[:full_description]) do
          example.run
        end
      end
    end
  end
</code></p>

<p>Benchmark-ips works by calculating the number of runs to get interesting data and then running the code in question. Thus defining BENCHMARK in the environment makes the specs run EXTREMELY slow. I used the ability of RSpec to filter only the examples I wanted to benchmark with the -e option:</p>

<p><code class="highlighter-rouge">rspec spec/packets/binary_accesor_spec.rb -e "write only"</code></p>

<p>Running this in master and then in my C-extension branch I calculated the difference in iterations and then filtered out all the “complains” (raise an exception) and “overflow” test cases to focus on just the tests which write values. The average improvement was 1.3x. Not quite as awesome as I was hoping for but an improvement in an area that is performance sensitive. I suspected I could get additional performance if I optimized the check_overflow method to not always use Bignums and to do Fixnum comparisons if possible. However, this did not yield any optimizations so I backed out the change.</p>

<p>At this point I submitted the <a href="https://github.com/BallAerospace/COSMOS/pull/103">pull request</a> which broke the Travis build. <a href="https://github.com/ryanatball">Ryan</a> then added a patch that corrected all my issues and the build passed. I re-benchmarked his changes and overall the results were actually slightly faster on average so the pull request was merged.</p>

<p>Enjoy a faster COSMOS write routine!</p>


  </div>
</article>


  <article>
  <h2>
    <a href="/news/2015/03/23/cosmos-3-3-3-released/">
      Ball Aerospace COSMOS 3.3.3 Released
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      release
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      23 Mar 2015
    </span>
    <a href="https://github.com/ryanmelt" class="post-author">
      <img src="https://github.com/ryanmelt.png" class="avatar" alt="ryanmelt avatar" width="24" height="24">
      ryanmelt
    </a>
  </div>
  <div class="post-content">
    <h3 id="issues">Issues:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/93">#93</a> Derived items that return arrays are not formatted to strings bug</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/94">#94</a> JsonDRb retry if first attempt hits a closed socket bug</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/96">#96</a> Make max lines written to output a variable in ScriptRunnerFrame enhancement</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/99">#99</a> Increase Block Count in DataViewer</li>
</ul>

<h3 id="migration-notes-from-cosmos-32x">Migration Notes from COSMOS 3.2.x:</h3>

<p>System.telemetry.target_names and System.commands.target_names no longer contain the ‘UNKNOWN’ target.</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2015/03/19/cosmos-3-3-1-released/">
      Ball Aerospace COSMOS 3.3.1 - Startup Cheetah
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      release
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      19 Mar 2015
    </span>
    <a href="https://github.com/ryanmelt" class="post-author">
      <img src="https://github.com/ryanmelt.png" class="avatar" alt="ryanmelt avatar" width="24" height="24">
      ryanmelt
    </a>
  </div>
  <div class="post-content">
    <p>COSMOS first-time startup speed is now 16 times faster - hence this release is codenamed “Startup Cheetah”. Enjoy!</p>

<h3 id="issues">Issues:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/91">#91</a> Add mutex around creation of System.instance</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/89">#89</a> Reduce maximum block count from 10000 to 100 everywhere</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/87">#87</a> MACRO doesn’t support more than one item</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/85">#85</a> Replace use of DL with Fiddle</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/82">#82</a> Improve COSMOS startup speed</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/81">#81</a> UNKNOWN target identifies all buffers before other targets have a chance</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/78">#78</a> Reduce COSMOS memory usage</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/76">#76</a> Fix specs to new expect syntax and remove ‘should’</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/74">#74</a> Server requests/sec and utilization are incorrect</li>
</ul>

<h3 id="migration-notes-from-cosmos-32x">Migration Notes from COSMOS 3.2.x:</h3>

<p>System.telemetry.target_names and System.commands.target_names no longer contain the ‘UNKNOWN’ target.</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2015/02/27/cosmos-at-gsaw-conference/">
      COSMOS at the GSAW Conference
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      conference
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      27 Feb 2015
    </span>
    <a href="https://github.com/ryanmelt" class="post-author">
      <img src="https://github.com/ryanmelt.png" class="avatar" alt="ryanmelt avatar" width="24" height="24">
      ryanmelt
    </a>
  </div>
  <div class="post-content">
    <p>Ball Aerospace COSMOS is participating in the poster session of this years <a href="http://gsaw.org">Ground System Architectures Workshop (GSAW)</a> taking place at the Renaissance Los Angeles Airport Hotel March 2-5, 2015.</p>

<p>If you’re attending the conference, stop by our poster in the exhibit hall and say hi!</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2015/02/23/cosmos-3-2-1-released/">
      Ball Aerospace COSMOS 3.2.1 Released
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      release
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      23 Feb 2015
    </span>
    <a href="https://github.com/ryanmelt" class="post-author">
      <img src="https://github.com/ryanmelt.png" class="avatar" alt="ryanmelt avatar" width="24" height="24">
      ryanmelt
    </a>
  </div>
  <div class="post-content">
    <h3 id="issues">Issues:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/61">#61</a> Don’t crash TestRunner if there is an error during require_utilities()</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/63">#63</a> Creating interfaces with the same name does not cause an error</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/64">#64</a> Launcher RUBYW substitution broken by refactor</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/65">#65</a> CmdTlmServer ensure log messages start scrolled to bottom on Linux</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/66">#66</a> Improve graceful shutdown on linux and prevent continuous exceptions from InterfaceThread</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/70">#70</a> ask() should take a default</li>
</ul>

<h3 id="migration-notes-from-cosmos-31x">Migration Notes from COSMOS 3.1.x:</h3>

<p>No significant updates to existing code should be needed. The primary reason for update to 3.2.x is fixing the slow shutdown present in all of 3.1.x.</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2015/02/17/cosmos-3-2-0-released/">
      Ball Aerospace COSMOS 3.2.0 Released
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      release
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      17 Feb 2015
    </span>
    <a href="https://github.com/ryanmelt" class="post-author">
      <img src="https://github.com/ryanmelt.png" class="avatar" alt="ryanmelt avatar" width="24" height="24">
      ryanmelt
    </a>
  </div>
  <div class="post-content">
    <h3 id="issues">Issues:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/34">#34</a> Refactor packet_config</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/43">#43</a> Add ccsds_log_reader.rb as an example of alternative log readers</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/45">#45</a> Slow shutdown of CTS and TlmViewer with threads trying to connect</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/46">#46</a> Add mutex protection to Cosmos::MessageLog</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/47">#47</a> TlmGrapher RangeError in Overview Graph</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/49">#49</a> Make about dialog scroll</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/55">#55</a> Automatic require of stream_protocol fix and cleanup</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/57">#57</a> Add OPTION keyword to support passing arbitrary options to interfaces/routers</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/59">#59</a> Add password mode to ask and ask_string</li>
</ul>

<h3 id="migration-notes-from-cosmos-31x">Migration Notes from COSMOS 3.1.x:</h3>

<p>No significant updates to existing code should be needed. The primary reason for update to 3.2.x is fixing the slow shutdown present in all of 3.1.x.</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2015/02/03/cosmos-3-1-2-released/">
      Ball Aerospace COSMOS 3.1.2 Released
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      release
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      03 Feb 2015
    </span>
    <a href="https://github.com/ryanmelt" class="post-author">
      <img src="https://github.com/ryanmelt.png" class="avatar" alt="ryanmelt avatar" width="24" height="24">
      ryanmelt
    </a>
  </div>
  <div class="post-content">
    <h3 id="issues">Issues:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/20">#20</a> Handbook Creator should output relative paths</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/21">#21</a> Improve code metrics</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/26">#26</a> Dynamically created file for Mac launchers should not be included in CRC calculation</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/27">#27</a> TestRunner build_test_suites destroys CustomTestSuite if underlying test procedures change</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/28">#28</a> TlmGrapher - Undefined method nan? for 0:Fixnum</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/35">#35</a> Race condition starting new binary log</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/36">#36</a> TlmDetailsDialog non-functional</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/37">#37</a> Remaining TlmGrapher regression</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/38">#38</a> Allow INTERFACE_TARGET to work with target name substitutions</li>
</ul>

<h3 id="migration-notes-from-cosmos-30x">Migration Notes from COSMOS 3.0.x:</h3>

<p>The definition of limits persistence has changed. Before it only applied when changing to a bad state (yellow or red). Now persistence applies for all changes including from stale to a valid state and from bad states back to green.</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2015/01/28/cosmos-3-1-1-released/">
      Ball Aerospace COSMOS 3.1.1 Released
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      release
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      28 Jan 2015
    </span>
    <a href="https://github.com/ryanmelt" class="post-author">
      <img src="https://github.com/ryanmelt.png" class="avatar" alt="ryanmelt avatar" width="24" height="24">
      ryanmelt
    </a>
  </div>
  <div class="post-content">
    <h3 id="issues">Issues:</h3>

<ul>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/10">#10</a> Simulated Targets Button only works on Windows</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/11">#11</a> Mac application folders not working</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/12">#12</a> Persistence should be applied even if changing from stale</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/14">#14</a> Allow information on logging page to be copied</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/16">#16</a> Ensure read conversion cache cannot be cleared mid-use</li>
  <li><a href="https://github.com/BallAerospace/COSMOS/issues/17">#17</a> NaNs in telemetry graph causes scaling crash</li>
</ul>

<h3 id="migration-notes-from-cosmos-30x">Migration Notes from COSMOS 3.0.x:</h3>

<p>The definition of limits persistence has changed. Before it only applied when changing to a bad state (yellow or red). Now persistence applies for all changes including from stale to a valid state and from bad states back to green.</p>

  </div>
</article>


  <article>
  <h2>
    <a href="/news/2015/01/06/ball-aerospace-cosmos-open-sourced/">
      Ball Aerospace COSMOS Open Sourced
    </a>
  </h2>
  <span class="post-category">
    <span class="label">
      release
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      06 Jan 2015
    </span>
    <a href="https://github.com/ryanmelt" class="post-author">
      <img src="https://github.com/ryanmelt.png" class="avatar" alt="ryanmelt avatar" width="24" height="24">
      ryanmelt
    </a>
  </div>
  <div class="post-content">
    <h2 id="ball-aerospace--technologies-corp-has-launched-ball-aerospace-cosmos-the-companys-second-open-source-software-project">Ball Aerospace &amp; Technologies Corp. has launched Ball Aerospace COSMOS, the company’s second open source software project.</h2>

<p>Ball Aerospace COSMOS brings an exciting set of functionality to Operations and Integration &amp; Test that had previously only been available in proprietary
and expensive COTS solutions or not available in any commercial product.  A full set of 15 applications provide features including automated test procedures,
realtime and offline telemetry display and graphing, post-test analysis and CSV extraction, limits monitoring, command and telemetry handbook creation,
and binary file editing.</p>

<p>Automated test procedures written for COSMOS offer the full power of the Ruby programming language allowing operators to send commands,
verify telemetry, read and write files, access the network, and even send an email on completion.  Additional features include automated test
report generation, standardized meta data collection (unit serial number, operator name), and loop testing (executing the same test repeatedly
to wring out timing and other issues).  Advanced debugging functionality allows for single-stepping through procedures, setting breakpoints, and
complete logging of all script and user interaction with the system under test.</p>

<p>Detailed data visualization allows for custom screen creation, line and x-y plotting of realtime data, easy creation of custom 3d visualizations,
and the ability to quickly view any data provided by an embedded system.   Post-test analysis and data extraction capabilities make narrowing
down anomalies easy and allow for data to be quickly imported into outside data analysis systems such as Matlab.</p>

<p>“Ball Aerospace’s COSMOS enables an amazing amount of functionality and can provide a standard interface for interacting with anything that
contains embedded software”, said Ryan Melton, COSMOS’s creator and open source evangelist.  “By open sourcing this software we hope to
change the whole playing field of Operations, Integration, and Test”.</p>

  </div>
</article>



      </div>

      <div class="unit one-fifth hide-on-mobiles">
  <aside>
    <ul>
      <li class="current">
        <a href="/news/">All News</a>
      </li>
      <li class="">
        <a href="/news/releases/">COSMOS Releases</a>
      </li>
    </ul>
    <h4>Recent Releases</h4>
    <ul>
      
      <li class="">
        <a href="/news/2019/06/28/cosmos-4-4-0-released/">Version 4.4.0</a>
      </li>
      
      <li class="">
        <a href="/news/2018/08/30/cosmos-4-3-0-released/">Version 4.3.0</a>
      </li>
      
      <li class="">
        <a href="/news/2018/05/16/cosmos-4-2-4-released/">Version 4.2.4</a>
      </li>
      
      <li class="">
        <a href="/news/2018/04/17/cosmos-4-2-3-released/">Version 4.2.3</a>
      </li>
      
      <li class="">
        <a href="/news/2018/04/11/cosmos-4-2-2-released/">Version 4.2.2</a>
      </li>
      
      <li>
        <a href="/docs/history/">History »</a>
      </li>
    </ul>
    <h4>Other News</h4>
    <ul>
        
        
        
        
        <li class="">
          <a href="/news/2019/06/05/protocols/">Protocols</a>
        </li>
        
        
        
        <li class="">
          <a href="/news/2018/12/24/little-endian/">Little Endian Packet Data</a>
        </li>
        
        
        
        <li class="">
          <a href="/news/2018/10/05/system-target-txt/">Using system.txt and target.txt</a>
        </li>
        
        
        
        <li class="">
          <a href="/news/2018/09/14/cosmos-dockercon/">COSMOS at DockerCon 2018</a>
        </li>
        
        
        
        
        
        
        
        
        
        
        
        <li class="">
          <a href="/news/2018/03/14/derived-items/">Derived Items</a>
        </li>
        
        
        
        <li class="">
          <a href="/news/2018/02/12/limits/">Limits</a>
        </li>
        
        
        
        <li class="">
          <a href="/news/2018/01/18/metadata/">Metadata</a>
        </li>
        
        
        
        
        
        <li class="">
          <a href="/news/2017/11/28/cosmos-4-1-0-release-notes/">COSMOS 4.1.0 Release Notes</a>
        </li>
        
        
        
        
        
        <li class="">
          <a href="/news/2017/11/13/require_vs_load/">Require vs Load</a>
        </li>
        
        
        
        <li class="">
          <a href="/news/2017/10/30/config-editor/">Config Editor</a>
        </li>
        
        
        
        
        
        
        
        <li class="">
          <a href="/news/2017/08/23/cloud-deploy/">Deploying COSMOS to the Cloud</a>
        </li>
        
        
        
        
        
        
        
        <li class="">
          <a href="/news/2017/07/05/arduino-battle-bots/">Arduinos & Battle Bots</a>
        </li>
        
        
        
        <li class="">
          <a href="/news/2017/06/19/template_protocol/">Template Protocol</a>
        </li>
        
        
        
        
        
        <li class="">
          <a href="/news/2017/05/08/packet_processors/">Packet Processors</a>
        </li>
        
        
        
        <li class="">
          <a href="/news/2017/04/24/wired/">WIRED Article</a>
        </li>
        
        
        
        
        
        <li class="">
          <a href="/news/2017/02/22/routers/">Routers</a>
        </li>
        
        
        
        
        
        <li class="">
          <a href="/news/2016/10/13/cosmos-cubesat-ops/">SmallSat Ops</a>
        </li>
        
        
        
        <li class="">
          <a href="/news/2016/09/12/erb-config/">ERB Config Files</a>
        </li>
        
        
        
        <li class="">
          <a href="/news/2016/08/22/custom-widgets/">Custom Widgets</a>
        </li>
        
        
        
        <li class="">
          <a href="/news/2016/08/04/custom-cosmos_interface/">Custom COSMOS Interface</a>
        </li>
        
        
        
        <li class="">
          <a href="/news/2016/07/06/cosmos-cmd-tlm-names/">COSMOS Cmd/Tlm Naming</a>
        </li>
        
        
        
        
        
        
        
        <li class="">
          <a href="/news/2016/03/03/sparkfun/">Sparkfun Blog Post</a>
        </li>
        
        
        
        <li class="">
          <a href="/news/2016/02/27/xtce-support/">XTCE Support</a>
        </li>
        
        
        
        <li class="">
          <a href="/news/2016/02/27/fukuoka-award/">Fukuoka Special Award Winner</a>
        </li>
        
        
        
        
        
        <li class="">
          <a href="/news/2016/02/11/simulated-target/">COSMOS Simulated Target</a>
        </li>
        
        
        
        
        
        
        
        
        
        <li class="">
          <a href="/news/2015/10/28/cosmos-at-ats-conference/">COSMOS at the ATS Conference</a>
        </li>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <li class="">
          <a href="/news/2015/04/06/cosmos-c-extension/">COSMOS BinaryAccessor#write C Extension</a>
        </li>
        
        
        
        
        
        
        
        <li class="">
          <a href="/news/2015/02/27/cosmos-at-gsaw-conference/">COSMOS at the GSAW Conference</a>
        </li>
        
        
        
        
        
        
        
        
        
        
        
        
    </ul>
  </aside>
</div>


      <div class="clear"></div>

    </div>
  </section>


  <script>
  (function() {
    var cx = '001663949569052626382:-enhin1layy';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<footer role="contentinfo">
  <div class="grid wider">
    <div class="unit one-third center-on-mobiles">
      <p>The contents of this website are &copy;&nbsp;2019 <a href="http://www.ballaerospace.com/" target="_blank">Ball Aerospace</a> under the terms of the <a href="https://github.com/BallAerospace/COSMOS/blob/master/LICENSE.txt" target="_blank">GPLv3&nbsp;License</a>.</p>
      <p>Site design derived from the <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> project documentation which is licensed under the terms of the <a href="https://github.com/jekyll/jekyll/blob/master/LICENSE" target="_blank">MIT License</a>.</p>
    </div>
    <div class="unit two-thirds align-right center-on-mobiles">
      <p>
        <gcse:search></gcse:search>
        Proudly hosted by
        <a href="https://github.com" target="_blank">
          <img src="/img/footer-logo.png" width="100" height="30" alt="GitHub Social coding">
        </a>
      </p>
    </div>
  </div>
</footer>

  <script>
  var anchorForId = function (id) {
    var anchor = document.createElement("a");
    anchor.className = "header-link";
    anchor.href      = "#" + id;
    anchor.innerHTML = "<span class=\"sr-only\">Permalink</span><i class=\"fa fa-link\"></i>";
    anchor.title = "Permalink";
    return anchor;
  };

  var linkifyAnchors = function (level, containingElement) {
    var headers = containingElement.getElementsByTagName("h" + level);
    for (var h = 0; h < headers.length; h++) {
      var header = headers[h];

      if (typeof header.id !== "undefined" && header.id !== "") {
        header.appendChild(anchorForId(header.id));
      }
    }
  };

  document.onreadystatechange = function () {
    if (this.readyState === "complete") {
      var contentBlock = document.getElementsByClassName("docs")[0] || document.getElementsByClassName("news")[0];
      if (!contentBlock) {
        return;
      }
      for (var level = 1; level <= 6; level++) {
        linkifyAnchors(level, contentBlock);
      }
    }
  };
</script>

  
  <!-- Google Analytics (http://google.com/analytics) -->
  <script>
    !function(j,e,k,y,l,L){j.GoogleAnalyticsObject=y,j[y]||(j[y]=function(){
    (j[y].q=j[y].q||[]).push(arguments)}),j[y].l=+new Date,l=e.createElement(k),
    L=e.getElementsByTagName(k)[0],l.src='//www.google-analytics.com/analytics.js',
    L.parentNode.insertBefore(l,L)}(window,document,'script','ga');

    ga('create', 'UA-60103689-1', 'cosmosrb.com');
    ga('send', 'pageview');

  </script>



</body>
</html>
